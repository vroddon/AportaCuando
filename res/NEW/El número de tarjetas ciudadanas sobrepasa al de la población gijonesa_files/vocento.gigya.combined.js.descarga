if(("undefined"===typeof Vocento)||(!Vocento)){var appUtils=require("./vocento.gigya.utils.js");var Vocento=appUtils.Vocento}else{var Vocento=Vocento||{}}Vocento.Gigya=function($,ssoGroup,service,externalOptions,userUtils,voontoApp){var version="3.15.6";var authenticated=false;var user=null;var account=null;var eventProductsOnReady=$.Deferred();var eventSetAccountInfoCallback=$.Deferred();var eventCheckService=$.Deferred();var eventServiceAdd=$.Deferred();var eventRedirectToBackUrlOnLogin=$.Deferred();var eventAccountsOnLogin=$.Deferred();var eventSocializeOnLogin=$.Deferred();var eventGetAccountInfo=$.Deferred();var eventGetUserInfo=$.Deferred();var eventLastActionBeforeRedirect=$.Deferred();var flushedProducts=false;var loginAttemps=0;var captcha;var options={};var isFirstComment=false;voontoApp=voontoApp||"";var mainEventListener=initEventListener(voontoApp);var promiseNamespace=initPromiseNamespace();var log=function(){};var safeInvoke=function(){};if(Vocento.safeInvoke){safeInvoke=Vocento.safeInvoke}var getContext=function(){};if(Vocento.getContext){getContext=Vocento.getContext}var translateError=function(){};if(Vocento.translateError){translateError=Vocento.translateError}var QUEID_COOKIE_NAME="queid_log";var REG_COOKIE_NAME="registro";var UID_COOKIE_NAME="voc_uid";var EVK_COOKIE_NAME="evk_";var EDITION_COOKIE_NAME="voc_edition";var PAYWALL_COOKIE_NAME="voc_paywall";var NFRYL_COOKIE_NAME="vocuser_nfryl_volver_al_origen";var NEWSLETTERS_COOKIE_NAME="vocuser_arealibre_newsletters";var VOCUSER_COOKIE_NAME="vocuser_information";var VOCUSER_THANKYOU_COOKIE_NAME="vocuser_user_email";var AUTO_NEWSLETTERS_COOKIE_NAME="vocuser_autosuscripcion_newsletters";var flows=[];var domains={abc:"abc.es",csvocento:"csvocento.com",sur:"diariosur.es",diariovasco:"diariovasco.com",elcomercio:"elcomercio.es",correo:"elcorreo.com",elcorreo:"elcorreo.com",diariomontanes:"eldiariomontanes.es",nortedecastilla:"elnortedecastilla.es",finanzas:"finanzas.com",grada360:"grada360.com",hoy:"hoy.es",ideal:"ideal.es",larioja:"larioja.com",lasprovincias:"lasprovincias.es",laverdad:"laverdad.es",lavoz:"lavozdigital.es",hoymujer:"mujerhoy.com",leonoticias:"leonoticias.com",surinenglish:"surinenglish.com",eslang:"eslang.es",xlsemanal:"xlsemanal.com",codeanyapp:"diariovasco.com"};function initPromiseNamespace(){var result=window.Promise?window.Promise:(window.RSVP?window.RSVP.Promise:function(functionToExecute){});return result}function getOptions(){var httpProtocol=window.location.protocol;var env="";var env_mongo_datastore="";var env_voccore="";var envFront="www";var hostDomain=ssoGroup;var authServerVocCore="";var internalServiceUrl=".srv.vocento.in";var fullLocation=window.location.host;var parts=fullLocation.split(".");var subdomain=parts[0];var vocCoreSubdomain="voccore.";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}var domain=domains[ssoGroup].split(".");env="https://auth."+domains[ssoGroup];var envVocCore="";var envVocCoreSeparator="";authServerVocCore="https://"+envVocCore+envVocCoreSeparator+vocCoreSubdomain+domains[ssoGroup];if(/^des/.test(window.location.host)||/^integracion/.test(window.location.host)||/^areapersonal-des/.test(window.location.host)||/^areapersonalm-des/.test(window.location.host)||/^docker/.test(window.location.host)||/^userplayground-miguelromero2000/.test(window.location.host)){env=httpProtocol+"//pre-auth."+domains[ssoGroup];env_mongo_datastore="des-";env_voccore="des-";envVocCore="des";envVocCoreSeparator="-";envFront="desn";if("https:"===window.location.protocol){env=httpProtocol+"//pre-auth."+domains[ssoGroup]}vocCoreSubdomain="voccore-";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}vocCoreSubdomain="voccore.";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}authServerVocCore="https://"+envVocCore+envVocCoreSeparator+vocCoreSubdomain+domains[ssoGroup]}if(/^pre/.test(window.location.host)||/^areapersonal-pre/.test(window.location.host)||/^areapersonalm-pre/.test(window.location.host)){env=httpProtocol+"//pre-auth."+domains[ssoGroup];env_mongo_datastore="pre-";env_voccore="pre-";envVocCore="pre";envVocCoreSeparator="-";envFront="pren";if("https:"===window.location.protocol){env=httpProtocol+"//pre-auth."+domains[ssoGroup]}vocCoreSubdomain="voccore-";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}vocCoreSubdomain="voccore.";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}authServerVocCore="https://"+envVocCore+envVocCoreSeparator+vocCoreSubdomain+domains[ssoGroup]}if(/^local/.test(window.location.host)||/^desnlocal/.test(window.location.host)||/^deshared/.test(window.location.host)||/^desn-user/.test(window.location.host)||/^des-vocuser/.test(window.location.host)){env=httpProtocol+"//pre-auth."+domains[ssoGroup];env_mongo_datastore="des-";env_voccore="des-";envVocCore="des";envVocCoreSeparator="-";envFront=subdomain;if("https:"===window.location.protocol){env=httpProtocol+"//pre-auth."+domains[ssoGroup]}vocCoreSubdomain="voccore.";if(checkUserFlowUrlsContains("sevilla",window.location.href)){vocCoreSubdomain="voccore-sevilla."}authServerVocCore="https://"+envVocCore+envVocCoreSeparator+vocCoreSubdomain+domains[ssoGroup]}if(/^des-/.test(window.location.host)){envFront="des-www"}if(/^pre-/.test(window.location.host)){envFront="pre-www"}if(/^new-/.test(window.location.host)){envFront="new-www"}return{cid:ssoGroup,ssoGroup:ssoGroup,service:service,authServer:env,envVoccore:env_voccore,envFront:envFront,authServerVocCore:authServerVocCore,debug:false,hasPaywall:false,hasEcommerce:false,hasGlobalSSO:false,autoVerifyUser:false,loginOnVerify:false,reloadOnLogin:true,reloadOnLogout:true,captcha:{isVisible:false,loginAttemps:2},domains:domains,enableCNAME:false,addSubmenuOptionTerritorio:false,addPictureInLoginScreen:false,forceProvidersLogout:false,enabledProviders:"facebook,google",requiredCapabilities:"login",loggedInSelector:".gigya-logged-in",loggedOutSelector:".gigya-logged-out",loginLinkSelector:".gigya-login-link",registrationLinkSelector:".gigya-registration-link",recoveryLinkSelector:".gigya-recovery-link",backLinkSelector:".gigya-back-link",profileLinkSelector:".gigya-profile-link",profileAreaPersonalLinkSelector:".vocuser-profile-areapersonal-link",profileInterestsLinkSelector:".gigya-profile-interests-link",profileChangePasswdLinkSelector:".gigya-profile-change-passwd-link",loginAdditionalDataLinkSelector:".gigya-additional-data-link",logoutLinkSelector:".gigya-logout-link",idDivHtmlCustomBenefits:"collapseExample",addConnectionsID:"gigya-add-connections",userThumbnailSelector:".gigya-user-thumbnail",userFirstNameSelector:".gigya-user-first-name",userLastNameSelector:".gigya-user-last-name",userEmailSelector:".gigya-user-email",url_creacion_mongo:"https://"+env_mongo_datastore+"voccore."+domains[ssoGroup]+"/v1/datastore/new",url_busqueda_mongo:"https://"+env_mongo_datastore+"voccore."+domains[ssoGroup]+"/v1/datastore/find",url_edicion_mongo:"https://"+env_mongo_datastore+"voccore."+domains[ssoGroup]+"/v1/datastore/edit",sectionsWithExternalFields:[],screenSet:{web:{auth:"",profile:""},mobile:{auth:"",profile:""}},screenName:{login:"gigya-login-screen",registration:"gigya-register-screen",formulario:"gigya-register-screen",profile:"gigya-update-profile-screen",completeRegistration:"gigya-complete-registration-screen",completo:"gigya-complete-registration-screen",interests:"gigya-update-profile-screen-3",change:"gigya-change-password-screen",updated:"gigya-update-thanks-screen"},parentDivClass:"",hasMenuOptionNewsletters:false,hasContenidoExtraSubMenuOptionDinero:true,setUserNewslettersByFieldAdsMedia:false,saveGigyaCommunications:false,updateSelligentCommunications:false,saveGigyaCustomerServices:true,progressiveProfile:false,saveGigyaCustomerServiceFromComments:false,serviceId:"100",device:"Sin especificar",platform:"Sin especificar",serviceReference:"",backURL:"/",page:{loginPage:"login.html",loginAdditionalDataPage:"datos-adicionales.html",registerPage:"formulario.html",registerConfirmedPage:"confirmacion.html",resendMailPage:"reenviar-mail.html",mailSendedPage:"mail-enviado.html",validateMailPage:"validacion-mail.html",recoveryPage:"recuperar.html",sendedMailPage:"mail-enviado.html",changePasswdPage:"cambiar.html",passwdchangedPage:"cambiada.html",profilePage:"perfil.html",interestPage:"intereses.html",changePasswdProfilePage:"cambiar-clave.html",profileUpdatedPage:"actualizado.html"},popUpMode:false,popUpModeProfile:false,enableRedirect:true,htmlBenefits:'<ul class="vocuser-listchecks"><li><span class="vocuser-iconsfonts-check"></span><span class="vocuser-listchecks-txt">Podr&aacute;s participar en concursos, sorteos y promociones</span></li><li><span class="vocuser-iconsfonts-check"></span><span class="vocuser-listchecks-txt">Disfrutar&aacute;s de ofertas exclusivas</span></li><li><span class="vocuser-iconsfonts-check"></span><span class="vocuser-listchecks-txt">Estar&aacute;s siempre actualizado con las &uacute;ltimas noticias</span></li><li><span class="vocuser-iconsfonts-check"></span><span class="vocuser-listchecks-txt">Recibir&aacute;s nuestras newsletters con contenido exclusivo en tu email</span></li><li><span class="vocuser-iconsfonts-check"></span><span class="vocuser-listchecks-txt">Podr&aacute;s comentar las noticias y compartirlas</span></li></ul>',autosubscribeConfig:{},showAdditionalDataPage:false}}function checkBackUrlCookieContains(needle){var result=false;if(("undefined"!==typeof needle)&&(needle)){var url=getNfrylCookie();if(("undefined"!==typeof url)&&(url)){if(url.indexOf(needle)>-1){result=true}}}return result}function checkUserFlowUrlsContains(needle,url){var result=false;if(("undefined"!==typeof needle)&&(needle)){if(("undefined"!==typeof url)&&(url)){if(url.indexOf(needle)>-1){result=true}}if(false===result){result=checkBackUrlCookieContains(needle)}}return result}function registerFlow(flow){flows.push(flow);return this}function initFlows(){var element=0;for(element=0;element<flows.length;element++){options=$.extend(true,options,flows[element].getOptions());flows[element].setOptions(options);flows[element].setProtectedFunctions(protectedFunctions);if(Vocento.customValidation.setOptions){Vocento.customValidation.setOptions(options);Vocento.customValidation.setFields(flows[element].getCustomValidationFields())}}for(element=0;element<flows.length;element++){flows[element].execute()}return this}function deleteUnitTesting(environment){var result=false;if(("undefined"===typeof environment)||(!environment)||(("desn"!==environment)&&("des"!==environment)&&("desnlocal"!==environment)&&("local"!==environment)&&("desnlocal-vocuser"!==environment))){if("undefined"!==typeof objectUnitTesting){objectUnitTesting=null}if(("undefined"!==typeof gigyaUX)&&(gigyaUX)&&("undefined"!==typeof gigyaUX.objectUnitTesting)&&(gigyaUX.objectUnitTesting)){gigyaUX.objectUnitTesting=null}result=true}return result}function addCustomFieldsInScreen(screenName,opts){if(("undefined"===typeof opts)||(!opts)){opts=options}Vocento.insertCustomFields.setOptions(opts);if(("undefined"!==typeof screenName)||(screenName)){for(var element=0;element<flows.length;element++){Vocento.insertCustomFields.setManifest(flows[element].getInsertCustomField());Vocento.insertCustomFields.getHTML(screenName)}}}function init(){options=getOptions();initFlows();options=$.extend(true,options,externalOptions);if(true===userIsInFlowScreen()){service=getLastServiceFromVocUserInformationCookie();options.service=service}else{updateFieldInCookieVocUser("extensionFlowUrl","",true);updateFieldInCookieVocUser("lastAction","",true)}saveLastServiceInCookieVocUser(options.service,false);log=(options.debug&&Vocento.log)?Vocento.log:function(){};log(options,"info");userDataReady();registerUI();redirectToBackUrlOnLogin();gigya.socialize.addEventHandlers({onLogin:function(e){user=e.user;createCookies(user);if(!options.reloadOnLogin){fireEvent("socialize.onLogin",e);getUserInfo({})}eventSocializeOnLogin.resolve()},onLogout:function(e){removeCookies();removeSimpleStorage();clearFieldReturnUrlInCookieVocUser();if(!options.reloadOnLogout){fireEvent("socialize.onLogout",e);user=null;updateUI()}}});gigya.accounts.addEventHandlers({onLogin:function(e){account=e;if(("undefined"===typeof user)||(!user)){user=e}fireEvent("accounts.onLogin",e);actionsAfterLogin(e);eventAccountsOnLogin.resolve()},onLogout:function(e){removeCookies();removeSimpleStorage();clearFieldReturnUrlInCookieVocUser();if(options.reloadOnLogout){Vocento.reload()}else{fireEvent("accounts.onLogout",e);account=null}}});getUserInfo({});getAccountInfo({});$.when(eventServiceAdd,eventCheckService,eventSetAccountInfoCallback).done(function(response1,response2,response3){fireEvent("accounts.addServiceCompleted",response3)});addGigyaEventMap();Vocento.insertCustomFields.removeHTML();var screenName=getCurrentScreenName();if(("undefined"!==typeof screenName)&&(screenName)){addCustomFieldsInScreen(screenName,options);if((screenName===options.screenName.login)||(screenName===options.screenName.formulario)){addCustomFieldsInScreen(options.screenName.completo,options);if(options.showAdditionalDataPage){addCustomFieldsInScreen(options.screenName.additionalData,options)}}if(screenName===options.screenName.enlazar&&options.showAdditionalDataPage){addCustomFieldsInScreen(options.screenName.additionalData,options)}}deleteUnitTesting(options.envFront);return this}function addGigyaEventMap(){var result=false;var eventMap=[];var eventObject={events:"beforeRequest",method:globalHookEventMapOnBeforeRequest,args:[function(eventObject){return eventObject}]};eventMap.push(eventObject);eventObject={events:"onRefreshExternalComponentsEvent",method:globalHookEventMapOnBeforeRequest,args:[function(eventObject){return eventObject}]};eventMap.push(eventObject);var eventContent={eventMap:eventMap};gigya.defaultEventMaps=[];gigya.defaultEventMaps.push(eventContent);result=true;return result}function getDomainTldFromUrl(url){var result=false;if(("undefined"!==typeof url)&&(url)){var domain=url.split(".");if(domain.length>=2){domain=domain[domain.length-2]+"."+domain[domain.length-1];result=domain}}return result}function getSubDomainDomainTldFromUrl(url){var result=false;if(("undefined"!==typeof url)&&(url)){var domain=url.split("/");if(domain.length>=3){domain=domain[2];result=domain}}return result}function setNewCommunicationsStructure(obj){var result=false;if(("undefined"!==typeof obj)&&(obj)&&("undefined"!==typeof obj.params)&&(obj.params)&&("undefined"!==typeof obj.params.data)&&(obj.params.data)){var communicationsArray=new Array();var date=new Date().toISOString();if(obj.params.data.hasOwnProperty("adsGroup")){communicationsArray.push({ID:"adsGroup",status:obj.params.data.adsGroup,updateDate:date})}if(obj.params.data.hasOwnProperty("adsThirdparty")){communicationsArray.push({ID:"adsThirdparty",status:obj.params.data.adsThirdparty,updateDate:date})}if(obj.params.data.hasOwnProperty("adsMedia")&&obj.params.data.adsMedia.hasOwnProperty(obj.params.cid)){communicationsArray.push({ID:"adsMedia",status:eval("obj.params.data.adsMedia."+obj.params.cid),updateDate:date})}if(communicationsArray.length>=1){result=communicationsArray}}return result}function setNewCustomerServicesStructure(obj){var result=false;var customerServicesArray=new Array();var date=new Date().toISOString();result=getCustomerServiceFromCookieAndUpdateOptions();customerServicesArray.push({ID:options.serviceId,firstService:true,siteID:options.siteId,createdDate:date,platform:options.platform,device:options.device,serviceReference:options.serviceReference});if(customerServicesArray.length>=1){result=customerServicesArray}return result}function setAdditionalDataStructure(additionalDataCollection){additionalDataCollection=typeof additionalDataCollection!="undefined"?additionalDataCollection:{};var result=false;var createdDateTime=new Date().toISOString();var additionalDataArray=new Array();var tmpObj={};tmpObj.serviceID=options.serviceId;tmpObj.serviceReference=options.serviceReference;tmpObj.createdAt=createdDateTime;if(additionalDataCollection.length>0){additionalDataArray=additionalDataCollection}additionalDataArray.push(tmpObj);if(additionalDataArray.length>=1){result=additionalDataArray}return result}function globalHookEventMapOnBeforeRequest(obj){var screenGigyaCompleteRegistration=$("#gigya-complete-registration-screen:visible");var screenGigyaUpdateProfileScreen=$("#gigya-update-profile-screen:visible");if("beforeRequest"===obj.eventName){if("accounts.register"===obj.methodName||(("accounts.setAccountInfo"===obj.methodName)&&(("undefined"!==typeof screenGigyaCompleteRegistration&&screenGigyaCompleteRegistration&&(screenGigyaCompleteRegistration.length>0))||("undefined"!==typeof screenGigyaUpdateProfileScreen&&screenGigyaUpdateProfileScreen&&(screenGigyaUpdateProfileScreen.length>0))))){if(options.saveGigyaCommunications){var communications=setNewCommunicationsStructure(obj);if(false!==communications){if(("undefined"===obj.params.data)||(!obj.params.data)){obj.params.data={}}obj.params.data.communications=communications}}}if("accounts.register"===obj.methodName||("accounts.setAccountInfo"===obj.methodName&&"undefined"!==typeof screenGigyaCompleteRegistration&&screenGigyaCompleteRegistration&&(screenGigyaCompleteRegistration.length>0))){if(options.saveGigyaCustomerServices){var customerServices=setNewCustomerServicesStructure(obj);if(false!==customerServices){if(("undefined"===obj.params.data)||(!obj.params.data)){obj.params.data={}}obj.params.data.customerService=customerServices}}}if("accounts.register"===obj.methodName||("accounts.setAccountInfo"===obj.methodName&&"undefined"!==typeof screenGigyaCompleteRegistration&&screenGigyaCompleteRegistration&&(screenGigyaCompleteRegistration.length>0))){if(options.showAdditionalDataPage){var additionalDataFilled=setAdditionalDataStructure();if(false!==additionalDataFilled){if(("undefined"===obj.params.data)||(!obj.params.data)){obj.params.data={}}obj.params.data.additionalDataFilled=additionalDataFilled}}}}}function sendCustomerService(serviceId,serviceReference){var result=false;if(("undefined"!==typeof serviceId)&&(serviceId)){var url=getNfrylCookie();if(("undefined"===typeof url)||(!url)||("/"===url)){url=window.location.href}if(("undefined"!==typeof url)&&(url)){if(url[url.length-1]==="/"){url=url.substring(0,url.length-1)}}var UID=getCookieVocUidInformation("uid");var UIDSignature=getCookieVocUidInformation("uidSignature");var signatureTimestamp=getCookieVocUidInformation("signatureTimestamp");var regTokenInCookie=getCookieVocUserInformation("regToken");var customerServiceAdditionalInformation="";if(("undefined"!==typeof serviceReference)&&(serviceReference)){customerServiceAdditionalInformation=serviceReference}var postJsonData={UID:UID,UIDSignature:UIDSignature,signatureTimestamp:signatureTimestamp,url:url,serviceId:serviceId,customerServiceAdditionalInformation:customerServiceAdditionalInformation};if(("undefined"!==typeof regTokenInCookie)&&(regTokenInCookie)){postJsonData.regToken=regTokenInCookie}var urlService=options.authServerVocCore+"/vocuser/v1/user/customer-service/subscribe-by-id";try{result=$.ajax({url:urlService,type:"POST",data:postJsonData,async:true,dataType:"json",success:function(response){},error:function(xhr){}})}catch(err){}}return result}function saveRegTokenOnRegister(regToken,screenName){var result=false;if(("undefined"!==typeof regToken)&&(regToken)&&("undefined"!==typeof screenName)&&(screenName)&&((options.screenName.formulario===screenName)||(options.screenName.completo===screenName))){result=updateFieldInCookieVocUser("regToken",regToken,true)}return result}function saveLastActionInVocUserCookie(lastAction){var result=false;if(("undefined"!==typeof lastAction)&&(lastAction)){result=updateFieldInCookieVocUser("lastAction",lastAction,true)}return result}function saveExtensionFlowUrlInVocUserCookie(extensionFlowUrl){var result=false;if(("undefined"!==typeof extensionFlowUrl)&&(extensionFlowUrl)){result=updateFieldInCookieVocUser("extensionFlowUrl",extensionFlowUrl,true)}return result}function checkLegalTerms(e){var profile=e.profile;var data=e.data;if(("undefined"!==typeof data)&&(data)){if(typeof data.legaltermsLastUpdate==="undefined"||data.legaltermsLastUpdate<options.legaltermsLastUpdate){}}return this}function isFirstLogin(gigyaEvent){var result=false;var eObject=getGigyaResponse(gigyaEvent);if((("undefined"!==typeof eObject)&&(eObject)&&("undefined"!==typeof eObject.data)&&(eObject.data))){var data=eObject.data;if(typeof data.initLoginComplete==="undefined"||false===data.initLoginComplete){result=true}}else{if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.data)&&(account.data)&&((typeof account.data.initLoginComplete==="undefined")||(false===account.data.initLoginComplete))){result=true}}return result}function userCreatedWithinTenMinutes(gigyaEvent){var result=false;var eObject=getGigyaResponse(gigyaEvent);if(("undefined"!==typeof eObject)&&(eObject)){if((typeof eObject.createdTimestamp!=="undefined")&&(eObject.createdTimestamp)){if(!Date.now){Date.now=function(){return new Date().getTime()}}var currentDateInSeconds=Math.floor(Date.now()/1000);var createdTimeDifference=currentDateInSeconds-(eObject.createdTimestamp/1000);if(createdTimeDifference>600){result=false}else{result=true}}}return result}function checkFirstLogin(e){if(true===isFirstLogin(e)){fireEvent("user.firstLogin",e)}return this}function setLastLogin(params){var context=getContext();var data={};data.lastLogin={url:options.backURL,timestamp:context.timestamp};var responseSetAccountInfo=setAccountInfo({data:data,callback:params.callback});return responseSetAccountInfo}function setCurrentService(value){var result=false;if(("undefined"!==typeof value)&&(value)){service=value;options.service=value;result=saveLastServiceInCookieVocUser(value,true)}return result}function getCurrentService(){return service}function getAuthServer(){return options.authServer}function saveServiceAndServices(services,service){var result=false;if(typeof services==="undefined"){services={}}if(("undefined"!==typeof services)&&(services)&&("undefined"!==typeof service)&&(service)){var send=false;if(typeof services[options.ssoGroup]==="undefined"||false===services[options.ssoGroup]){services[options.ssoGroup]=service;send=true}else{var servicesList=services[options.ssoGroup].split(",");var serviceFound=false;for(var i=0;i<servicesList.length;i++){if(service.toLowerCase()===servicesList[i].toLowerCase()){serviceFound=true}}if(false===serviceFound){services[ssoGroup]+=","+service;send=true}}if(send){var data={};data.services=services;var params={data:data};var promiseSetAccountInfo=setAccountInfo(params);promiseSetAccountInfo.then(function(result){return true})}}return result}function checkService(e){var data=e.data;var result=false;var lastService=getLastServiceFromVocUserInformationCookie();result=saveServiceAndServices(data.services,lastService);if(result){var eventData={e:e,account:account};eventCheckService.resolve(eventData)}return this}function checkNickname(e){var profile=e.profile;var data=e.data;if(("undefined"!==typeof profile)&&(profile)&&("undefined"!==typeof profile.nickname)&&(profile.nickname)){var verifyUniqueNicknameFlushed=false;if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){verifyUniqueNicknameFlushed=simpleStorage.get("verifyUniqueNicknameFlushed");if(("undefined"===typeof verifyUniqueNicknameFlushed)||(true!==verifyUniqueNicknameFlushed)){var url=options.authServer+"/verify_unique_nickname.html?UID="+e.UID+"&nickname="+encodeURIComponent(profile.nickname)+"&callback=?";$.getJSON(url,function(result){simpleStorage.set("verifyUniqueNicknameFlushed",true,{TTL:300000});if(!result.isValid){fireEvent("user.duplicateNickname",e)}})}}}else{fireEvent("user.noNickname",e)}}function checkPaywallId(e,callback){var result=false;if("undefined"!==typeof options.hasPaywall&&options.hasPaywall){var eObject=getGigyaResponse(e);if((("undefined"!==typeof eObject)&&(eObject)&&("undefined"!==typeof eObject.data)&&(eObject.data))){if("undefined"===typeof eObject.data.paywall||"undefined"===typeof eObject.data.paywall.userId||!eObject.data.paywall.userId){var profile=eObject.profile;var data=eObject.data;var emailEncoded=encodeURIComponent(eObject.profile.email);var userDataForVerifySignature=protectedFunctions.safeEncodeUserSignature(eObject.UID,eObject.UIDSignature,eObject.signatureTimestamp);var url=options.authServer+"/api/v1/evolokId?"+userDataForVerifySignature+"&email="+emailEncoded;$.ajax({url:url+"&callback=?",contentType:"application/json",dataType:"jsonp",success:function(response){if(response.success){log("Gigya::checkPaywallId => ID paywall ("+response.uid+")","info");account.data.paywall={};account.data.paywall.userId=response.uid;log("Seteando paywall id: "+protectedFunctions.getAccount().data.paywall.userId,"info");log(protectedFunctions.getAccount(),"info");setAccountInfo({data:account.data});if(("undefined"!==typeof e)&&(e)&&("undefined"!==typeof e.data)&&(e.data)){e.data.paywall={};e.data.paywall.userId=response.uid}if((typeof callback!=="undefined")&&(callback)&&(typeof callback==="function")){callback(e)}result=true}else{log("Gigya::checkPaywallId => ERROR obteniendo ID paywall del usuario","error")}},error:function(xhr,ajaxOptions,thrownError){log("Gigya::checkPaywallId => ERROR obteniendo ID paywall del usuario - xhr","error")}})}else{if((typeof callback!=="undefined")&&(callback)&&(typeof callback==="function")){callback(e)}}}}else{log("Gigya::evolokId => Atenci?n: hasPaywall = false","error")}}function evolokIdAndSynchronizeProductsOnLogin(e){var result=false;if("undefined"!==typeof options.hasPaywall&&options.hasPaywall){var eObject=null;if("undefined"!==typeof e.gigya_event){eObject=e.gigya_event}if("undefined"!==typeof e.response){eObject=e.response}if(null===eObject){eObject=e}if("undefined"===typeof eObject.data.paywall||"undefined"===typeof eObject.data.paywall.userId||!eObject.data.paywall.userId){var profile=eObject.profile;var data=eObject.data;var emailEncoded=encodeURIComponent(eObject.profile.email);var userDataForVerifySignature=protectedFunctions.safeEncodeUserSignature(eObject.UID,eObject.UIDSignature,eObject.signatureTimestamp);var url=options.authServer+"/api/v1/evolokId?"+userDataForVerifySignature+"&email="+emailEncoded;$.ajax({url:url+"&callback=?",contentType:"application/json",dataType:"jsonp",success:function(response){if(response.success){log("Gigya::evolokIdAndSynchronizeProductsOnLogin => ID paywall ("+response.uid+")","info");if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.data)&&(account.data)&&("undefined"!==typeof account.data.paywall)&&(account.data.paywall)){account.data.paywall={};account.data.paywall.userId=response.uid;log("Seteando paywall id: "+protectedFunctions.getAccount().data.paywall.userId,"info")}log(protectedFunctions.getAccount(),"info");setAccountInfo({data:account.data});if(("undefined"!==typeof e)&&(e)&&("undefined"!==typeof e.data)&&(e.data)){e.data.paywall={};e.data.paywall.userId=response.uid}synchronizeProductsOnLogin(e);result=true}else{log("Gigya::evolokIdAndSynchronizeProductsOnLogin => ERROR obteniendo ID paywall del usuario","error");reloadOnLoginForEcommerce()}},error:function(xhr,ajaxOptions,thrownError){log("Gigya::evolokIdAndSynchronizeProductsOnLogin => ERROR obteniendo ID paywall del usuario - xhr","error");reloadOnLoginForEcommerce()}})}else{synchronizeProductsOnLogin(e);result=true}}return result}function safeEncodeUserSignature(UID,UIDSignature,signatureTimestamp){var result=false;if(("undefined"!==typeof UID)&&("undefined"!==typeof UIDSignature)&&("undefined"!==typeof signatureTimestamp)){var UIDSafeEncoded=encodeURIComponent(UID);var UIDSignatureSafeEncoded=encodeURIComponent(UIDSignature);var signatureTimestampSafeEncoded=encodeURIComponent(signatureTimestamp);result="UID="+UIDSafeEncoded+"&UIDSignature="+UIDSignatureSafeEncoded+"&signatureTimestamp="+signatureTimestampSafeEncoded}return result}function verifyUser(e){$.ajax({url:options.authServer+"/api/v1/verifiedRegistration?callback=?",data:{UID:e.response.UID,UIDSignature:e.response.UIDSignature,signatureTimestamp:e.response.signatureTimestamp},type:"GET",dataType:"jsonp",success:function(result){if(result.success){if(options.loginOnVerify){notifyLoginUser(e)}}},error:function(xhr,ajaxOptions,thrownError){log("Gigya::verifyUser => ERROR xhr","error")}});return this}function notifyLoginUser(e){$.ajax({url:options.authServer+"/api/v1/notifyLogin",data:{targetUID:e.response.UID,UID:e.response.UID,UIDSignature:e.response.UIDSignature,signatureTimestamp:e.response.signatureTimestamp},type:"GET",dataType:"jsonp",success:function(result){log("Gigya::notifyLoginUser => Login notificado a Gigya","info");Vocento.reload()},error:function(xhr,ajaxOptions,thrownError){log("Gigya::notifyLoginUser => ERROR xhr","error")}});return this}function createCookieVocUid(domain,cookieExpires,createAlways){var result=false;var cookieData="";var gigyaSsoKey=gigya.partnerSettings.ssoKey;var UID="";var UIDSignature="";var signatureTimestamp="";var userAge="";var userZip="";var userGender="";var accountDataRegistrationService="";var accountDataServicesSsoGroup="";if((typeof account!=="undefined")&&(account)){UID=account.UID;UIDSignature=account.UIDSignature;signatureTimestamp=account.signatureTimestamp;if((typeof account.data!=="undefined")&&(account.data)){if((typeof account.data.registration!=="undefined")&&(account.data.registration)){if((typeof account.data.registration.service!=="undefined")&&(account.data.registration.service)){accountDataRegistrationService=account.data.registration.service}}if((typeof account.data.services!=="undefined")&&(account.data.services)){if((typeof account.data.services[ssoGroup]!=="undefined")&&(account.data.services[ssoGroup])){accountDataServicesSsoGroup=account.data.services[ssoGroup]}}}}if((typeof user!=="undefined")&&(user)){UID=user.UID;UIDSignature=user.UIDSignature;signatureTimestamp=user.signatureTimestamp;userAge=user.age;userZip=user.zip;userGender=user.gender}if((typeof account!=="undefined")&&(account)&&(typeof user!=="undefined")&&(user)){var jsonData='{    "uid": "'+UID+'", "uidSignature": "'+UIDSignature+'", "signatureTimestamp": "'+signatureTimestamp+'", "ssoApiKey": "'+gigyaSsoKey+'", "age": "'+userAge+'", "zip": "'+userZip+'", "gender": "'+userGender+'", "dataRegistrationService": "'+accountDataRegistrationService+'", "dataServicesSsoGroup": "'+accountDataServicesSsoGroup+'" }';cookieData=jsonData;var browser=Vocento.webBrowserDetector();if((browser.indexOf("Safari")>-1)||(browser.indexOf("Mobile")>-1)||(browser.indexOf("-?")>-1)){cookieData=encodeURIComponent(jsonData)}var cookieParameters={domain:domain,path:"/",expires:cookieExpires};result=createCookie(UID_COOKIE_NAME,cookieData,cookieParameters,createAlways)}return result}function createCookieVocUser(domain,cookieExpires,createAlways,data){var cookieData="";var lastService=service;if("undefined"!==typeof data.lastService){lastService=data.lastService}var jsonData='{    "lastService": "'+lastService+'" }';cookieData=jsonData;var browser=Vocento.webBrowserDetector();if((browser.indexOf("Safari")>-1)||(browser.indexOf("Mobile")>-1)||(browser.indexOf("-?")>-1)){cookieData=encodeURIComponent(jsonData)}var cookieParameters={domain:domain,path:"/",expires:cookieExpires};createCookie(VOCUSER_COOKIE_NAME,cookieData,cookieParameters,createAlways)}function decodeJsonCookieToObject(cookieObject){var result=false;var jsonObject="";if(("undefined"!==cookieObject)&&(cookieObject)&&(cookieObject)){try{jsonObject=JSON.parse(cookieObject.cookie);result=jsonObject}catch(err){try{cookieObject.cookie=decodeURIComponent(cookieObject.cookie);jsonObject=JSON.parse(cookieObject.cookie);result=jsonObject}catch(err){var errorParsing=true}}}return result}function getLastServiceFromVocUserInformationCookie(){var result=false;result=getCookieVocUserInformation("lastService");if(("undefined"===typeof result)||(false===result)){result=service}return result}function getCookieVocUserInformation(param){var cookie=$.cookie(VOCUSER_COOKIE_NAME);var jsonObject="";var browser="";if(("undefined"!==typeof cookie)&&(cookie)){if(("undefined"!==typeof Vocento)&&(Vocento)&&("undefined"!==typeof Vocento.webBrowserDetector)){browser=Vocento.webBrowserDetector();if((browser.indexOf("Safari")>-1)||(browser.indexOf("Mobile")>-1)||(browser.indexOf("-?")>-1)){cookie=decodeURIComponent(cookie)}}var cookieObject={cookie:cookie};jsonObject=decodeJsonCookieToObject(cookieObject);if(false===jsonObject){jsonObject=decodeJsonCookieToObject(cookieObject)}}if((typeof jsonObject==="undefined")||(typeof param==="undefined")){return jsonObject}else{return jsonObject[param]}}function getCookieVocUidInformation(param){var cookie=$.cookie(UID_COOKIE_NAME);var jsonObject="";var browser="";if(("undefined"!==typeof cookie)&&(cookie)){if(("undefined"!==typeof Vocento)&&(Vocento)&&("undefined"!==typeof Vocento.webBrowserDetector)){browser=Vocento.webBrowserDetector();if((browser.indexOf("Safari")>-1)||(browser.indexOf("Mobile")>-1)||(browser.indexOf("-?")>-1)){cookie=decodeURIComponent(cookie)}}var cookieObject={cookie:cookie};jsonObject=decodeJsonCookieToObject(cookieObject);if(false===jsonObject){jsonObject=decodeJsonCookieToObject(cookieObject)}}if((typeof jsonObject==="undefined")||(typeof param==="undefined")){return jsonObject}else{return jsonObject[param]}}function saveLastServiceInCookieVocUser(lastService,createAlways){var result=false;var serviceValue="";if(("undefined"!==typeof lastService)&&(lastService)){serviceValue=lastService}else{serviceValue=service}if(("undefined"===typeof createAlways)||(false===createAlways)){var userIsInFlow=userIsInFlowScreen();result=updateFieldInCookieVocUser("lastService",serviceValue,!userIsInFlow)}else{result=updateFieldInCookieVocUser("lastService",serviceValue,createAlways)}return result}function updateFieldInCookieVocUser(fieldName,fieldValue,createAlways){var result=false;if(("undefined"!==typeof fieldName)&&(fieldName)){var data={};data=getCookieVocUserInformation();if(("undefined"===typeof data)||(!data)){data={}}if(("undefined"===typeof fieldValue)){fieldValue=""}data[fieldName]=fieldValue;var cookieData=JSON.stringify(data);var mainDomain=Vocento.getMainDomain();var cookieExpires=30;var browser=Vocento.webBrowserDetector();if((browser.indexOf("Safari")>-1)||(browser.indexOf("Mobile")>-1)||(browser.indexOf("-?")>-1)){cookieData=encodeURIComponent(cookieData)}var cookieParameters={domain:mainDomain,path:"/",expires:cookieExpires};result=createCookie(VOCUSER_COOKIE_NAME,cookieData,cookieParameters,createAlways)}return result}function updateReturnUrlInVocUserCookie(url){var result=false;if(("undefined"!==typeof url)&&(url)){var createAlways=true;result=updateFieldInCookieVocUser("returnUrl",url,createAlways)}return result}function updateReturnUrlTimeoutInVocUserCookie(timeoutMiliseconds){var result=false;if(("undefined"!==typeof timeoutMiliseconds)&&(timeoutMiliseconds)){var createAlways=true;result=updateFieldInCookieVocUser("returnUrlTimeout",timeoutMiliseconds,createAlways)}return result}function userIsInFlowScreen(){var result=false;var currentPage="";var pageFound=false;currentPage=options.page.loginPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.loginAdditionalDataPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.registerPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.registerConfirmedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.resendMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.mailSendedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.validateMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.recoveryPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.sendedMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.changePasswdPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.passwdchangedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.profilePage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.interestPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.changePasswdProfilePage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}currentPage=options.page.profileUpdatedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=true}return result}function getCurrentScreenName(){var result=false;var currentPage="";var pageFound=false;currentPage=options.page.loginPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.login}currentPage=options.page.loginAdditionalDataPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.additionalData}currentPage=options.page.registerPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.formulario}currentPage=options.page.registerConfirmedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.confirmacion}currentPage=options.page.resendMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.reenviar}currentPage=options.page.mailSendedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.reenviado}currentPage=options.page.validateMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.validacion}currentPage=options.page.recoveryPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.recuperar}currentPage=options.page.sendedMailPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.enviado}currentPage=options.page.changePasswdPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.resetear}currentPage=options.page.passwdchangedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.actualizado}currentPage=options.page.profilePage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.perfil}currentPage=options.page.interestPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.intereses}currentPage=options.page.changePasswdProfilePage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.cambiar}currentPage=options.page.profileUpdatedPage;pageFound=new RegExp(currentPage+"$").test(window.location.pathname);if(true===pageFound){result=options.screenName.actualizado}return result}function createCookies(user){log("Gigya::createCookies => Creando cookies","info");var domain="."+Vocento.getMainDomain();if("undefined"===typeof user.bio){user.bio=""}var cookieExpires=30;$.cookie.raw=true;$.cookie(QUEID_COOKIE_NAME,"1",{path:"/",expires:cookieExpires});var xml_data='<?xml version="1.0" encoding="ISO-8859-1"?><resp tipo="ok"><msg id="201">Datos de acceso correctos</msg><user>'+user.nickname+"</user><user_email>"+user.email+"</user_email><user_nombre>"+user.firstName+"</user_nombre><user_apellido>"+user.lastName+"</user_apellido><user_avatar>"+user.thumbnailURL+"</user_avatar><user_profileurl>"+user.profileURL+"</user_profileurl><user_bio>"+user.bio+"</user_bio><url_retorno></url_retorno><moiden></moiden><servicio>"+service+"</servicio><time>"+user.signatureTimestamp+"</time><hash>"+user.UIDSignature+"</hash></resp>";$.cookie(REG_COOKIE_NAME,xml_data,{path:"/",expires:cookieExpires});createCookieEvolok();createCookieVocUid(domain,cookieExpires,true);fireEvent("user.createCookie")}function createCookieEvolok(){var domain="."+Vocento.getMainDomain();var cookieExpires=30;var evkCookieParameters={domain:domain,path:"/",expires:cookieExpires};var evkCookieName=EVK_COOKIE_NAME+gigya.partnerSettings.ssoKey;var createAlways=false;if((null===$.cookie(evkCookieName))||("undefined"===typeof $.cookie(evkCookieName))){var evkCookieData='"'+user.UID+"|"+user.UIDSignature+"|"+user.signatureTimestamp+'"';createCookie(evkCookieName,evkCookieData,evkCookieParameters,createAlways)}else{var evkCookieValue=$.cookie(evkCookieName);var cookieDeleteParams={path:"/"};deleteCookie(evkCookieName,cookieDeleteParams);createAlways=true;createCookie(evkCookieName,evkCookieValue,evkCookieParameters,createAlways)}}function createCookieAutoNewsletters(UID){var domain="."+Vocento.getMainDomain();var cookieExpires=1;var cookieData=encodeURIComponent(UID);var cookieParameters={domain:domain,path:"/",expires:cookieExpires};createCookie(AUTO_NEWSLETTERS_COOKIE_NAME,cookieData,cookieParameters,true)}function getCookieAutoNewsletters(){var result=false;var cookieValue=$.cookie(AUTO_NEWSLETTERS_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){try{result=decodeURIComponent(cookieValue)}catch(err){log("Error en getCookieVocUserTemporal() al decodificar la cookie: "+err,"error");cookieValue=$.cookie(AUTO_NEWSLETTERS_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){result=decodeURIComponent(cookieValue)}}}if(!result){return result}else{return decodeURIComponent(result)}}function removeAutoNewslettersCookie(){var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(AUTO_NEWSLETTERS_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(AUTO_NEWSLETTERS_COOKIE_NAME,null,{domain:domain,path:"/"})}}function createCookieVocUserTemporal(email){var domain="."+Vocento.getMainDomain();var cookieExpires=1;var cookieData=encodeURIComponent(email);var cookieParameters={domain:domain,path:"/",expires:cookieExpires};createCookie(VOCUSER_THANKYOU_COOKIE_NAME,cookieData,cookieParameters,true)}function getCookieVocUserTemporal(){var result=false;var cookieValue=$.cookie(VOCUSER_THANKYOU_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){try{result=decodeURIComponent(cookieValue)}catch(err){log("Error en getCookieVocUserTemporal() al decodificar la cookie: "+err,"error");cookieValue=$.cookie(VOCUSER_THANKYOU_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){result=decodeURIComponent(cookieValue)}}}if(!result){return result}else{return decodeURIComponent(result)}}function removeCookieVocUserTemporal(){var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(VOCUSER_THANKYOU_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(VOCUSER_THANKYOU_COOKIE_NAME,null,{domain:domain,path:"/"})}}function getNfrylCookie(){var result=false;var cookieValue=$.cookie(NFRYL_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){try{result=decodeURIComponent(cookieValue)}catch(err){log("Error en getNfrylCookie() al decodificar la cookie: "+err,"error");cookieValue=$.cookie(NFRYL_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){result=decodeURIComponent(cookieValue)}}}if(("undefined"===typeof result)||(!result)){result=window.location.href}return decodeURIComponent(result)}function removeNfrylCookie(){var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(NFRYL_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(NFRYL_COOKIE_NAME,null,{domain:domain,path:"/"})}}function removeNewslettersCookie(){var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(NEWSLETTERS_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(NEWSLETTERS_COOKIE_NAME,null,{domain:domain,path:"/"})}}function removeVocUserInformationCookie(){var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(VOCUSER_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(VOCUSER_COOKIE_NAME,null,{domain:domain,path:"/"})}}function createCookieForNfryl(url_back){var domain="."+Vocento.getMainDomain();var cookieExpires=1;var cookieData=encodeURIComponent(url_back);var cookieParameters={domain:domain,path:"/",expires:cookieExpires};createCookie(NFRYL_COOKIE_NAME,cookieData,cookieParameters,true)}function createCookie(cookieName,cookieData,cookieParameters,createAlways){var cookieCreated=false;if(true===createAlways){$.cookie(cookieName,cookieData,cookieParameters);cookieCreated=true}else{if((null===$.cookie(cookieName))||("undefined"===typeof $.cookie(cookieName))){$.cookie(cookieName,cookieData,cookieParameters);cookieCreated=true}}return cookieCreated}function deleteCookie(cookieName,cookieParameters){log("Gigya::deleteCookie => Eliminando cookie","info");if("undefined"!==typeof $.removeCookie){$.removeCookie(cookieName,cookieParameters)}else{$.cookie(cookieName,null,cookieParameters)}}function removeCookies(){log("Gigya::removeCookies => Eliminando cookies","info");var domain="."+Vocento.getMainDomain();if("undefined"!==typeof $.removeCookie){$.removeCookie(QUEID_COOKIE_NAME,{path:"/"});$.removeCookie(REG_COOKIE_NAME,{path:"/"});$.removeCookie(UID_COOKIE_NAME,{domain:domain,path:"/"});$.removeCookie(EVK_COOKIE_NAME+gigya.partnerSettings.ssoKey,{path:"/"});$.removeCookie(EVK_COOKIE_NAME+gigya.partnerSettings.ssoKey,{domain:domain,path:"/"});$.removeCookie(PAYWALL_COOKIE_NAME,{domain:domain,path:"/"});$.removeCookie("busSynchronizeFlushedCookie",{domain:domain,path:"/"})}else{$.cookie(QUEID_COOKIE_NAME,null,{path:"/"});$.cookie(REG_COOKIE_NAME,null,{path:"/"});$.cookie(UID_COOKIE_NAME,null,{domain:domain,path:"/"});$.cookie(EVK_COOKIE_NAME+gigya.partnerSettings.ssoKey,null,{path:"/"});$.cookie(EVK_COOKIE_NAME+gigya.partnerSettings.ssoKey,null,{domain:domain,path:"/"});$.cookie(PAYWALL_COOKIE_NAME,null,{domain:domain,path:"/"});$.cookie("busSynchronizeFlushedCookie",null,{domain:domain,path:"/"})}fireEvent("user.deleteCookie")}function clearFieldReturnUrlInCookieVocUser(){var result=false;var createAlways=true;result=updateFieldInCookieVocUser("returnUrl","",createAlways);return result}function updateXMLCookie(cookieName,cookieParameters,xmlTagToFind,valueToSet,xmlTagBeforePosition,updateAlways){var cookieUpdated=false;var cookieData="";if((null===$.cookie(cookieName))||("undefined"===typeof $.cookie(cookieName))){cookieUpdated=false}else{cookieData=$.cookie(cookieName);var beginXMLTagToFind="<"+xmlTagToFind+">";var endXMLTagToFind="</"+xmlTagToFind+">";var endXMLTagBeforePosition="</"+xmlTagBeforePosition+">";if(cookieData.indexOf(xmlTagToFind)!==-1){if(true===updateAlways){var valueBetweenTagsToReplace=cookieData.match(beginXMLTagToFind+"(.*)"+endXMLTagToFind);cookieData=cookieData.replace(valueBetweenTagsToReplace[1],valueToSet);cookieUpdated=true}else{cookieUpdated=false}}else{if(cookieData.indexOf(xmlTagBeforePosition)!==-1){var position=cookieData.indexOf(endXMLTagBeforePosition);valueToSet=beginXMLTagToFind+valueToSet+endXMLTagToFind;var cookieDataReplaced=[cookieData.slice(0,position),valueToSet,cookieData.slice(position)].join("");cookieData=cookieDataReplaced;cookieUpdated=true}else{cookieUpdated=false}}}if(true===cookieUpdated){$.cookie.raw=true;$.cookie(cookieName,cookieData,cookieParameters)}return cookieUpdated}function fireEvent(name,gigyaEvent){log("Gigya::fireEvent => Evento disparado. vocento.gigya."+name,"info");log(gigyaEvent,"info");var event=$.Event("vocento.gigya."+name);event.gigya_event=gigyaEvent;mainEventListener.trigger(event)}function getUserInfo(params){try{if(("undefined"!==typeof window.sessionStorage)&&(window.sessionStorage)&&(window.sessionStorage.length)){params.cacheTimeout=(params.cacheTimeout)?params.cacheTimeout:true}}catch(e){log("Gigya.getUserInfo => Error al acceder a window.sessionStorage.localStorage no habilitado ó cookies de terceros bloqueadas o todas las cookies están bloqueadas","warn")}params.includeAllIdentities=(params.includeAllIdentities)?params.includeAllIdentities:true;params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){if(protectedFunctions.compareGigyaErrorCode(e.errorCode,0)){authenticated=(e.user.UID&&e.user.UID!=="")}if(authenticated){log("Gigya::getUserInfo => Usuario autenticado","info");user=e.user;createCookies(user);fireEvent("user.onDataReady",e)}else{log("Gigya::getUserInfo => Usuario no autenticado. ERROR ( "+e.errorCode+"): "+e.errorMessage,"info");if(protectedFunctions.compareGigyaErrorCode(e.errorCode,"500026")){log("Gigya::getUserInfo => Usuario no autenticado. BUG GIGYA. ERROR de red: ( "+e.errorCode+"): "+e.errorMessage,"error")}else{removeCookies();clearFieldReturnUrlInCookieVocUser()}user=null;account=null;fireEvent("user.onDataNoReady",e)}setEmailVerifiedMessage(authenticated);updateUI();eventGetUserInfo.resolve(e)}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);function callbackGetUserInfo(e){if(protectedFunctions.compareGigyaErrorCode(e.errorCode,0)){authenticated=(e.user.UID&&e.user.UID!=="")}if(authenticated){log("Gigya::getUserInfo => Usuario autenticado","info");user=e.user;createCookies(user);fireEvent("user.onDataReady",e)}else{log("Gigya::getUserInfo => Usuario no autenticado. ERROR ( "+e.errorCode+"): "+e.errorMessage,"info");if(protectedFunctions.compareGigyaErrorCode(e.errorCode,"500026")){log("Gigya::getUserInfo => Usuario no autenticado. BUG GIGYA. ERROR de red: ( "+e.errorCode+"): "+e.errorMessage,"error")}else{removeCookies();clearFieldReturnUrlInCookieVocUser()}user=null;account=null;fireEvent("user.onDataNoReady",e)}setEmailVerifiedMessage(authenticated);updateUI()}gigya.socialize.getUserInfo(mergedParams);return false}function checkFirstComment(user){isFirstComment=true;if((typeof user!=="undefined")&&(user)&&(typeof user.data!=="undefined")&&(user.data)){if((typeof user.data.customerService!=="undefined")&&(user.data.customerService.length>0)){for(var i=0,len=user.data.customerService.length;i<len;i++){if(user.data.customerService[i]["ID"]==="110"){isFirstComment=false;break}}}}}function checkAdditionalDataFilled(user){var result=false;if(("undefined"!==typeof user)&&(user)&&("undefined"!==typeof user.data)&&(user.data)&&(typeof user.data.additionalDataFilled!=="undefined")&&(user.data.additionalDataFilled)&&(Object.keys(user.data.additionalDataFilled).length>0)){for(var i=0,len=user.data.additionalDataFilled.length;i<len;i++){if((user.data.additionalDataFilled[i]["serviceID"]===options.serviceId)&&(user.data.additionalDataFilled[i]["serviceReference"]===options.serviceReference)){result=true;break}}}else{if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.data)&&(account.data)&&("undefined"!==typeof account.data.additionalDataFilled)&&(account.data.additionalDataFilled)&&(Object.keys(account.data.additionalDataFilled).length>0)){for(var i=0,len=account.data.additionalDataFilled.length;i<len;i++){if((account.data.additionalDataFilled[i]["serviceID"]===options.serviceId)&&(account.data.additionalDataFilled[i]["serviceReference"]===options.serviceReference)){result=true;break}}}}return result}function getAccountInfo(params){params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();params.extraProfileFields=(params.extraProfileFields)?params.extraProfileFields:"nickname, firstName, lastName, birthDay, birthMonth, birthYear, address, zip, city, country, gender, work";var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){if(protectedFunctions.compareGigyaErrorCode(e.errorCode,0)){if(("undefined"!==typeof e)&&(e)&&("undefined"!==typeof e.UID)&&(e.UID)){authenticated=true}}if(authenticated){log("Gigya::getAccountInfo => Usuario autenticado","info");account=e;checkFirstComment(e);if(true===isFirstLogin(e)){removeSimpleStorage()}var domain="."+Vocento.getMainDomain();var cookieExpires=30;createCookieVocUid(domain,cookieExpires,true);checkPaywallId(e,sincronizarLlamadasEcommercePaywall);checkService(e);checkLegalTerms(e);checkNickname(e);checkFirstLogin(e);fireEvent("accounts.onDataReady",e)}else{log("Gigya::getAccountInfo => Usuario no autenticado. ERROR ( "+e.errorCode+"): "+e.errorMessage,"info");user=null;account=null;fireEvent("accounts.onDataNoReady",e);if(protectedFunctions.compareGigyaErrorCode(e.errorCode,0)){log("Gigya::getAccountInfo => Usuario no autenticado. BUG GIGYA. ERROR ( "+e.errorCode+"): "+e.errorMessage,"error")}}eventGetAccountInfo.resolve(e)}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.getAccountInfo(mergedParams);return false}function setAccountInfo(params){return new promiseNamespace(function(resolve,reject){params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){resolve(e);if(protectedFunctions.compareGigyaErrorCode(e.errorCode,0)){log("Gigya::setAccountInfo => Datos de cuenta de usuario enviados","info")}else{log("Gigya::setAccountInfo => ERROR ( "+e.errorCode+"): "+e.errorMessage,"error");if(("undefined"!==typeof e.validationErrors)&&(e.validationErrors)&&("undefined"!==typeof e.validationErrors[0])&&(e.validationErrors[0])&&("undefined"!==typeof e.validationErrors[0].fieldName)&&(e.validationErrors[0].fieldName)&&("undefined"!==typeof e.validationErrors[0].message)&&(e.validationErrors[0].message)){var fieldName=e.validationErrors[0].fieldName;log("Gigya::setAccountInfo => Error al guardar campo: "+fieldName+"; "+e.validationErrors[0].message,"error");var fieldValueToWrite="";if(fieldName.indexOf("data")!==-1){fieldName=fieldName.replace("data.","");fieldValueToWrite=e.requestParams.data[fieldName]}else{fieldValueToWrite=e.requestParams[fieldName]}log("Gigya::setAccountInfo => Intentado escribir el valor: "+fieldValueToWrite,"error")}}var eventData={e:e,account:account};eventSetAccountInfoCallback.resolve(eventData);fireEvent("accounts.setAccountInfo",eventData)}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.setAccountInfo(mergedParams)})}function logout(params){params=(params)?params:{};params.forceProvidersLogout=(params.forceProvidersLogout)?params.forceProvidersLogout:options.forceProvidersLogout;params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();options.reloadOnLogout=(typeof params.reloadOnLogout!=="undefined")?params.reloadOnLogout:options.reloadOnLogout;var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){log("Gigya::logout => logout correcto","info");authenticated=false;user=null;updateUI()}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);removeCookies();removeNfrylCookie();removeNewslettersCookie();removeVocUserInformationCookie();removeSimpleStorage();gigya.accounts.logout(mergedParams);return false}function resetPassword(params){params=(params)?params:{};params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){log("Gigya::resetPassword => reset password correcto","info");authenticated=false;user=null;updateUI()}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);removeCookies();removeSimpleStorage();clearFieldReturnUrlInCookieVocUser();gigya.accounts.resetPassword(mergedParams);return false}function switchScreen(params){params=(params)?params:{};params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){log("Gigya::accounts.switchScreen =>  Cambio Screen correcto","info")}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.switchScreen(mergedParams);return false}function hideScreenSet(params){params=(params)?params:{};params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){log("Gigya::accounts.hideScreenSet =>  Ocultar Screen correcto","info")}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.hideScreenSet(mergedParams);return false}function resendVerificationCode(params){params=(params)?params:{};params.forceProvidersLogout=(params.forceProvidersLogout)?params.forceProvidersLogout:options.forceProvidersLogout;params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){log("Gigya::accounts.resendVerificationCode => resendVerificationCode correcto","info")}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.resendVerificationCode(mergedParams);return false}function removeSimpleStorage(){var userInfo=account;if(("undefined"===typeof userInfo)||(!userInfo)){userInfo=user}if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){if(("undefined"!==typeof userInfo)&&(userInfo)&&("undefined"!==typeof userInfo.UID)&&(userInfo.UID)){simpleStorage.set("products."+userInfo.UID,"");simpleStorage.set("trials."+userInfo.UID,"");simpleStorage.deleteKey("products."+userInfo.UID);simpleStorage.deleteKey("trials."+userInfo.UID)}simpleStorage.set("busSynchronizeFlushed","");simpleStorage.set("listRegisteredFlushed","");simpleStorage.set("verifyUniqueNicknameFlushed","");simpleStorage.deleteKey("busSynchronizeFlushed");simpleStorage.deleteKey("listRegisteredFlushed");simpleStorage.deleteKey("verifyUniqueNicknameFlushed")}}function socialLogin(params){log("Gigya::socialLogin => ("+params.provider+") llamado ...","info");params.provider=(params.provider)?params.provider:"no provider";params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){setTimeout(function(){for(var element=0;element<flows.length;element++){safeInvoke(flows[element].screenSetHandlers.onSocialLoginHandler,e)}},250)}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.socialLogin(mergedParams);return false}function screenSetIsBanned(screenSetID){var result=false;if(("undefined"!==typeof screenSetID)&&(screenSetID)){if(("undefined"!==options.bannedScreenSets)&&(options.bannedScreenSets)&&(options.bannedScreenSets.length)){var totalBannedScreenSets=options.bannedScreenSets.length;var index=0;do{if(screenSetID===options.bannedScreenSets[index]){result=true}index=index+1}while((index<totalBannedScreenSets)&&(false===result))}}return result}function onScreenSubmitScrollToFirstError(){var submitObject=$(".gigya-input-submit");submitObject.click(function(){setTimeout(function(){var gigyaErrorMsg=$('[class*="gigya-error-code"]:first');if(("undefined"!==typeof gigyaErrorMsg)&&(gigyaErrorMsg)&&(gigyaErrorMsg.length)){var scrollToHeight=0;var gigyaErrorMsgTop=gigyaErrorMsg.offset().top;var headerElement=$("#header");var headerHeight=0;if(("undefined"!==typeof headerElement.offset)&&(headerElement.offset())&&("undefined"!==typeof headerElement.offset().top)){headerHeight=headerElement.offset().top}scrollToHeight=gigyaErrorMsgTop-headerHeight-1;var firstInputElementBeforeError=$('[class*="gigya-error-code"]:first').prevAll("input");if(("undefined"===typeof firstInputElementBeforeError)||(!firstInputElementBeforeError)||(firstInputElementBeforeError.length<=0)){firstInputElementBeforeError=$('[class*="gigya-error-code"]:first').prevAll().find("input")}if(("undefined"!==typeof firstInputElementBeforeError)&&(firstInputElementBeforeError)&&(firstInputElementBeforeError.length)){var firstInputElementBeforeErrorTop=firstInputElementBeforeError.offset().top;scrollToHeight=firstInputElementBeforeErrorTop-headerHeight-1}$("html, body").animate({scrollTop:scrollToHeight},200);var submitBtn=$("form:visible input[type=submit]");if(("undefined"!==typeof submitBtn)&&(submitBtn)&&(submitBtn.length)){submitBtn.val("Corrige los errores")}}},100)})}function setButtonMessage(field,event,flag,text){field=typeof field!=="undefined"?field:false;event=typeof event!=="undefined"?event:false;flag=typeof flag!=="undefined"?flag:true;text=typeof text!=="undefined"?text:false;var submitBtn="";if(("undefined"!==typeof field)&&(field)&&("undefined"!==typeof event)&&(event)){var fieldObject=protectedFunctions.findFieldInScreen(field,event);if(fieldObject){submitBtn=fieldObject.parents("form:visible").find("input[type=submit]")}}else{if((!field)&&(!event)){submitBtn=$("form:visible input[type=submit]")}}if(("undefined"!==typeof submitBtn)&&(submitBtn)&&(""!==submitBtn)){if(flag){submitBtn.val("Corrige los errores")}else{if(!flag){var tex="Cambiar Contrase"+Vocento.UnicodeToChar("n")+"a";if(text){tex=text}submitBtn.val(tex)}}}}function hideError(field,label){$(field).removeClass("gigya-error");$(field).removeClass("gigya-error-msg gigya-error-msg-active");$(label).html("").hide()}function onScreenSubmitChangeSubmitButtonText(e){setTimeout(function(){var errorsInForm=$('[class*="gigya-error-code"]');if(errorsInForm.length===0){switch(e.screen){case options.screenName.login:setButtonMessage(false,false,false,"Inicia sesi"+Vocento.UnicodeToChar("o")+"n");break;case options.screenName.formulario:setButtonMessage(false,false,false,"Reg"+Vocento.UnicodeToChar("i")+"strate");break;case options.screenName.additionalData:$("form:visible").find(".gigya-error").removeClass("gigya-error");setButtonMessage(false,false,false,"Completar informaci"+Vocento.UnicodeToChar("o")+"n");break;default:break}}if(errorsInForm.length>0){setButtonMessage()}if(e.screen===options.screenName.cambiar&&!e.isValid){setButtonMessage(e.field,e)}else{if(e.screen===options.screenName.cambiar&&e.isValid){setButtonMessage(e.field,e,false)}}if(e.screen===options.screenName.reenviar&&e.isValid){hideError("#"+e.screen+' input[name="email"]',"#"+e.screen+' span[data-bound-to="email"]');setButtonMessage(e.field,e,false,"Reenviar email")}},100)}function showAllErrorsOnFieldTab(){setTimeout(function(){var gigyaErrorCodeElements=$('[class*="gigya-error-code"]');if(("undefined"!==typeof gigyaErrorCodeElements)&&(gigyaErrorCodeElements)&&(gigyaErrorCodeElements.length)){gigyaErrorCodeElements.show()}},100)}function showScreenSet(params){log("Gigya::showScreenSet => ("+params.startScreen+") llamado ...","info");params.cid=(params.cid)?params.cid:options.cid;params.context=(params.context)?params.context:getContext();var callbacks={onError:params.onError,onBeforeScreenLoad:params.onBeforeScreenLoad,onAfterScreenLoad:params.onAfterScreenLoad,onFieldChanged:params.onFieldChanged,onBeforeSubmit:params.onBeforeSubmit,onAfterSubmit:params.onAfterSubmit,onHide:params.onHide};var standardCallbacks={onError:function(e){if(typeof e.screen!=="undefined"){$("form."+e.form+":visible #vocento-error-msg").html(translateError(e))}for(var element=0;element<flows.length;element++){safeInvoke(flows[element].screenSetHandlers.onErrorHandler,e)}fireEvent("showScreenSet.onError",e)},onBeforeScreenLoad:function(e){if(true===options.captcha.isVisible){$(".pls-container").remove();captcha=undefined;$("#g-recaptcha").hide();$("#g-recaptcha-login").hide();loginAttemps=0}for(var element=0;element<flows.length;element++){if(safeInvoke(flows[element].screenSetHandlers.onBeforeScreenLoadHandler,e)===false){fireEvent("showScreenSet.onBeforeScreenLoad",e);return false}}fireEvent("showScreenSet.onBeforeScreenLoad",e)},onAfterScreenLoad:function(e){if(true===options.captcha.isVisible){if(e.currentScreen==="gigya-register-screen"||e.currentScreen==="gigya-quick-register-screen"){$("#g-recaptcha").show();captcha=grecaptcha.render("g-recaptcha",{sitekey:"6LdmZgYTAAAAADQC06sXwn22WX7n0s4Nc1cuj-v7",callback:captchaVerifyCallback})}}var inputPlaceHolder=$("input[placeholder]:visible");if(("undefined"!==typeof inputPlaceHolder)&&(inputPlaceHolder)&&("undefined"!==typeof inputPlaceHolder.placeholder)&&(inputPlaceHolder.placeholder)){$("input[placeholder]:visible").placeholder()}for(var element=0;element<flows.length;element++){var fieldsSections=flows[element].getInsertCustomField().externalFieldsSection;if(typeof fieldsSections!=="undefined"){rellenarCamposExternos(fieldsSections,options.ssoGroup,e)}safeInvoke(flows[element].screenSetHandlers.onAfterScreenLoadHandler,e)}fireEvent("showScreenSet.onAfterScreenLoad",e);if(e.currentScreen===options.screenName.autologin){eventLastActionBeforeRedirect.resolve()}},onFieldChanged:function(e){for(var element=0;element<flows.length;element++){safeInvoke(flows[element].screenSetHandlers.onFieldChangedHandler,e)}fireEvent("showScreenSet.onFieldChanged",e)},onBeforeSubmit:function(e){var submitBtn=$("form."+e.form+":visible input[type=submit]");if(typeof submitBtn.data("originalValue")==="undefined"){submitBtn.data("originalValue",submitBtn.val())}submitBtn.val("Validando datos");if(e.screen==="gigya-register-screen"){var resultIsValidMail=isValidMail(e);if(false===resultIsValidMail){fireEvent("showScreenSet.onBeforeSubmit",e);return false}}if(e.form){Vocento.customValidation.setUser(user);Vocento.customValidation.setAccount(account);log("Gigya::screenSetHandlers => Validando formulario "+e.screen+" -> "+e.form,"info");if(Vocento.customValidation.validateForm(e.form,captcha)===false){fireEvent("showScreenSet.onBeforeSubmit",e);return false}}setSeccionesDeCamposExternos();for(var element=0;element<flows.length;element++){if(safeInvoke(flows[element].screenSetHandlers.onBeforeSubmitHandler,e)===false){fireEvent("showScreenSet.onBeforeSubmit",e);return false}}fireEvent("showScreenSet.onBeforeSubmit",e)},onAfterSubmit:function(e){if(protectedFunctions.compareGigyaErrorCode(e.response.errorCode,"206002")||protectedFunctions.compareGigyaErrorCode(e.response.errorCode,0)){for(var i=0;i<options.sectionsWithExternalFields.length;i++){modificarNuevoCampoExterno(options.sectionsWithExternalFields[i],options.ssoGroup,options.service,e)}}if(true===options.captcha.isVisible){if(e.screen==="gigya-login-screen"&&e.response.status==="FAIL"){loginAttemps=loginAttemps+1;if(loginAttemps>=options.captcha.loginAttemps){if(typeof(captcha)==="undefined"){$("#g-recaptcha-login").show();captcha=grecaptcha.render("g-recaptcha-login",{sitekey:"6LdmZgYTAAAAADQC06sXwn22WX7n0s4Nc1cuj-v7",callback:captchaVerifyCallback})}else{if(true===$.browser.mozilla){resetCaptchaFirefox("g-recaptcha-login")}else{grecaptcha.reset(captcha)}$("#vocento-error-captcha-msg").hide()}}}else{if((e.screen==="gigya-register-screen"||e.screen==="gigya-quick-register-screen")&&e.response.status==="FAIL"){if(true===$.browser.mozilla){resetCaptchaFirefox("g-recaptcha")}else{grecaptcha.reset(captcha)}$("#vocento-error-captcha-msg").hide()}}}if(e.screen===options.screenName.registration){if(options.autoVerifyUser){if(protectedFunctions.compareGigyaErrorCode(e.response.errorCode,"206002")){verifyUser(e)}}}for(var element=0;element<flows.length;element++){safeInvoke(flows[element].screenSetHandlers.onAfterSubmitHandler,e)}if(true===options.updateSelligentCommunications&&options.envVoccore===""&&(e.screen==="gigya-register-screen"||e.screen==="gigya-complete-registration-screen")&&(protectedFunctions.compareGigyaErrorCode(e.response.errorCode,"206002")||protectedFunctions.compareGigyaErrorCode(e.response.errorCode,0))){var url=options.authServerVocCore+"/vocuser/v1/user/communication/selligent/add";var data={UID:e.response.UID,data:{communications:e.response.data.communications}};try{$.ajax({url:url,type:"POST",data:JSON.stringify(data),async:true,dataType:"json",success:function(result){log("Gigya::updateSelligentCommunications => comunicaciones grabadas correctamente.","info")},error:function(xhr){log("Gigya::updateSelligentCommunications => error al grabar las comunicaciones.","error")}})}catch(err){}}fireEvent("showScreenSet.onAfterSubmit",e);eventLastActionBeforeRedirect.resolve()},onHide:function(e){Vocento.insertCustomFields.removeHTML();for(var element=0;element<flows.length;element++){safeInvoke(flows[element].screenSetHandlers.onHideHandler,e)}protectedFunctions.removeParentDiv("gigya-screen-dialog","",options.parentDivClass);fireEvent("showScreenSet.onHide",e)}};var combinedCallbacks={onError:function(e){standardCallbacks.onError(e);safeInvoke(callbacks.onError,e)},onBeforeScreenLoad:function(e){if(standardCallbacks.onBeforeScreenLoad(e)===false||safeInvoke(callbacks.onBeforeScreenLoad,e)===false){return false}},onAfterScreenLoad:function(e){standardCallbacks.onAfterScreenLoad(e);safeInvoke(callbacks.onAfterScreenLoad,e)},onFieldChanged:function(e){standardCallbacks.onFieldChanged(e);safeInvoke(callbacks.onFieldChanged,e)},onBeforeSubmit:function(e){if(standardCallbacks.onBeforeSubmit(e)===false||safeInvoke(callbacks.onBeforeSubmit,e)===false){return false}},onAfterSubmit:function(e){standardCallbacks.onAfterSubmit(e);safeInvoke(callbacks.onAfterSubmit,e)},onHide:function(e){standardCallbacks.onHide(e);safeInvoke(callbacks.onHide,e)}};var resultOpenScreenSet=screenSetIsBanned(params.screenSet);if(("undefined"===typeof resultOpenScreenSet)||(resultOpenScreenSet!==true)){var mergedParams=$.extend(params,combinedCallbacks);gigya.accounts.showScreenSet(mergedParams)}return false}function getSectionsWithExternalFields(){return options.sectionsWithExternalFields}function setSeccionesDeCamposExternos(){options.sectionsWithExternalFields=[];for(var element=0;element<flows.length;element++){var fieldsSections=flows[element].getInsertCustomField().externalFieldsSection;if(typeof fieldsSections!=="undefined"){for(var section in fieldsSections){var newFields=fieldsSections[section];var seccion={name:section,fields:[]};for(var i=0;i<newFields.length;i++){var fieldsValue={name:newFields[i],value:$("form:visible [vocento-name="+newFields[i]+"]").val()};seccion.fields.push(fieldsValue)}options.sectionsWithExternalFields.push(seccion)}}}}function getUidUsuarioGigya(e){var uidActual=null;if(typeof e.response.UID!=="undefined"){uidActual=e.response.UID}else{if(user&&typeof user.UID!=="undefined"){uidActual=user.UID}}return uidActual}function rellenarCamposExternos(fieldsSections,sso,e){var uidActual=getUidUsuarioGigya(e);for(var section in fieldsSections){var campoBuscado=buscarCampoEnMongoDeUsuario(sso,uidActual,section);var fieldsData=campoBuscado.result.fields[0];if(campoBuscado.msg!=="No se han encontrado campos con las caracteristicas pedidas"){for(var i=0;i<fieldsData.fieldData.length;i++){$("form:visible [vocento-name="+fieldsData.fieldData[i].name+"]").val(fieldsData.fieldData[i].value)}}}}function buscarCampoEnMongoDeUsuario(sso,uid,sectionName){var campoBuscado;if(typeof sso!=="undefined"&&(uid!==null)&&typeof sectionName!=="undefined"){var findFieldsOfSso={sso:sso,uid:uid,section:sectionName};campoBuscado=llamadaApiMongo(options.url_busqueda_mongo,JSON.stringify(findFieldsOfSso),false)}return campoBuscado}function modificarNuevoCampoExterno(section,sso,service,e){var uidActual=getUidUsuarioGigya(e);var campoBuscado=buscarCampoEnMongoDeUsuario(sso,uidActual,section.name);var fieldData;if(campoBuscado&&campoBuscado.msg!=="No se han encontrado campos con las caracteristicas pedidas"){fieldData=generacionJsonParaApiMongo(section,sso,service,uidActual,e);llamadaApiMongo(options.url_edicion_mongo,JSON.stringify(fieldData),true)}else{fieldData=generacionJsonParaApiMongo(section,sso,service,uidActual,e);llamadaApiMongo(options.url_creacion_mongo,JSON.stringify(fieldData),true)}}function generacionJsonParaApiMongo(section,sso,service,uidActual,e){var email=e.profile.email;var uidSignature=encodeURIComponent(e.response.UIDSignature);var signatureTimestamp=encodeURIComponent(e.response.signatureTimestamp);var uidSafeEncoded=encodeURIComponent(uidActual);var fieldsData=[];for(var i=0;i<section.fields.length;i++){var fieldsValue={name:section.fields[i].name,value:section.fields[i].value};fieldsData.push(fieldsValue)}var data={field:{sso:sso,uid:uidActual,uidSafeEncoded:uidSafeEncoded,uidSignature:uidSignature,signatureTimestamp:signatureTimestamp,email:email,service:service,section:section.name,fieldData:fieldsData}};return data}function llamadaApiMongo(url,data,isAsync){var response;$.ajax({url:url,type:"POST",data:data,async:isAsync,dataType:"json",success:function(result){response=result},error:function(xhr){response=xhr;log("MongoApi:: Llamada a la api ajax errónea.","error")}});return response}function getRootUrl(){var protocol=window.location.protocol;var host=window.location.host;var domain=options.domains[options.ssoGroup];if(window.location.pathname.indexOf("/app_dev.php/")===0){return protocol+"//"+host+"/app_dev.php"}if(window.location.pathname.indexOf("/app.php/")===0){return protocol+"//"+host+"/app.php"}if(host.indexOf("srv.vocento.in")>-1){return protocol+"//"+host}return"http://"+options.envFront+"."+domain}function getUrlRegisterConfirmationScreen(){return getRootUrl()+options.route.registerConfirmedURL}function getUrlRegisterPendingConfirmationScreen(){return getRootUrl()+options.route.resendMailURL}function getUrlPasswdSendScreen(){return getRootUrl()+options.route.sendedMailURL}function getUrlPasswordChangedScreen(){return getRootUrl()+options.route.passwdchangedURL}function getUrlProfileScreen(){return getRootUrl()+options.route.profileURL}function getUrlInterestsScreen(){return getRootUrl()+options.route.interestURL}function getUrlAdditionalDataScreen(){return getRootUrl()+options.route.loginAdditionalDataURL}function showLoginPage(){window.location.href=getRootUrl()+options.route.loginURL}function showLoginAdditionalDataPage(){window.location.href=getRootUrl()+options.route.loginAdditionalDataURL}function showRegisterPage(){window.location.href=getRootUrl()+options.route.registerURL}function showRecoveryPage(){window.location.href=getRootUrl()+options.route.recoveryURL}function showProfilePage(){window.location.href=getRootUrl()+options.route.profileURL}function showInterestsPage(){window.location.href=getRootUrl()+options.route.interestURL}function showProfileUpdatedPage(){window.location.href=getRootUrl()+options.route.profileUpdatedURL}function showChangePasswdProfilePage(){window.location.href=getRootUrl()+options.route.changePasswdProfileURL}function redirectToProfileAreaPersonal(){var urlAreaPersonal=getAreaPersonalDomain();window.location.href=urlAreaPersonal+"/gestion/mi-cuenta.html"}function showBackPageForBackLink(){options.backURL=getNfrylCookie();if("undefined"!==typeof options.backURL&&options.backURL){removeNfrylCookie();window.location.href=options.backURL}}function selectPopUpMode(popUpMode){var mode=options.popUpMode;if("undefined"!==typeof popUpMode){mode=popUpMode}return mode}function showLogin(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.login;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.auth,mobileScreenSet:options.screenSet.mobile.auth,startScreen:startScreen,containerID:container_id})}else{showLoginPage()}return false}function showRegistration(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.registration;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.auth,mobileScreenSet:options.screenSet.mobile.auth,startScreen:startScreen,containerID:container_id})}else{showRegisterPage()}return false}function showProfile(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.profile;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.profile,mobileScreenSet:options.screenSet.mobile.profile,startScreen:startScreen,containerID:container_id})}else{showProfilePage()}return false}function showInterests(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.interests;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.profile,mobileScreenSet:options.screenSet.mobile.profile,startScreen:startScreen,containerID:container_id})}else{showInterestsPage()}return false}function showChangePasswdProfile(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.change;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.profile,mobileScreenSet:options.screenSet.mobile.profile,startScreen:startScreen,containerID:container_id})}else{showChangePasswdProfilePage()}return false}function showProfileUpdated(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.updated;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.profile,mobileScreenSet:options.screenSet.mobile.profile,startScreen:startScreen,containerID:container_id})}else{return showProfileUpdatedPage()}return false}function showLoginAdditionalData(container_id,popUpMode,startScreenName){var mode=selectPopUpMode(popUpMode);var startScreen=options.screenName.additionalData;if(("undefined"!==typeof startScreenName)&&(startScreenName)){startScreen=startScreenName}if(("undefined"===typeof mode)||(true===mode)){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:options.screenSet.web.profile,mobileScreenSet:options.screenSet.mobile.profile,startScreen:startScreen,containerID:container_id})}else{return showLoginAdditionalDataPage()}return false}function showSocialLoginCheckOut(container_id,params){if(typeof container_id!=="string"){container_id=""}showScreenSet({screenSet:"ss-checkout",mobileScreenSet:"ss-checkout",startScreen:"gigya-rrss-login-form",containerID:container_id,onBeforeScreenLoad:params.onBeforeScreenLoad,onAfterScreenLoad:params.onAfterScreenLoad,onAfterSubmit:params.onAfterSubmit});return false}function bindOnClickEventToDomElement(selector,functionCode){var result=false;if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(functionCode);result=true}return result}function bindOnClickEventToDomElementName(selectorName,functionCode){var result=false;if(("undefined"!==typeof selectorName)&&(selectorName)){var selector=$(selectorName);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click")}$(document).on("click",selectorName,function(event){event.stopPropagation();event.stopImmediatePropagation();functionCode()});result=true}return result}function bindOnClickEventToLogin(){var selectorName="";selectorName=options.loginLinkSelector;function bindOnClickToLogin(){showLogin()}bindOnClickEventToDomElementName(selectorName,bindOnClickToLogin)}function bindOnClickEventToLogout(){var selectorName="";selectorName=options.logoutLinkSelector;function bindOnClickToLogout(){logout()}bindOnClickEventToDomElementName(selectorName,bindOnClickToLogout)}function registerUI(){var selectorName="";bindOnClickEventToLogin();selectorName=options.registrationLinkSelector;function bindOnClickToRegister(){showRegistration()}bindOnClickEventToDomElementName(selectorName,bindOnClickToRegister);selectorName=options.recoveryLinkSelector;function bindOnClickToRecoveryPass(){showRecoveryPage()}bindOnClickEventToDomElementName(selectorName,bindOnClickToRecoveryPass);selectorName=options.backLinkSelector;function bindOnClickToBackLink(){showBackPageForBackLink()}bindOnClickEventToDomElementName(selectorName,bindOnClickToBackLink);selectorName=options.profileLinkSelector;function bindOnClickToProfileLink(){showProfile("",options.popUpModeProfile,options.screenName.perfil)}bindOnClickEventToDomElementName(selectorName,bindOnClickToProfileLink);selectorName=options.profileAreaPersonalLinkSelector;function bindOnClickToProfileAreaPersonalLink(){redirectToProfileAreaPersonal()}bindOnClickEventToDomElementName(selectorName,bindOnClickToProfileAreaPersonalLink);selectorName=options.profileInterestsLinkSelector;function bindOnClickToProfileInterestsLink(){showInterests("",options.popUpModeProfile,options.screenName.intereses)}bindOnClickEventToDomElementName(selectorName,bindOnClickToProfileInterestsLink);selectorName=options.profileChangePasswdLinkSelector;function bindOnClickToProfileChangePasswdLink(){showChangePasswdProfile("",options.popUpModeProfile,options.screenName.change)}bindOnClickEventToDomElementName(selectorName,bindOnClickToProfileChangePasswdLink);bindOnClickEventToLogout()}function updateUI(){var selector="";selector=$(options.loginLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showLogin("",options.popUpMode,"")})}selector=$(options.registrationLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showRegistration("",options.popUpMode,"")})}selector=$(options.recoveryLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showRecoveryPage()})}selector=$(options.backLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showBackPageForBackLink()})}selector=$(options.profileLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showProfile("",options.popUpModeProfile,"")})}selector=$(options.profileAreaPersonalLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){redirectToProfileAreaPersonal()})}selector=$(options.profileInterestsLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showInterests("",options.popUpModeProfile,"")})}selector=$(options.profileChangePasswdLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.unbind();selector.off("click");selector.click(function(e){showChangePasswdProfile("",options.popUpModeProfile,"")})}selector=$(options.logoutLinkSelector);if(("undefined"!==typeof selector)&&(selector)&&(selector.length)){selector.click(function(e){logout()})}if(authenticated){$(options.loggedOutSelector).hide();$(options.userFirstNameSelector).text(typeof user.firstName!=="undefined"&&user.firstName?user.firstName:user.nickname);$(options.userLastNameSelector).text(typeof user.lastName!=="undefined"&&user.lastName?user.lastName:user.nickname);$(options.userEmailSelector).text(typeof user.email!=="undefined"&&user.email?user.email:"");if(user.thumbnailURL){$(options.userThumbnailSelector).attr("src",user.thumbnailURL).show()}else{$(options.userThumbnailSelector).hide()}$(options.loggedInSelector).show();fireEvent("updateUI.loggedIn",user)}else{$(options.loggedInSelector).hide();$(options.loggedOutSelector).show();fireEvent("updateUI.loggedOut")}}function getUserSignature(user,encode){if(typeof encode==="undefined"){var encode=true}var evolokId="";if(("undefined"!==typeof user)&&(user)&&("undefined"!==typeof user.data)&&(user.data)&&("undefined"!==typeof user.data.paywall)&&(user.data.paywall)&&("undefined"!==typeof user.data.paywall.userId)&&(user.data.paywall.userId)){evolokId=encode?encodeURIComponent(user.data.paywall.userId):user.data.paywall.userId}return{UID:encode?encodeURIComponent(user.UID):user.UID,UIDSignature:encode?encodeURIComponent(user.UIDSignature):user.UIDSignature,signatureTimestamp:encode?encodeURIComponent(user.signatureTimestamp):user.signatureTimestamp,evolokId:evolokId}}function setProducts(products){var result="setProducts: El usuario no está logueado.";if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)){if(("undefined"!==typeof products)&&(products)&&(products.length)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.set("products."+account.UID,products,{TTL:300000});result="setProducts: Datos de productos almacenados en localStorage."}else{result="Gigya::setProducts: Error. No hay productos para el usuario con UID: "+account.UID;log("Gigya::setProducts => products está vacío, por favor compruebe si funcionan las urls: ","error");log("Gigya::setProducts => https://pre.utils.elcorreo.com/api/v1/paywall/busSynchronize","error");log("Gigya::setProducts => http://vocento.eb.sc.evolok.net/event-broker/services/rest/profileService/role","error")}}else{result="Gigya::trialsStorageCallback => Error: El usuario no está logueado o no tiene datos."}log(result,"info");return result}function setVocPaywallCookie(createAlways){var domain="."+Vocento.getMainDomain();var vocUserType=getUserTypeFromSimpleStorage();if((typeof vocUserType==="undefined")||(!vocUserType)){vocUserType="registrado"}var forceCreateCookie=false;if(("undefined"!==typeof createAlways)&&(createAlways)&&(createAlways===true)){forceCreateCookie=createAlways;if("undefined"!==typeof $.removeCookie){$.removeCookie(PAYWALL_COOKIE_NAME,{domain:domain,path:"/"})}else{$.cookie(PAYWALL_COOKIE_NAME,null,{domain:domain,path:"/"})}}var jsonData=window.location.origin+"|"+vocUserType;var cookieData=jsonData;var cookieParameters={domain:domain,path:"/",expires:30};setCookiePureJS(PAYWALL_COOKIE_NAME,cookieData,30,domain,"/",forceCreateCookie)}function getVocPaywallCookie(){var result=false;var cookieValue=getCookiePureJS(PAYWALL_COOKIE_NAME);var cookieSplitted="";if(("undefined"!==typeof cookieValue)&&(cookieValue)){try{cookieSplitted=cookieValue.split("|");result={windowLocationOrigin:cookieSplitted[0],vocUserType:cookieSplitted[1]}}catch(err){log("Error en getVocPaywallCookie() al decodificar la cookie: "+err,"error");var forceCreateCookie=true;setVocPaywallCookie(forceCreateCookie);cookieValue=getCookiePureJS(PAYWALL_COOKIE_NAME);if(("undefined"!==typeof cookieValue)&&(cookieValue)){cookieSplitted=cookieValue.split("|");result={windowLocationOrigin:cookieSplitted[0],vocUserType:cookieSplitted[1]}}}}return result}function setBusSynchronizeFlushed(){var result=false;if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.set("busSynchronizeFlushed",true,{TTL:300000});result=true}log(result,"info");return result}function setListRegisteredFlushed(){var result=false;if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.set("listRegisteredFlushed",true,{TTL:300000});result=true}log(result,"info");return result}function getProducts(userUID){var result="getProducts: El usuario no está logueado.";if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)){result=simpleStorage.get("products."+account.UID)}else{if(("undefined"!==typeof userUID)&&(userUID)){result=simpleStorage.get("products."+userUID)}}}else{result=false}log(result,"info");return result}function flushProducts(forceSynchronizeProducts,accountPreVerification){if(("undefined"===typeof account)||(!account)||("undefined"===typeof account.UID)||(!account.UID)){account=accountPreVerification}if(("undefined"===typeof user)||(!user)||("undefined"===typeof user.UID)||(!user.UID)){user=accountPreVerification}var result="flushProducts: El usuario no está logueado.";if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.deleteKey("products."+account.UID);synchronizeProducts(forceSynchronizeProducts,account);result="flushProducts: borrado la clave de productos del usuario y llamada a synchronizeProducts()."}log(result,"info");return result}function getTrials(userUID){var result="getTrials: El usuario no está logueado.";if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)){result=simpleStorage.get("trials."+account.UID)}else{if(("undefined"!==typeof userUID)&&(userUID)){result=simpleStorage.get("trials."+userUID)}}}log(result,"info");return result}function flushTrials(accountPreVerification){var result="flushTrials: El usuario no está logueado.";if(("undefined"===typeof account)||(!account)||("undefined"===typeof account.UID)||(!account.UID)){account=accountPreVerification}if(("undefined"===typeof user)||(!user)||("undefined"===typeof user.UID)||(!user.UID)){user=accountPreVerification}if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.deleteKey("trials."+account.UID);fetchTrials(user);result="flushTrials: borrado la clave de trials del usuario y llamada a fetchTrials()."}log(result,"info");return result}function productsStorageCallback(e){var result="Gigya::productsStorageCallback => Error: No hay productos";if(("undefined"!==typeof e.data)&&(e.data)&&(e.data.length)){result="Gigya::productsStorageCallback => respuesta OK";setProducts(e.data);log(result,"info")}else{if(("undefined"!==typeof e.status)&&(e.status)){result=result+"; Mensaje estado: "+e.status;log(result,"info")}log("Gigya::productsStorageCallback => Por favor compruebe si existe bloqueo de urls: ","info");log("Gigya::productsStorageCallback => https://pre.utils.SITIO.EXT/api/v1/paywall/busSynchronize","info");log("Gigya::productsStorageCallback => http://vocento.eb.sc.evolok.net/event-broker/services/rest/profileService/role","info");setBusSynchronizeFlushed()}var forceCreateCookie=true;setVocPaywallCookie(forceCreateCookie)}function fetchProducts(account){log("Gigya::fetchProducts => Lanzando consulta al API","info");var url=options.authServer+"/api/v1/bus/userProducts";try{if(false===flushedProducts){$.ajax({url:url+"?callback=?",data:getUserSignature(account),type:"get",contentType:"application/json",dataType:"jsonp",success:function(result){productsStorageCallback(result);var eventData={e:result,account:account};fireEvent("products.onReady",eventData);eventProductsOnReady.resolve(eventData)},error:function(xhr,ajaxOptions,thrownError){log("Gigya::fetchProducts => Error al obtener los productos","info");log("Gigya::fetchProducts => https://pre.utils.SITIO.EXT/api/v1/bus/userProducts","info");log("Gigya::fetchProducts => http://vocento.eb.sc.evolok.net/event-broker/services/rest/profileService/role","info");fireEvent("products.onError");var eventData={e:xhr,account:account};eventProductsOnReady.resolve(eventData)}});flushedProducts=true}}catch(err){log("Gigya::fetchProducts => Error al obtener los productos","error");log("Gigya::fetchProducts => https://pre.utils.SITIO.EXT/api/v1/bus/userProducts","error");log("Gigya::fetchProducts => http://vocento.eb.sc.evolok.net/event-broker/services/rest/profileService/role","error");fireEvent("products.onError");var eventData={e:err,account:account};eventProductsOnReady.resolve(eventData)}}function trialsStorageCallback(e){if(("undefined"!==typeof user)&&(user)&&("undefined"!==typeof user.UID)&&(user.UID)){if(("undefined"!==typeof e.status)&&(e.status)&&(e.status.toLowerCase()==="ok")){if(("undefined"!==typeof e.data)&&(e.data)&&(e.data.length)&&("undefined"!==typeof simpleStorage)&&(simpleStorage)){simpleStorage.set("trials."+user.UID,e.data,{TTL:300000})}else{log("Gigya::trialsStorageCallback => Atenci?n: No hay periodos de prueba Trials Activos de Evolok para el usuario.","info");setListRegisteredFlushed()}log("Gigya::trialsStorageCallback => respuesta OK","info");fireEvent("trials.onReady",e)}else{log("Gigya::trialsStorageCallback => error en la respuesta de periodos de prueba","error");fireEvent("trials.onError")}}else{log("Gigya::trialsStorageCallback => Error: El usuario no esta logueado o no tiene datos.","error")}}function fetchTrials(user){log("Gigya::fetchTrials => Lanzando consulta al API","info");var url=options.authServer+"/api/v1/trials/listRegistered";var listRegisteredFlushed=false;if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){listRegisteredFlushed=simpleStorage.get("listRegisteredFlushed")}if(("undefined"===typeof listRegisteredFlushed)||(true!==listRegisteredFlushed)){$.ajax({url:url+"?callback=?",data:getUserSignature(user,false),type:"get",contentType:"application/json",dataType:"jsonp",success:trialsStorageCallback,error:function(xhr,ajaxOptions,thrownError){log("Gigya::fetchTrials => Error al obtener los periodos de prueba","error");fireEvent("trials.onError")}})}}function synchronizeProducts(forceSynchronizeProducts,account){log("Gigya::synchronizeProducts => Lanzando consulta al API","info");var eventData="";try{var force=false;if(("undefined"!==typeof forceSynchronizeProducts)&&(true===forceSynchronizeProducts)){force=true}var busSynchronizeFlushed=false;if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){busSynchronizeFlushed=simpleStorage.get("busSynchronizeFlushed")}if(((false===flushedProducts)&&(("undefined"===typeof busSynchronizeFlushed)||(true!==busSynchronizeFlushed)))||(true===force)){var urlService="/api/v1/paywall/busSynchronize";var url=options.authServer+urlService;if(!options.hasPaywall){urlService="/api/v1/bus/userProducts"}url=options.authServer+urlService;$.ajax({url:url+"?callback=?",data:getUserSignature(account,false),contentType:"application/json",dataType:"jsonp",success:function(result){productsStorageCallback(result);eventData={e:result,account:account};fireEvent("products.onReady",eventData);eventProductsOnReady.resolve(eventData)},error:function(xhr,ajaxOptions,thrownError){log("Gigya::synchronizeProducts => Error al sincronizar productos: "+urlService,"error");fireEvent("products.onError");eventData={e:xhr,account:account};eventProductsOnReady.resolve(eventData)}});flushedProducts=true}else{eventData={e:"productsOnReadyOK",account:account};fireEvent("products.onReady",eventData);eventProductsOnReady.resolve(eventData);var forceCreateCookie=false;setVocPaywallCookie(forceCreateCookie)}}catch(err){log("Gigya::synchronizeProducts => Error al sincronizar productos","error");fireEvent("products.onError");eventData={e:err,account:account};eventProductsOnReady.resolve(eventData)}}function getNormalizedProductsFromSimpleStorage(products){var result={addRolesToEvolokResponse:"",data:[]};if(("undefined"!==typeof products)&&(products)){result.data=products}return result}function redirectToUrl(url,timeoutMiliseconds){var result=false;if(("undefined"!==typeof url)&&(url)){if(("undefined"!==typeof timeoutMiliseconds)&&(timeoutMiliseconds>=1)){setTimeout(function(){window.location.href=url},timeoutMiliseconds)}else{window.location.href=url}result=true}return result}function redirectToBackUrl(timeoutMiliseconds){var result=false;result=redirectToUrl(options.backURL,timeoutMiliseconds);return result}function fireEventRedirectToBackUrlOnLogin(timeoutMiliseconds){var result=false;if(("undefined"!==typeof options.enableRedirect)&&(options.enableRedirect)){var eventData={};if(("undefined"!==typeof timeoutMiliseconds)&&(timeoutMiliseconds)){eventData.timeoutMiliseconds=timeoutMiliseconds}eventRedirectToBackUrlOnLogin.resolve(eventData);result=true}return result}function redirectToBackUrlOnLogin(){var result=false;result=$.when(eventAccountsOnLogin,eventSocializeOnLogin,eventRedirectToBackUrlOnLogin,eventLastActionBeforeRedirect).done(function(response1,response2,response3,response4){var delay=0;if(("undefined"!==typeof response3)&&(response3)&&("undefined"!==typeof response3.timeoutMiliseconds)&&(response3.timeoutMiliseconds)){delay=response3.timeoutMiliseconds}redirectToBackUrl(delay)});return result}function userDataReady(){var result=false;result=$.when(eventGetUserInfo,eventGetAccountInfo).done(function(responseGetUserInfo,responseGetAccountInfo){var response={responseGetUserInfo:responseGetUserInfo,responseGetAccountInfo:responseGetAccountInfo}});return result}function updateLastestBackUrlWithUserFieldReturnUrlOnFirstLogin(){var url=false;if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.data)&&(account.data)&&("undefined"!==typeof account.data.registration)&&(account.data.registration)){if(("undefined"!==typeof account.data.registration.url)&&(account.data.registration.url)){url=account.data.registration.url}if(("undefined"!==typeof account.data.registration.returnUrl)&&(account.data.registration.returnUrl)){url=account.data.registration.returnUrl}}if(url){options.backURL=url}return url}function updateLastestBackUrl(value){var result=false;if(("undefined"!==typeof value)&&(value)){options.backURL=value;result=true}return result}function updateLastestBackUrlWithUserFieldReturnUrl(){var result=false;if(true===isFirstLogin()){result=updateLastestBackUrlWithUserFieldReturnUrlOnFirstLogin()}else{var returnUrlFromVocUserInformationCookie=getCookieVocUserInformation("returnUrl");result=updateLastestBackUrl(returnUrlFromVocUserInformationCookie)}return result}function updateReturnUrlTimeout(){var result=0;if(true===isFirstLogin()){}else{result=getCookieVocUserInformation("returnUrlTimeout")}return result}function reloadOnLoginForEcommerce(){var resSetSsoToken=gigyaCnameSetSsoToken();if(("undefined"===typeof resSetSsoToken)||(false===resSetSsoToken)){if(("undefined"!==typeof options.popUpMode)&&(false===options.popUpMode)){if(("undefined"!==typeof options.enableRedirect)&&(options.enableRedirect)){updateLastestBackUrlWithUserFieldReturnUrl();var milisecondsToRedirect=updateReturnUrlTimeout();if(isFirstLogin()||checkAdditionalDataFilled()){options.showAdditionalDataPage=false}if(!options.showAdditionalDataPage){fireEventRedirectToBackUrlOnLogin(milisecondsToRedirect)}}}else{if(options.reloadOnLogin){Vocento.reload()}}}}function showLoadingSpinner(){var result=false;var loaderSpinner=$("#vocuser-loading-indicator");if(("undefined"!==typeof loaderSpinner)&&(loaderSpinner)&&(loaderSpinner.length)){loaderSpinner.css("display","flex");loaderSpinner.show();result=true}return result}function synchronizeProductsOnLogin(account){log("Gigya::synchronizeProductsOnLogin => Lanzando consulta al API","info");var eventData="";if(("undefined"!==typeof options.hasEcommerce)&&(options.hasEcommerce)){try{var urlService="/api/v1/paywall/busSynchronize";var url=options.authServer+urlService;if(!options.hasPaywall){urlService="/api/v1/bus/userProducts"}url=options.authServer+urlService;$.ajax({url:url+"?callback=?",data:getUserSignature(account,false),contentType:"application/json",dataType:"jsonp",success:function(result){productsStorageCallback(result);eventData={e:result,account:account};fireEvent("products.onReady",eventData);eventProductsOnReady.resolve(eventData);reloadOnLoginForEcommerce()},error:function(xhr,ajaxOptions,thrownError){log("Gigya::synchronizeProducts => Error al sincronizar productos: "+urlService,"error");fireEvent("products.onError");eventData={e:xhr,account:account};eventProductsOnReady.resolve(eventData);reloadOnLoginForEcommerce()}});flushedProducts=true}catch(err){log("Gigya::synchronizeProducts => Error al sincronizar productos","error");fireEvent("products.onError");eventData={e:err,account:account};eventProductsOnReady.resolve(eventData);reloadOnLoginForEcommerce()}}else{log("Gigya::setProductsOnFirstLogin => Error: hasEcommerce = false","error");fireEvent("products.onError");eventData={account:account};eventProductsOnReady.resolve(eventData);reloadOnLoginForEcommerce()}}function getSuscriptionsFromProducts(products){var result="";if(("undefined"!==typeof products)&&(products)){var suscriptions=$.grep(products,function(a){return a.tipo==="SCR"});result=suscriptions}return result}function getTrialsFromProducts(products){var result="";if(("undefined"!==typeof products)&&(products)){var trials=$.grep(products,function(a){var isTrial=false;if(a.tipo!=="TRL"){return isTrial}else{isTrial=true;return isTrial}});result=trials}return result}function getUserTypeFromSimpleStorage(e){var result="anonimo";var userUID="";if(("undefined"!==typeof e)&&(e)){if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.account)&&(e.gigya_event.account)){userUID=e.gigya_event.account.UID}else{if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.UID)&&(e.gigya_event.UID)){userUID=e.gigya_event.UID}else{if(("undefined"!==typeof e.response)&&(e.response)&&("undefined"!==typeof e.response.account)&&(e.response.account)){userUID=e.response.account.UID}else{if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.e)&&(e.gigya_event.e)&&("undefined"!==typeof e.gigya_event.e.UID)&&(e.gigya_event.e.UID)){userUID=e.gigya_event.e.UID}}}}}else{if(("undefined"!==typeof account)&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)){userUID=account.UID}else{if(("undefined"!==typeof user)&&(user)&&("undefined"!==typeof user.UID)&&(user.UID)){userUID=user.UID}}}result="registrado";if(options.hasEcommerce){if(("undefined"!==typeof userUID)&&(userUID)){var products=getProducts(userUID);if(("undefined"!==typeof products)&&(products)&&(products.length)){var suscriptions=getSuscriptionsFromProducts(products);var trials=getTrialsFromProducts(products);result=suscriptions.length?"suscriptor":trials.length?"trial":"registrado"}else{log("Gigya::getUserType => Información: El usuario actual no tiene productos.","info")}}}else{log("Gigya::getUserType => Error: hasEcommerce = false","error")}return result}function getUserTypeFromCookieOrSimpleStorage(e){var result="anonimo";var eObject=null;var userUID="";if(("undefined"!==typeof e)&&(e)){if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.account)&&(e.gigya_event.account)){userUID=e.gigya_event.account.UID}else{if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.UID)&&(e.gigya_event.UID)){userUID=e.gigya_event.UID}else{if(("undefined"!==typeof e.response)&&(e.response)&&("undefined"!==typeof e.response.account)&&(e.response.account)){userUID=e.response.account.UID}else{if(("undefined"!==typeof e.gigya_event)&&(e.gigya_event)&&("undefined"!==typeof e.gigya_event.e)&&(e.gigya_event.e)&&("undefined"!==typeof e.gigya_event.e.UID)&&(e.gigya_event.e.UID)){userUID=e.gigya_event.e.UID}}}}if(("undefined"!==typeof userUID)&&(userUID)){result="registrado"}if(options.hasEcommerce){var cookieValue=getVocPaywallCookie();if(("undefined"!==typeof cookieValue)&&(cookieValue)&&("undefined"!==typeof cookieValue.vocUserType)&&(cookieValue.vocUserType)){result=cookieValue.vocUserType}else{if(("undefined"!==typeof userUID)&&(userUID)){var products=getProducts(userUID);if(("undefined"!==typeof products)&&(products)&&(products.length)){var suscriptions=getSuscriptionsFromProducts(products);var trials=getTrialsFromProducts(products);result=suscriptions.length?"suscriptor":trials.length?"trial":"registrado"}else{log("Gigya::getUserType => Información: El usuario actual no tiene productos.","info")}}}}else{log("Gigya::getUserType => Error: hasEcommerce = false","error")}}return result}function getUserTypeByUID(UID){var result="anonimo";if(("undefined"!==typeof UID)&&(UID)){result="registrado";var products="";var userHasProducts=false;if(options.hasEcommerce){var forceSynchronizeProducts=false;var askForProducts=false;var cookieValue=getVocPaywallCookie();if(("undefined"!==typeof cookieValue)&&(cookieValue)&&("undefined"!==typeof cookieValue.windowLocationOrigin)&&(cookieValue.windowLocationOrigin)&&(cookieValue.windowLocationOrigin!==window.location.origin)){forceSynchronizeProducts=true;askForProducts=true}else{products=getProducts(UID);userHasProducts=false;if(("undefined"!==typeof products)&&(products)&&(products.length)){userHasProducts=true}else{askForProducts=true}}if(true===askForProducts){log("Gigya::getUserType => Atenci?n: El usuario no tiene products, se procede a buscarlos.","info");var accountPreVerification=account||user;flushProducts(forceSynchronizeProducts,accountPreVerification);products=getProducts(UID);if(("undefined"!==typeof products)&&(products)&&(products.length)){userHasProducts=true}}if(true===userHasProducts){var suscriptions=getSuscriptionsFromProducts(products);var trials=getTrialsFromProducts(products);result=suscriptions.length?"suscriptor":trials.length?"trial":"registrado"}else{log("Gigya::getUserType => Informaci?n: El usuario actual no tiene productos.","info")}}else{log("Gigya::getUserType => Error: hasEcommerce = false","error")}}return result}function getUserType(){var result="anonimo";var userId="";var vocPaywallCookie=getVocPaywallCookie();if((typeof vocPaywallCookie!=="undefined")&&(vocPaywallCookie)&&(typeof vocPaywallCookie.vocUserType!=="undefined")&&(vocPaywallCookie.vocUserType)){result=vocPaywallCookie.vocUserType}else{if(typeof vocUserGetData==="function"){userId=vocUserGetData("uid")}if((typeof userId==="undefined")||(!userId)){if((typeof account!=="undefined")&&(account)&&("undefined"!==typeof account.UID)&&(account.UID)){userId=account.UID}}if((typeof userId==="undefined")||(!userId)){if((typeof user!=="undefined")&&(user)&&("undefined"!==typeof user.UID)&&(user.UID)){userId=user.UID}}if(typeof userId!=="undefined"&&userId){if(("undefined"===typeof account)||(!account)){account={UID:userId}}var e={gigya_event:account};result=getUserTypeFromCookieOrSimpleStorage(e)}else{log("Gigya::getUserType => Error: No se ha encontrado el UID del usuario.","info")}}return result}function askForProductsSyncOrFetch(e,forceSynchronizeProducts){var force=false;if(("undefined"!==typeof forceSynchronizeProducts)&&(true===forceSynchronizeProducts)){force=true}if(options.hasPaywall){synchronizeProducts(force,e)}else{log("Gigya::sincronizarLlamadasEcommercePaywall => Atenci?n: hasPaywall = false","error");fetchProducts(e)}}function sincronizarLlamadasEcommercePaywall(e){var eventData="";if(options.hasEcommerce){var forceSynchronizeProducts=false;var askForProducts=false;var cookieValue=getVocPaywallCookie();if(("undefined"!==typeof cookieValue)&&(cookieValue)&&("undefined"!==typeof cookieValue.windowLocationOrigin)&&(cookieValue.windowLocationOrigin)&&(cookieValue.windowLocationOrigin!==window.location.origin)){forceSynchronizeProducts=true;askForProducts=true}if((getProducts()===undefined)||(true===askForProducts)){synchronizeProducts(forceSynchronizeProducts,e)}else{var forceCreateCookie=false;setVocPaywallCookie(forceCreateCookie);eventData={e:e};fireEvent("products.onReady",eventData);eventProductsOnReady.resolve(eventData)}}else{log("Gigya::sincronizarLlamadasEcommercePaywall => Error: hasEcommerce = false","error");eventData={e:e};fireEvent("products.onError",eventData);eventProductsOnReady.resolve(eventData)}}function getVocEdition(){var vocEdition=null;try{vocEdition=$.cookie(EDITION_COOKIE_NAME)}catch(err){}if(("undefined"===typeof vocEdition)||(!vocEdition)){if(("undefined"!==typeof window.vocento)&&(window.vocento)&&("undefined"!==typeof window.vocento.site)&&(window.vocento.site)&&("undefined"!==typeof window.vocento.site.editions)&&(window.vocento.site.editions)&&("undefined"!==typeof window.vocento.site.editions.current)&&(window.vocento.site.editions.current)){vocEdition=window.vocento.site.editions.current}}return vocEdition}function getDomainForSsoGroup(vocentoSsoGroup){var domain="";if(("undefined"!==typeof vocentoSsoGroup)&&(vocentoSsoGroup)){var currentDomain=domains[vocentoSsoGroup];if(("undefined"!==typeof currentDomain)&&(currentDomain)){currentDomain=currentDomain.split(".");currentDomain=currentDomain[0];domain=currentDomain}}return domain}function getAreaPersonalDomain(){var areaPersonalDomain="";areaPersonalDomain="https://areapersonal."+domains[options.ssoGroup];if(/^des/.test(window.location.host)||/^areapersonal-des/.test(window.location.host)||/^areapersonalm-des/.test(window.location.host)||/^local/.test(window.location.host)||/^deshared/.test(window.location.host)){areaPersonalDomain="https://areapersonal-des."+domains[options.ssoGroup]}if(/^integracion/.test(window.location.host)||/^pre/.test(window.location.host)||/^areapersonal-pre/.test(window.location.host)||/^areapersonalm-pre/.test(window.location.host)){areaPersonalDomain="https://areapersonal-predes."+domains[options.ssoGroup]}return areaPersonalDomain}function isSiteAreaPersonal(){var result=false;if(/^areapersonal-des/.test(window.location.host)||/^areapersonalm-des/.test(window.location.host)||/^areapersonal-pre/.test(window.location.host)||/^areapersonalm-pre/.test(window.location.host)||/^areapersonal/.test(window.location.host)){result=true}return result}function getSubdomainContenidoExtra(){var result="www";if(/^integracion/.test(window.location.host)||/^pre/.test(window.location.host)||/^areapersonal-pre/.test(window.location.host)||/^areapersonalm-pre/.test(window.location.host)){result="pren"}if(/^des/.test(window.location.host)||/^areapersonal-des/.test(window.location.host)||/^areapersonalm-des/.test(window.location.host)){result="desn"}return result}function getFieldValueFromUserInfo(userInfo,fieldName){var result=false;if(isVarNotNull(userInfo)&&isVarNotNull(fieldName)){if(isVarNotNull(userInfo[fieldName])){result=userInfo[fieldName]}else{if(isVarNotNull(userInfo.profile)){if(isVarNotNull(userInfo.profile[fieldName])){result=userInfo.profile[fieldName]}}}}return result}function buildGenderWelcomeText(userGender){var result=false;if(isVarNotNull(userGender)){if("f"===userGender){result="Bienvenida"}else{result="Bienvenido"}}return result}function buildFirstNameText(userFirstName){var result="##nombre##";if(isVarNotNull(userFirstName)){result=userFirstName}return result}function buildUserNameText(userInfo){var result="";if(isVarNotNull(userInfo)){var userFirstName=getFieldValueFromUserInfo(userInfo,"firstName");var userLastName=getFieldValueFromUserInfo(userInfo,"lastName");var userNickName=getFieldValueFromUserInfo(userInfo,"nickname");if(isVarNotNull(userFirstName)){result=userFirstName}if(isVarNotNull(userLastName)){result=result+" "+userLastName}if(isVarNotNull(result)===false){result=userNickName}}return result}function replaceMenuText(menuDiv){var result=false;if(isVarNotNull(menuDiv)&&menuDiv){var userInfo="";if(isVarNotNull(account)&&isVarNotNull(account.profile)){userInfo=account}else{if(isVarNotNull(user)){userInfo=user}}var userNameText=buildUserNameText(userInfo);var userGender=getFieldValueFromUserInfo(userInfo,"gender");var genderWelcomeText=buildGenderWelcomeText(userGender);if(false===genderWelcomeText){genderWelcomeText="Bienvenido"}var menuDivRegisterTextReplaced=menuDiv.replace("##nombre##",userNameText);result=menuDivRegisterTextReplaced.replace("##genderWelcomeText##",genderWelcomeText)}return result}function setMenuTrial(menuAllLiOptions,urlAreaPersonal){var result=false;var menuOptions="";if(("undefined"!==typeof menuAllLiOptions)&&(menuAllLiOptions)){menuOptions=menuAllLiOptions}var menu='<li class="rgTrial"><a href="'+urlAreaPersonal+'/gestion/datos-personales.html" class="aTrial">Prueba Gratuita  <i class="logo-onplus"></i></a><span class="irg">activa zona premium</span><div class="zonaPremium"><div class="box"><ul style="display: block;">'+menuOptions+"</ul></div></div></li>";result=menu;return result}function setMenuOnEvents(){var result=false;var menuDetectedPremiumLis=$(".zonaPremium ul li a i.logo-onplus").parent().parent();var menuDetectedAllLis=$(".zonaPremium ul li");var menuUlContainer=$(".zonaPremium ul");var menuBoxContainer=$(".zonaPremium .box");var menuDivLoggedInLi=$(".gigya-logged-in ul.clasificados li a.rg").parent();var menuDivLoggedInUl=menuDivLoggedInLi.parent();var userInfo="";if(isVarNotNull(account)&&isVarNotNull(account.profile)){userInfo=account}else{if(isVarNotNull(user)){userInfo=user}}var userGender=getFieldValueFromUserInfo(userInfo,"gender");var userFirstName=getFieldValueFromUserInfo(userInfo,"firstName");var vocWelcomeIdentifier="##genderWelcomeText##";var genderWelcomeText=buildGenderWelcomeText(userGender);if(false!==genderWelcomeText){vocWelcomeIdentifier=genderWelcomeText}var vocUser=buildFirstNameText(userFirstName);var urlAreaPersonal=getAreaPersonalDomain();var subDomainContenidoExtra=getSubdomainContenidoExtra();var urlSite="http://"+subDomainContenidoExtra+"."+domains[options.ssoGroup];var siteEdition=getVocEdition();var urlContenidoExtra="";if(("undefined"!==typeof siteEdition)&&(siteEdition)&&("string"===typeof siteEdition)){urlContenidoExtra=urlSite+"/"+siteEdition+"/on-extra/?buscaedicion="+siteEdition}else{urlContenidoExtra=urlSite+"/on-extra/"}var subMenuOptionMusik='<li><a href="'+urlSite+'/on-extra/musica/">Musi-k</a></li>';var subMenuOptionLaButaca='<li><a href="'+urlSite+'/on-extra/butaca/">La Butaca</a></li>';var subMenuOptionDinero='<li><a href="'+urlSite+'/on-extra/dinero/">Dinero</a></li>';var subMenuOptionTerritorios='<li><a href="'+urlSite+'/on-extra/territorios/">Territorios</a></li>';var menuOptionNewsletters="";if(true===options.hasMenuOptionNewsletters){menuOptionNewsletters='<li><a href="'+urlAreaPersonal+'/servicios/newsletters.html">Newsletters</a></li>'}var menuAllLiOptions='<li><a href="'+urlAreaPersonal+'/gestion/mi-cuenta.html">Area Personal</a></li>'+menuOptionNewsletters+'<li><a href="'+urlAreaPersonal+'/servicios/favoritos.html">Favoritos <i class="logo-onplus"></i></a></li><li><a href="'+urlContenidoExtra+'">Contenido Extra <i class="logo-onplus"></i></a><div class="submenu"><ul></ul></div></li><li><a href="'+urlAreaPersonal+'/servicios/dispositivos.html">Apps <i class="logo-onplus"></i></a></li><li><a href="'+urlAreaPersonal+'/servicios/mi-club-ventajas.html">Club de Suscriptores <i class="logo-onplus"></i></a></li><li><a href="'+urlAreaPersonal+'/suscripcion/ayuda.html">Preguntas Frecuentes</a></li><li><a href="javascript:void(0)" onclick="gigyaUX.logout()">Cerrar Sesi\u00F3n</a></li>';var menuDivSuscriptorText='<li class="onP"><a href="'+urlAreaPersonal+'/gestion/datos-personales.html" class="rg"><span class="vocento-gigya-user-first-name" style="margin-right:16px;">'+vocWelcomeIdentifier+" "+vocUser+'</span></a><span class="irg">Activa zona premium</span><div class="zonaPremium"><div class="box"><ul style="display: block;">'+menuAllLiOptions+"</ul></div></div></li>";var menuDivTrialText=setMenuTrial(menuAllLiOptions,urlAreaPersonal);var menuRegisterLiOptions='<li><a href="'+urlAreaPersonal+'/gestion/mi-cuenta.html">Area Personal</a></li>'+menuOptionNewsletters+'<li><a href="'+urlAreaPersonal+'/suscripcion/ayuda.html">Preguntas Frecuentes</a></li><li><a href="javascript:void(0)" onclick="gigyaUX.logout()">Cerrar Sesi\u00F3n</a></li>';var menuDivRegisterText='<li class="onP"><a href="'+urlAreaPersonal+'/gestion/datos-personales.html" class="rg"><span class="vocento-gigya-user-first-name" style="margin-right:16px;">'+vocWelcomeIdentifier+" "+vocUser+'</span></a><span class="irg">Activa zona premium</span><div class="zonaPremium"><div class="box"><ul style="display: block;">'+menuRegisterLiOptions+"</ul></div></div></li>";function addSubMenuOption(menu,subMenuOption){var result=false;if(("undefined"!==typeof menu)&&(menu)){result=menu;if(("undefined"!==typeof subMenuOption)&&(subMenuOption)){var menuDomObject=$($(menu));var htmlFromMenuDomObject=menu;var menuFound=false;menuDomObject.each(function(){var childFromMenu=$(this);if(childFromMenu.find("div.submenu").length!==0){var divSubmenuUl=childFromMenu.find("div.submenu ul");if(("undefined"!==typeof divSubmenuUl)&&(divSubmenuUl)){divSubmenuUl.append(subMenuOption);menuFound=true}}});if(true===menuFound){htmlFromMenuDomObject=$("<div>").append(menuDomObject.clone()).html()}result=htmlFromMenuDomObject}}return result}function deleteSubMenu(menu){var result=menu;if(("undefined"!==typeof menu)&&(menu)){var menuDomObject=$($(menu));var htmlFromMenuDomObject=menu;var menuFound=false;menuDomObject.each(function(){var childFromMenu=$(this);if(childFromMenu.find("div.submenu").length!==0){var divSubmenuUl=childFromMenu.find("div.submenu ul");if(("undefined"!==typeof divSubmenuUl)&&(divSubmenuUl)){divSubmenuUl.html("");menuFound=true}}});if(true===menuFound){htmlFromMenuDomObject=$("<div>").append(menuDomObject.clone()).html()}result=htmlFromMenuDomObject}return result}function setMenuForUserAnonymous(){if(("undefined"!==typeof menuUlContainer)&&(menuUlContainer)){menuUlContainer.hide()}if(("undefined"!==typeof menuDetectedPremiumLis)&&(menuDetectedPremiumLis)){menuDetectedPremiumLis.remove()}}function setMenuForUserRegistered(){if(("undefined"!==typeof menuDetectedAllLis)&&(menuDetectedAllLis)){menuDetectedAllLis.remove()}if(("undefined"!==typeof menuUlContainer)&&(menuUlContainer)){menuUlContainer.append(menuRegisterLiOptions);menuUlContainer.show()}if(("undefined"!==typeof menuBoxContainer)&&(menuBoxContainer)){menuBoxContainer.show()}}function setMenuTextForUserRegistered(){if(("undefined"!==typeof menuDivRegisterText)&&(menuDivRegisterText)){var menuTextReplaced=replaceMenuText(menuDivRegisterText);var menuDivLoggedInLiFromTrial=$(".gigya-logged-in ul.clasificados li a.aTrial").parent();if(("undefined"!==typeof menuDivLoggedInLiFromTrial)&&(menuDivLoggedInLiFromTrial)){menuDivLoggedInLiFromTrial.replaceWith(menuTextReplaced)}var menuDivLoggedInLi=$(".gigya-logged-in ul.clasificados li a.rg").parent();if(("undefined"!==typeof menuDivLoggedInLi)&&(menuDivLoggedInLi)){menuDivLoggedInLi.replaceWith(menuTextReplaced)}}}function setSubMenuForUserTrial(){if(("undefined"!==typeof menuDetectedAllLis)&&(menuDetectedAllLis)){menuDetectedAllLis.remove()}if(("undefined"!==typeof menuUlContainer)&&(menuUlContainer)){var menuWithSubmenu=menuAllLiOptions;menuWithSubmenu=deleteSubMenu(menuWithSubmenu);menuWithSubmenu=addSubMenuOption(menuWithSubmenu,subMenuOptionMusik);menuWithSubmenu=addSubMenuOption(menuWithSubmenu,subMenuOptionLaButaca);if(true===options.addSubmenuOptionTerritorio){menuWithSubmenu=addSubMenuOption(menuWithSubmenu,subMenuOptionTerritorios)}menuWithSubmenu=addSubMenuOptionDinero(menuWithSubmenu,subMenuOptionDinero);menuUlContainer.append(menuWithSubmenu);menuUlContainer.show();menuAllLiOptions=menuWithSubmenu;menuDivTrialText=setMenuTrial(menuAllLiOptions,urlAreaPersonal)}if(("undefined"!==typeof menuBoxContainer)&&(menuBoxContainer)){menuBoxContainer.show()}}function setMenuTextForUserTrial(){var menuDivLoggedInLi=$(".gigya-logged-in ul.clasificados li a.rg").parent();if(("undefined"!==typeof menuDivTrialText)&&(menuDivTrialText)&&("undefined"!==typeof menuDivLoggedInLi)&&(menuDivLoggedInLi)&&("undefined"!==typeof menuDivLoggedInUl)&&(menuDivLoggedInUl)){menuDivLoggedInLi.replaceWith(menuDivTrialText)}}function addSubMenuOptionDinero(menu,subMenuOptionDinero){var result=false;if(("undefined"!==typeof menu)&&(menu)){result=menu;if(true===options.hasContenidoExtraSubMenuOptionDinero){if(("undefined"!==typeof subMenuOptionDinero)&&(subMenuOptionDinero)){menu=addSubMenuOption(menu,subMenuOptionDinero);result=menu}}}return result}function setMenuForUserSuscriptor(){if(("undefined"!==typeof menuDetectedAllLis)&&(menuDetectedAllLis)){menuDetectedAllLis.remove()}if(("undefined"!==typeof menuUlContainer)&&(menuUlContainer)){var menu=menuAllLiOptions;menu=addSubMenuOption(menu,subMenuOptionMusik);menu=addSubMenuOption(menu,subMenuOptionLaButaca);if(true===options.addSubmenuOptionTerritorio){menu=addSubMenuOption(menu,subMenuOptionTerritorios)}menu=addSubMenuOptionDinero(menu,subMenuOptionDinero);menuUlContainer.append(menu);menuUlContainer.show()}if(("undefined"!==typeof menuBoxContainer)&&(menuBoxContainer)){menuBoxContainer.show()}}function setMenuTextForUserSuscriptor(){if(("undefined"!==typeof menuDivSuscriptorText)&&(menuDivSuscriptorText)&&("undefined"!==typeof menuDivLoggedInUl)&&(menuDivLoggedInUl)){var menuTextReplaced=replaceMenuText(menuDivSuscriptorText);var menuDivLoggedInLiSuscriptor=$(".gigya-logged-in ul.clasificados li a.rg").parent();if(("undefined"!==typeof menuDivLoggedInLiSuscriptor)&&(menuDivLoggedInLiSuscriptor)&&(menuDivLoggedInLiSuscriptor.length)){menuDivLoggedInLi.replaceWith(menuTextReplaced)}else{}var menuDivLoggedInLiWithTrial=$(".gigya-logged-in ul.clasificados li a.aTrial").parent();if(("undefined"!==typeof menuDivLoggedInLiWithTrial)&&(menuDivLoggedInLiWithTrial)){menuDivLoggedInLiWithTrial.replaceWith(menuTextReplaced)}}}function setMenu(e){menuDetectedPremiumLis=$(".zonaPremium ul li a i.logo-onplus").parent().parent();menuDetectedAllLis=$(".zonaPremium ul li");menuUlContainer=$(".zonaPremium ul");var userType=getUserTypeFromCookieOrSimpleStorage(e);if(("undefined"!==typeof userType)&&(userType)){switch(userType){case"anonimo":setMenuForUserAnonymous();break;case"registrado":setMenuForUserRegistered();setMenuTextForUserRegistered();break;case"trial":setSubMenuForUserTrial();setMenuTextForUserTrial();break;case"suscriptor":setMenuForUserSuscriptor();setMenuTextForUserSuscriptor();break;default:setMenuForUserAnonymous();break}}else{setMenuForUserAnonymous()}result=true}mainEventListener.on("vocento.gigya.accounts.onDataReady",function(e){setMenu(e)});mainEventListener.on("vocento.gigya.accounts.onDataNoReady",function(e){menuDetectedPremiumLis=$(".zonaPremium ul li a i.logo-onplus").parent().parent();menuDetectedAllLis=$(".zonaPremium ul li");menuUlContainer=$(".zonaPremium ul");setMenuForUserAnonymous()});mainEventListener.on("vocento.gigya.products.onReady",function(e){setMenu(e)});mainEventListener.on("vocento.gigya.products.onError",function(e){setMenu()});return result}function insertPictureInDomElement(elementId,pictureName,pictureSource,pictureLink){var result=false;if(("undefined"!==typeof elementId)&&(elementId)&&("undefined"!==typeof pictureName)&&(pictureName)){if((options.hasPaywall)&&(options.hasEcommerce)){var imgName="vocento-login-screen-picture-"+pictureName;var imgSrc=pictureSource;var htmlImage='<img id="'+imgName+'" src="'+imgSrc+'" />';if(("undefined"!==typeof pictureLink)&&(pictureLink)){htmlImage='<a href="'+pictureLink+'">'+htmlImage+"</a>"}var domPlaceToInsert=$(elementId);if(("undefined"!==typeof domPlaceToInsert)&&(domPlaceToInsert)&&(domPlaceToInsert.length)){domPlaceToInsert.html(htmlImage)}result=true}}return result}function resetCaptchaFirefox(captchaId){captcha=undefined;$(".pls-container").remove();$("#"+captchaId).empty();captcha=grecaptcha.render(captchaId,{sitekey:"6LdmZgYTAAAAADQC06sXwn22WX7n0s4Nc1cuj-v7",callback:captchaVerifyCallback})}var captchaVerifyCallback=function(response){var iframeCaptcha=$("#g-recaptcha").find("iframe");var iframeCaptchaLogin=$("#g-recaptcha-login").find("iframe");iframeCaptcha.removeAttr("name");iframeCaptchaLogin.removeAttr("name");var textCaptcha=$("#g-recaptcha").find("textarea");var textCaptchaLogin=$("#g-recaptcha-login").find("textarea");var textAreaRecaptcha=$("#g-recaptcha-response");textAreaRecaptcha.removeAttr("name");textCaptcha.removeAttr("name");textCaptchaLogin.removeAttr("name");$("#vocento-error-captcha-msg").html("");$("#vocento-error-captcha-msg").removeClass("gigya-error-msg gigya-error-msg-active")};function addParentDiv(screenName,parentDivId,parentDivClass,additionalHTMLProperties){var result=false;if(("undefined"!==typeof screenName)&&(screenName)){var screen=$("."+screenName+":visible");if(("undefined"!==typeof screen)&&(screen)&&(screen.length)){var parents=screen.parents('div[class^="'+parentDivClass+'"]');var parentDivAdded=false;if(("undefined"!==typeof parents)&&(parents)&&(parents.length)){parentDivAdded=true}if(false===parentDivAdded){var divHtml="";if(("undefined"!==typeof parentDivId)&&(parentDivId)){divHtml=divHtml+" id='"+parentDivId+"' "}if(("undefined"!==typeof parentDivClass)&&(parentDivClass)){divHtml=divHtml+" class='"+parentDivClass+"' "}if(("undefined"!==typeof additionalHTMLProperties)&&(additionalHTMLProperties)){divHtml=divHtml+" "+additionalHTMLProperties+" "}divHtml="<div "+divHtml+"></div>";screen.wrap(divHtml)}result=true}}return result}function removeParentDiv(screenName,parentDivId,parentDivClass){var result=false;if(("undefined"!==typeof screenName)&&(screenName)){var screen=$("."+screenName+":visible");if(("undefined"!==typeof screen)&&(screen)){if(("undefined"!==typeof parentDivId)&&(parentDivId)){var divId=$("#"+parentDivId);if(("undefined"!==typeof divId)&&(divId)&&(divId.length)){divId.remove()}}if(("undefined"!==typeof parentDivClass)&&(parentDivClass)){var divClass=$("."+parentDivClass);if(("undefined"!==typeof divClass)&&(divClass)&&(divClass.length)){divClass.remove()}}result=true}}return result}function removeVoidElement(element){var result=false;if(("undefined"!==typeof element)&&(element)){var elementObject="";var iElements=0;elementObject=$("."+element);if(("undefined"!==typeof elementObject)&&(elementObject)&&(elementObject.length)){for(iElements=0;iElements<elementObject.length;iElements++){if(("undefined"===typeof elementObject[iElements].children)||(!elementObject[iElements].children)||(elementObject[iElements].children.length<=0)){elementObject[iElements].remove()}}}elementObject=$("#"+element);if(("undefined"!==typeof elementObject)&&(elementObject)&&(elementObject.length)){for(iElements=0;iElements<elementObject.length;iElements++){if(("undefined"===typeof elementObject[iElements].children)||(!elementObject[iElements].children)||(elementObject[iElements].children.length<=0)){elementObject[iElements].remove()}}}}return result}function addModalClassToScreen(screenName,className){var result=false;if(("undefined"!==typeof screenName)&&(screenName)&&("undefined"!==typeof className)&&(className)){var screenDialog=$("."+screenName+":visible");if(("undefined"!==typeof screenDialog)&&(screenDialog)&&(screenDialog.length)){screenDialog.addClass(className);result=true}}return result}function getEventScreenName(e){var result=false;var screenName="";if(("undefined"!==typeof e)&&(e)){if((e.nextScreen!==typeof"undefined")&&(e.nextScreen)){screenName=e.nextScreen}if((e.currentScreen!==typeof"undefined")&&(e.currentScreen)){screenName=e.currentScreen}if((e.screen!==typeof"undefined")&&(e.screen)){screenName=e.screen}result=screenName}return result}function findFieldInScreenByName(fieldName,screenName){var result=false;var fieldObject="";if((screenName!==typeof"undefined")&&(screenName)&&(fieldName!==typeof"undefined")&&(fieldName)){fieldObject=$("#"+screenName+'[data-screenset-element-id="'+screenName+'"] *[name="'+fieldName+'"]:first');if((fieldObject===typeof"undefined")||(!fieldObject)||(fieldObject.length===0)){fieldObject=$('[data-screenset-element-id="'+screenName+'"] *[name="'+fieldName+'"]:first')}if((fieldObject===typeof"undefined")||(!fieldObject)||(fieldObject.length===0)){fieldObject=$("#"+screenName+' input[name="'+fieldName+'"]:first')}if((fieldObject!==typeof"undefined")&&(fieldObject)&&(fieldObject.length)){result=fieldObject}}return result}function getFieldValueInScreenByName(fieldName,screenName){var result=false;if((screenName!==typeof"undefined")&&(screenName)&&(fieldName!==typeof"undefined")&&(fieldName)){var fieldObject=findFieldInScreenByName(fieldName,screenName);if(("undefined"!==typeof fieldObject)&&(fieldObject)&&(fieldObject.length)){result=fieldObject.val()}}return result}function findFieldInScreen(fieldName,e){var result=false;if(("undefined"!==typeof e)&&(e)){var screenName="";var fieldObject="";screenName=getEventScreenName(e);if((screenName!==typeof"undefined")&&(screenName)){fieldObject=$("#"+screenName+'[data-screenset-element-id="'+screenName+'"] *[name="'+fieldName+'"]:first');if((fieldObject===typeof"undefined")||(!fieldObject)||(fieldObject.length===0)){fieldObject=$('[data-screenset-element-id="'+screenName+'"] *[name="'+fieldName+'"]:first')}}if((fieldObject!==typeof"undefined")&&(fieldObject)&&(fieldObject.length)){result=fieldObject}}return result}function scrollScreenToElementPosition(screenElement,e){var result=false;if(("undefined"!==typeof screenElement)&&(screenElement)&&("undefined"!==typeof e)&&(e)){var screenName=getEventScreenName(e);if(false!==screenName){var elementInScreenObject=findFieldInScreen(screenElement,e);var headerElement=$("#header");if((false!==elementInScreenObject)&&("undefined"!==typeof headerElement)&&(headerElement)&&(headerElement.length)){var elementHeight=elementInScreenObject.offset().top;var headerHeight=$("#header").offset().top;var scrollToHeight=elementHeight-headerHeight;$("html, body").animate({scrollTop:scrollToHeight},200);result=true}}}return result}function isValidMail(e){var result=true;var emailColumnName="email";var emailObject=findFieldInScreen(emailColumnName,e);if(false!==emailObject){var email=emailObject.val();var urlService="/verify_unique_email/";var url=options.authServer+urlService;try{$.ajax({url:url+email,type:"GET",async:false,dataType:"json",success:function(resultVerify){if(false===resultVerify.result){var screenName=getEventScreenName(e);if(false!==screenName){var currentScreenObject=$("#"+screenName);var errorMsg=currentScreenObject.find(".gigya-error-msg[data-bound-to="+emailColumnName+"]");var errorText="El correo electr"+Vocento.UnicodeToChar("o")+"nico ya existe";errorMsg.html(errorText);errorMsg.css("visibility","visible");if(("undefined"!==typeof emailObject.offset)&&(emailObject.offset())&&("undefined"!==typeof emailObject.offset().top)){scrollScreenToElementPosition(emailColumnName,e)}}}result=resultVerify.result},error:function(xhr){}})}catch(err){}}if(false===result){var submitBtn=$("form."+e.form+":visible input[type=submit]");submitBtn.val("Corrige los errores")}return result}function isVarNotNull(varElement){var result=false;if(("undefined"!==typeof varElement)&&(varElement)){result=true}return result}function thirdPartyCookiesBlocked(){var result=false;if(("undefined"!==typeof vocento_cd3)&&("0"===vocento_cd3)){result=true}return result}function gigyaCnameEnable(){var result=false;if(isVarNotNull(options)&&(isVarNotNull(options.enableCNAME))){if(true===thirdPartyCookiesBlocked()){result=true;if(isVarNotNull(gigya)&&isVarNotNull(gigya.thisScript)&&isVarNotNull(gigya.thisScript.globalConf)){gigya.thisScript.globalConf.enableSSOToken=options.enableCNAME}}}return result}function gigyaCnameSetSsoToken(){var result=false;if(isVarNotNull(options)&&(isVarNotNull(options.enableCNAME))){if(true===thirdPartyCookiesBlocked()){result=true;var resultGigyaSetSSOToken=gigya.setSSOToken({redirectURL:window.location.href})}}return result}function getUrlParamValue(paramName){var result=null;if(true===isVarNotNull(paramName)){var vars={};var parts=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value});if((true===isVarNotNull(vars))&&("undefined"!==typeof vars[paramName])){result=vars[paramName]}}return result}function setEmailVerifiedMessage(authenticated){var result=false;var fullURL=window.location.href;var emailVerificationPath="comun/html/2014/verificacion-email.html";if(fullURL.indexOf(emailVerificationPath)>-1){var labelEmailVerified=$("#gigya-vocento-container label");var message="Ha habido un error en la verificaci\u00F3n de tu correo electr\u00F3nico, por favor int\u00E9ntelo m\u00E1s tarde.";if(true===isVarNotNull(labelEmailVerified)&&labelEmailVerified.length){var person=[];if(("undefined"!==typeof authenticated)&&(authenticated)){person[0]="\u00A1Gracias! Tu correo electr\u00F3nico ha sido verificado."}else{person[0]="\u00A1Gracias! Tu correo electr\u00F3nico ha sido verificado y ya puedes iniciar sesi\u00F3n en la web o en la app. Recuerda navegar siempre identificado."}person[403002]="Este enlace ha caducado y tu registro, por seguridad, fue eliminado. Por favor, reg\u00EDstrate de nuevo.";person[400010]="Se ha producido un error en la verificaci\u00F3n de la cuenta. Por favor, reg\u00EDstrate de nuevo.";person[400006]="El enlace no es correcto, por favor comprueba que has seleccionado el enlace completo. Si el problema contin\u00FAa, podamos enviarte un nuevo mail para activar tu cuenta: intenta iniciar sesi\u00F3n y sigue las instrucciones.";person[206005]="\u00A1Gracias! Tu correo electr\u00F3nico ha sido verificado.";var errorCodeValue=getUrlParamValue("errorCode");if(true===isVarNotNull(errorCodeValue)&&("undefined"!==typeof person[errorCodeValue])){message=person[errorCodeValue]}labelEmailVerified.text(message);result=true}}return result}function actionsAfterLogin(e){var result=false;var promiseSetAccountInfo=setLastLogin({callback:function(){account=e;if(("undefined"===typeof user)||(!user)){user=e}}});promiseSetAccountInfo.then(function(result){evolokIdAndSynchronizeProductsOnLogin(e);if(("undefined"===typeof options.hasPaywall)||(!options.hasPaywall)){reloadOnLoginForEcommerce()}if(!options.reloadOnLogin){getAccountInfo({})}return true});return result}function facebookTrackInit(pixelId){var result=false;var initializated=false;var facebookPixelId="1571136016517980";if(("undefined"!==typeof pixelId)&&(pixelId)){facebookPixelId=pixelId}if(("undefined"!==typeof fevents)&&(true===fevents)){initializated=true}!function(f,b,e,v,n,t,s){if(f.fbq){return}n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq){f._fbq=n}n.push=n;n.loaded=!0;n.version="2.0";n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");if(("function"===typeof fbq)&&(false===initializated)){fbq("init",facebookPixelId);result=true}return result}function facebookTrackEvent(facebookEventName){var result=false;if(("undefined"!==typeof facebookEventName)&&(facebookEventName)&&("function"===typeof fbq)){fbq("track",facebookEventName);result=true}return result}function facebookInyectTrackingPixelHtml(facebookEventName,pixelId,idToInsertPixel){var result=false;if(("undefined"!==typeof facebookEventName)&&(facebookEventName)){var elementToInsertPixel="";var facebookPixelId="1571136016517980";if(("undefined"!==typeof pixelId)&&(pixelId)){facebookPixelId=pixelId}var imgElement=document.createElement("img");imgElement.height="1";imgElement.width="1";imgElement.style="display:none";imgElement.src="https://www.facebook.com/tr?id="+facebookPixelId+"&ev="+facebookEventName+"&noscript=1";var element=document.createElement("noscript");if(("undefined"!==typeof element)&&(element)){element.appendChild(imgElement);if(("undefined"!==typeof idToInsertPixel)&&(idToInsertPixel)){elementToInsertPixel=document.getElementById(idToInsertPixel);if(("undefined"===typeof elementToInsertPixel)||(!elementToInsertPixel)){elementToInsertPixel=document.body}}else{elementToInsertPixel=document.body}elementToInsertPixel.appendChild(element);result=true}}return result}function addService(serviceName,gigyaEvent){if(("undefined"!==typeof serviceName)&&(serviceName)&&("undefined"!==typeof gigyaEvent)&&(gigyaEvent)){protectedFunctions.setCurrentService(serviceName);protectedFunctions.checkService(gigyaEvent);var eventData={e:gigyaEvent,account:account};eventServiceAdd.resolve(eventData)}}function getGigyaResponse(gigyaEvent){var eObject=null;if(("undefined"!==typeof gigyaEvent)&&(gigyaEvent)){if(("undefined"!==typeof gigyaEvent.gigya_event)&&(gigyaEvent.gigya_event)){eObject=gigyaEvent.gigya_event}if(("undefined"!==typeof gigyaEvent.response)&&(gigyaEvent.response)){eObject=gigyaEvent.response}if(null===eObject){eObject=gigyaEvent}}return eObject}function setUserNewslettersByFieldAdsMedia(gigyaEvent){var response=false;if(("undefined"!==typeof gigyaEvent)&&(gigyaEvent)){var eObject=getGigyaResponse(gigyaEvent);var adsMediaValue=false;if(("undefined"!==typeof eObject.data)&&(eObject.data)&&("undefined"!==typeof eObject.data.adsMedia)){adsMediaValue=eObject.data.adsMedia}if(("undefined"!==typeof adsMediaValue)&&(adsMediaValue)){var data={UID:eObject.UID,UIDSignature:eObject.UIDSignature,signatureTimestamp:eObject.signatureTimestamp};var serviceUrl=options.authServerVocCore+"/vocuser/v1/media/newsletter/user/suscribe/byfield/adsmedia";$.ajax({url:serviceUrl,type:"POST",data:data,async:true,dataType:"json",success:function(result){response=result},error:function(xhr){response=xhr;log("setUserNewslettersByFieldAdsMedia:: Llamada a la api ajax err?nea.","error")}})}}return response}function newslettersAutosuscribe(dataNewslettersAuto){var urlNewslettersAuto=options.authServerVocCore+"/vocuser/v1/user/newsletters/autosubscribe";try{if(("undefined"!==typeof dataNewslettersAuto)&&(dataNewslettersAuto)&&("object"===typeof dataNewslettersAuto)){$.ajax({url:urlNewslettersAuto,type:"POST",data:dataNewslettersAuto,async:true,dataType:"json",success:function(resulupseeubt){},error:function(xhr){}})}}catch(err){}}function updateDeleteUserNotificationFrecuency(response){var urlNotifications=options.authServerVocCore+"/vocuser/v1/user/notifications_removal_freq/update";if(("undefined"!==typeof response.UID)&&(response.UID)&&("undefined"!==typeof response.UIDSignature)&&(response.UIDSignature)&&("undefined"!==typeof response.signatureTimestamp)&&(response.signatureTimestamp)){var dataNotifications={UID:response.UID,UIDSignature:response.UIDSignature,signatureTimestamp:response.signatureTimestamp,frequency:"weekly"};try{$.ajax({url:urlNotifications,type:"POST",data:dataNotifications,async:true,dataType:"json",success:function(result){},error:function(xhr){}})}catch(err){}}}function createUserInSelligent(responseUid){var urlSelligent=options.authServerVocCore+"/vocuser/v1/user/selligent/add";var uid=protectedFunctions.getCookieAutoNewsletters();if(("undefined"!==typeof responseUid)&&(responseUid)){uid=responseUid}var dataSelligent={UID:uid};try{if(options.envVoccore==""){$.ajax({url:urlSelligent,type:"POST",data:JSON.stringify(dataSelligent),async:true,dataType:"json",success:function(result){},error:function(xhr){}})}}catch(err){}}function updateUserCommunicationsInSelligent(){if(options.envVoccore===""){var uid=protectedFunctions.getCookieAutoNewsletters();var data={UID:uid};var url=options.authServerVocCore+"/vocuser/v1/user/selligent/update";try{$.ajax({url:url,type:"POST",data:JSON.stringify(data),async:true,dataType:"json",success:function(result){},error:function(xhr){}})}catch(err){}}}function compareGigyaErrorCode(gigyaErrorCode,value){var result=false;if(("undefined"!==typeof gigyaErrorCode)&&("undefined"!==typeof value)){if(gigyaErrorCode==value){result=true}}return result}function hideElement(idElement){var result=false;if(("undefined"!==typeof idElement)&&(idElement)){var object=$(idElement);if(("undefined"!==typeof object)&&(object)){object.hide();result=true}}return result}function showElement(idElement){var result=false;if(("undefined"!==typeof idElement)&&(idElement)){var object=$(idElement);if(("undefined"!==typeof object)&&(object)){object.show();result=true}}return result}function checkUserServiceAlreadyRegistered(serviceToSearch,servicesList){var result=false;if(("undefined"!==typeof serviceToSearch)&&(serviceToSearch)&&("undefined"!==typeof servicesList)&&(servicesList)&&("undefined"!==typeof servicesList[options.ssoGroup])&&(servicesList[options.ssoGroup])){var services=servicesList[options.ssoGroup].split(",");for(var i=0;i<services.length;i++){if(serviceToSearch===services[i]){result=true}}}else{result=false}return result}function getCustomerServiceFromCookieAndUpdateOptions(){var result=false;var cookieInfoCustomerService=getCookieVocUserInformation("customerService");if(("undefined"!==typeof cookieInfoCustomerService)&&(cookieInfoCustomerService)){if(("undefined"!==typeof cookieInfoCustomerService.serviceReference)&&(cookieInfoCustomerService.serviceReference)){options.serviceReference=cookieInfoCustomerService.serviceReference}if(("undefined"!==typeof cookieInfoCustomerService)&&(cookieInfoCustomerService)){if(("undefined"!==typeof cookieInfoCustomerService.serviceId)&&(cookieInfoCustomerService.serviceId)){options.serviceId=cookieInfoCustomerService.serviceId.toString();result=true}}}return result}function updateCustomerServiceInCookieVocUser(serviceId,serviceReference){var result=false;if(("undefined"!==typeof serviceId)&&(serviceId)){var customerService={serviceId:serviceId};if(("undefined"!==typeof serviceReference)&&(serviceReference)){customerService.serviceReference=serviceReference}result=updateFieldInCookieVocUser("customerService",customerService,true)}return result}function setFieldInScreenForm(fieldName,screenName,valueToSet){var result=false;if(("undefined"!==typeof screenName)&&(screenName)&&("undefined"!==typeof fieldName)&&(fieldName)){var screenFieldObject=findFieldInScreenByName(fieldName,screenName);if(("undefined"!==typeof screenFieldObject)&&(screenFieldObject)&&(screenFieldObject.length)){screenFieldObject.val(valueToSet);result=true}}return result}function initEventListener(voontoApplication){var result=false;var listenerObject=$("body");if(("undefined"!==typeof voontoApplication)&&(voontoApplication)){listenerObject=voontoApplication}result=listenerObject;return result}function getMainEventListener(){return mainEventListener}function notifyLogin(inputParams){var result=false;var params={};if(("undefined"!==typeof inputParams)&&(inputParams)){params=inputParams}if(("undefined"!==typeof params.siteUID)&&(params.siteUID)){if("undefined"===typeof params.cid){params.cid=options.cid}if("undefined"===typeof params.context){params.context=getContext()}params.UIDTimestamp=(params.UIDTimestamp)?params.UIDTimestamp:calculateUIDTimestamp();params.UIDSig=(params.UIDSig)?params.UIDSig:calculateUIDSig(params.siteUID,params.UIDTimestamp);var callbacks={callback:params.callback};var standardCallbacks={callback:function(e){}};var combinedCallbacks={callback:function(e){standardCallbacks.callback(e);safeInvoke(callbacks.callback,e)}};var mergedParams=$.extend(params,combinedCallbacks);gigya.socialize.notifyLogin(mergedParams);result=true}return result}var protectedFunctions={showLogin:showLogin,showRegistration:showRegistration,showProfile:showProfile,showChangePasswdProfile:showChangePasswdProfile,showProfileUpdated:showProfileUpdated,logout:logout,showScreenSet:showScreenSet,setAccountInfo:setAccountInfo,socialLogin:socialLogin,safeEncodeUserSignature:safeEncodeUserSignature,setCurrentService:setCurrentService,getCurrentService:getCurrentService,setMenuOnEvents:setMenuOnEvents,insertPictureInDomElement:insertPictureInDomElement,getDomainForSsoGroup:getDomainForSsoGroup,getAreaPersonalDomain:getAreaPersonalDomain,addParentDiv:addParentDiv,removeParentDiv:removeParentDiv,addModalClassToScreen:addModalClassToScreen,removeSimpleStorage:removeSimpleStorage,findFieldInScreen:findFieldInScreen,removeVoidElement:removeVoidElement,getEventProductsOnReady:function(){return eventProductsOnReady},getAccount:function(){return account},getUser:function(){return user},createCookie:createCookie,fireEvent:fireEvent,updateUI:updateUI,getUserSignature:getUserSignature,flushProducts:flushProducts,flushTrials:flushTrials,getUserType:getUserType,checkService:checkService,resetCaptchaFirefox:resetCaptchaFirefox,captchaVerifyCallback:captchaVerifyCallback,getSectionsWithExternalFields:getSectionsWithExternalFields,buscarCampoEnMongoDeUsuario:buscarCampoEnMongoDeUsuario,thirdPartyCookiesBlocked:thirdPartyCookiesBlocked,facebookTrackInit:facebookTrackInit,facebookTrackEvent:facebookTrackEvent,facebookInyectTrackingPixelHtml:facebookInyectTrackingPixelHtml,addService:addService,setUserNewslettersByFieldAdsMedia:setUserNewslettersByFieldAdsMedia,isFirstLogin:isFirstLogin,userCreatedWithinTenMinutes:userCreatedWithinTenMinutes,isSiteAreaPersonal:isSiteAreaPersonal,resendVerificationCode:resendVerificationCode,resetPassword:resetPassword,switchScreen:switchScreen,getNfrylCookie:getNfrylCookie,createCookieForNfryl:createCookieForNfryl,removeNfrylCookie:removeNfrylCookie,findFieldInScreenByName:findFieldInScreenByName,getFieldValueInScreenByName:getFieldValueInScreenByName,hideScreenSet:hideScreenSet,registerUI:registerUI,saveLastServiceInCookieVocUser:saveLastServiceInCookieVocUser,getLastServiceFromVocUserInformationCookie:getLastServiceFromVocUserInformationCookie,onScreenSubmitScrollToFirstError:onScreenSubmitScrollToFirstError,onScreenSubmitChangeSubmitButtonText:onScreenSubmitChangeSubmitButtonText,showAllErrorsOnFieldTab:showAllErrorsOnFieldTab,setButtonMessage:setButtonMessage,showLoadingSpinner:showLoadingSpinner,getUrlRegisterConfirmationScreen:getUrlRegisterConfirmationScreen,getUrlRegisterPendingConfirmationScreen:getUrlRegisterPendingConfirmationScreen,getUrlPasswdSendScreen:getUrlPasswdSendScreen,getUrlPasswordChangedScreen:getUrlPasswordChangedScreen,getUrlInterestsScreen:getUrlInterestsScreen,getUrlProfileScreen:getUrlProfileScreen,createCookieVocUserTemporal:createCookieVocUserTemporal,getCookieVocUserTemporal:getCookieVocUserTemporal,removeCookieVocUserTemporal:removeCookieVocUserTemporal,getDomainTldFromUrl:getDomainTldFromUrl,getSubDomainDomainTldFromUrl:getSubDomainDomainTldFromUrl,createCookieAutoNewsletters:createCookieAutoNewsletters,getCookieAutoNewsletters:getCookieAutoNewsletters,removeAutoNewslettersCookie:removeAutoNewslettersCookie,updateUserCommunicationsInSelligent:updateUserCommunicationsInSelligent,createUserInSelligent:createUserInSelligent,updateDeleteUserNotificationFrecuency:updateDeleteUserNotificationFrecuency,newslettersAutosuscribe:newslettersAutosuscribe,bindOnClickEventToDomElement:bindOnClickEventToDomElement,bindOnClickEventToDomElementName:bindOnClickEventToDomElementName,redirectToUrl:redirectToUrl,redirectToBackUrl:redirectToBackUrl,updateLastestBackUrlWithUserFieldReturnUrl:updateLastestBackUrlWithUserFieldReturnUrl,updateReturnUrlInVocUserCookie:updateReturnUrlInVocUserCookie,updateReturnUrlTimeoutInVocUserCookie:updateReturnUrlTimeoutInVocUserCookie,getCookieVocUserInformation:getCookieVocUserInformation,compareGigyaErrorCode:compareGigyaErrorCode,checkUserFlowUrlsContains:checkUserFlowUrlsContains,checkBackUrlCookieContains:checkBackUrlCookieContains,hideElement:hideElement,showElement:showElement,checkUserServiceAlreadyRegistered:checkUserServiceAlreadyRegistered,sendCustomerService:sendCustomerService,getCustomerServiceFromCookieAndUpdateOptions:getCustomerServiceFromCookieAndUpdateOptions,saveLastActionInVocUserCookie:saveLastActionInVocUserCookie,saveExtensionFlowUrlInVocUserCookie:saveExtensionFlowUrlInVocUserCookie,updateCustomerServiceInCookieVocUser:updateCustomerServiceInCookieVocUser,setFieldInScreenForm:setFieldInScreenForm,saveRegTokenOnRegister:saveRegTokenOnRegister,updateFieldInCookieVocUser:updateFieldInCookieVocUser,saveServiceAndServices:saveServiceAndServices,getMainEventListener:getMainEventListener,showLoginAdditionalDataPage:showLoginAdditionalDataPage,getUrlAdditionalDataScreen:getUrlAdditionalDataScreen,checkAdditionalDataFilled:checkAdditionalDataFilled,setAdditionalDataStructure:setAdditionalDataStructure};var objectUnitTesting={getUrlParamValue:getUrlParamValue,getUidUsuarioGigya:getUidUsuarioGigya,checkUserFlowUrlsContains:checkUserFlowUrlsContains,saveRegTokenOnRegister:saveRegTokenOnRegister,saveLastActionInVocUserCookie:saveLastActionInVocUserCookie,saveExtensionFlowUrlInVocUserCookie:saveExtensionFlowUrlInVocUserCookie,init:init,checkUserServiceAlreadyRegistered:checkUserServiceAlreadyRegistered,updateCustomerServiceInCookieVocUser:updateCustomerServiceInCookieVocUser,findFieldInScreenByName:findFieldInScreenByName,getFieldValueInScreenByName:getFieldValueInScreenByName,setFieldInScreenForm:setFieldInScreenForm,getCustomerServiceFromCookieAndUpdateOptions:getCustomerServiceFromCookieAndUpdateOptions,updateFieldInCookieVocUser:updateFieldInCookieVocUser,saveLastServiceInCookieVocUser:saveLastServiceInCookieVocUser,saveServiceAndServices:saveServiceAndServices,initEventListener:initEventListener};return{showLogin:showLogin,showRegistration:showRegistration,showProfile:showProfile,getUserType:getUserType,getAuthServer:getAuthServer,getProducts:getProducts,getTrials:getTrials,flushProducts:flushProducts,showSocialLoginCheckOut:showSocialLoginCheckOut,logout:function(params){return logout(params)},registerFlow:function(flow){return registerFlow(flow)},init:function(){return init()},version:function(){return version},isFirstComment:function(){return isFirstComment},sendCustomerService:sendCustomerService,updateCustomerServiceInCookieVocUser:updateCustomerServiceInCookieVocUser,getObjectUnitTesting:function(){return objectUnitTesting}}};if(typeof exports!=="undefined"){exports.VocUserWrapperCore=Vocento.Gigya}function queid_login(){if(typeof gigyaUX!=="undefined"){gigyaUX.showLogin()}}function queid_logout(){if(typeof gigyaUX!=="undefined"){gigyaUX.logout()}}function vocUserGetData(f){var c=$.cookie("voc_uid");var b="";var a="";if(("undefined"!==typeof c)&&(c)){if(("undefined"!==typeof gigyaUX)&&(gigyaUX)&&("undefined"!==typeof Vocento.webBrowserDetector)&&("undefined"!==typeof Vocento)&&(Vocento)){a=Vocento.webBrowserDetector();if((a.indexOf("Safari")>-1)||(a.indexOf("Mobile")>-1)||(a.indexOf("-?")>-1)){c=decodeURIComponent(c)}}function d(k){var h=false;var i="";if(("undefined"!==k)&&(k)&&(k)){try{i=JSON.parse(k.cookie);h=i}catch(j){try{k.cookie=decodeURIComponent(k.cookie);i=JSON.parse(k.cookie);h=i}catch(j){var g=true}}}return h}var e={cookie:c};b=d(e);if(false===b){b=d(e)}}if((typeof b==="undefined")||(typeof f==="undefined")){return b}else{return b[f]}}function getUserType(){var i="anonimo";if(typeof gigyaUX!=="undefined"){i=gigyaUX.getUserType()}else{var b=getCookiePureJS("voc_paywall");if(("undefined"!==typeof b)&&(b)){var a=b.split("|");b={windowLocationOrigin:a[0],vocUserType:a[1]}}var h=b;if((typeof h!=="undefined")&&(h)&&(typeof h.vocUserType!=="undefined")&&(h.vocUserType)){i=h.vocUserType}else{var e="";if(typeof vocUserGetData==="function"){e=vocUserGetData("uid")}if(typeof e!=="undefined"&&e){i="registrado";var d=false;if(("undefined"!==typeof simpleStorage)&&(simpleStorage)){var f=simpleStorage.get("products."+e);if(("undefined"!==typeof f)&&(f)&&(f.length)){var c=$.grep(f,function(j){return j.tipo==="SCR"});var g=$.grep(f,function(j){if(j.tipo!=="TRL"){return false}else{return true}});i=c.length?"suscriptor":g.length?"trial":"registrado"}else{}}}else{}}}return i}function setCookiePureJS(a,g,h,e,i,f){var b;var d=false;if(h){var c=new Date();c.setTime(c.getTime()+(h*24*60*60*1000));b="; expires="+c.toUTCString()}else{b=""}if(true===f){document.cookie=a+"="+g+b+"; path="+i+"; domain="+e;d=true}else{if((null===$.cookie(a))||("undefined"===typeof $.cookie(a))){document.cookie=a+"="+g+b+"; path="+i+"; domain="+e;d=true}}return d}function getCookiePureJS(c){var a=false;if(document.cookie.length>0){var d=document.cookie.indexOf(c+"=");if(d!==-1){d=d+c.length+1;var b=document.cookie.indexOf(";",d);if(b===-1){b=document.cookie.length}a=decodeURI(document.cookie.substring(d,b))}}return a};var Vocento=Vocento||{};(function(e){var b=false;function d(f){if(b&&typeof console!=="undefined"){console.log(f)}}function c(m,l){var j=m.split(".");var g=l.split(".");for(var f=0;f<j.length;++f){var k=parseInt(j[f]);var h=parseInt(g[f]);if(g.length===f){return -1}if(k===h){continue}else{if(k>h){return -1}else{return 1}}}if(j.length!==g.length){return 1}return 0}var a=e().jquery;if(c("1.7",a)<0){if(!e.fn.on){jQuery.fn.on=function(g,f,i,h){if(i===null&&h===null){h=f;i=f=undefined}else{if(h===null){if(typeof f==="string"){h=i;i=undefined}else{h=i;i=f;f=undefined}}}if(h===false){h=function(){return false}}else{if(!h){return this}}return e(this).bind(g,i,h)}}}})(jQuery);(function(c){var a="placeholder" in document.createElement("input");var b=window.opera&&parseFloat(window.opera.version())<10.5;c.fn.placeholder=function(f){var d=c.extend({},c.fn.placeholder.defaults,f),e=d.placeholderCSS.left;return(a)?this:this.each(function(){var k=c(this),i=c.trim(k.val()),m=k.width(),j=k.height(),h=(this.id)?this.id:"placeholder"+(Math.floor(Math.random()*1123456789)),g=k.attr("placeholder"),l=c("<label for="+h+">"+g+"</label>");d.placeholderCSS.width=m;d.placeholderCSS.height=j;d.placeholderCSS.color=d.placeholderCSS.color;d.placeholderCSS.left=(b&&(this.type==="email"||this.type==="url"))?"11%":e;l.css(d.placeholderCSS);k.wrap(d.inputWrapper);k.attr("id",h).after(l);if(i){l.hide()}k.focus(function(){if(!c.trim(k.val())){l.hide()}});k.blur(function(){if(!c.trim(k.val())){l.show()}})})};c.fn.placeholder.defaults={inputWrapper:'<span class="placeholder_emulate" style="position:relative; display:block;"></span>',placeholderCSS:{color:"#aaaaaa",position:"absolute",left:"5px",top:"3px","overflow-x":"hidden",display:"block"}}})(jQuery);Vocento.log=function(g,f){var a=false;var b="info";var d=0;if(("undefined"!==typeof f)&&(f)){b=f}if((typeof console!=="undefined")&&(console)){var c="purple";var e="";if(("undefined"!==typeof g)&&(g)&&((g.length)||("object"===typeof g))){e=JSON.stringify(g,null,4)}else{e=g}if((("info"===b)||("log"===b))&&(2===d)){c="purple";console.log("%c---- Log - VocUserGigya: "+e,"color:"+c+";")}if(("warn"===b)&&((1===d)||(2===d))){c="yellow";console.warn("%c---- Log - VocUserGigya: "+e,"color:"+c+";")}if(("error"===b)&&((0===d)||(1===d)||(2===d))){c="yellow";console.error("%c---- Log - VocUserGigya: "+e)}a=true}return a};Vocento.UnicodeToChar=function(b){var a=false;if(("undefined"!==typeof b)&&(b)&&(b.length===1)){switch(b){case"a":a=String.fromCharCode(225);break;case"e":a=String.fromCharCode(233);break;case"i":a=String.fromCharCode(237);break;case"o":a=String.fromCharCode(243);break;case"u":a=String.fromCharCode(250);break;case"n":a=String.fromCharCode(241);break;case"A":a=String.fromCharCode(193);break;case"E":a=String.fromCharCode(201);break;case"I":a=String.fromCharCode(205);break;case"O":a=String.fromCharCode(211);break;case"U":a=String.fromCharCode(218);break;case"N":a=String.fromCharCode(209);break;default:break}}return a};Vocento.Row=function(fields,asColumns){var $=jQuery;var options={};var data={};var profile={};var default_obj={inSchema:true,displayText:"",required:false,attr:{type:"",name:"",id:"",cssClass:"",placeholder:"",value:"",onNewValue:""}};fields.field=$.extend(true,{},default_obj,fields.field);function setOptions(newOptions){options=newOptions;return this}function setData(newData){data=newData;return this}function setProfile(newProfile){profile=newProfile;return this}function getFieldHTML(obj){var html="";var value="";try{if(typeof eval(obj.attr.value)!=="undefined"){value=eval(obj.attr.value)}else{if(typeof obj.attr.onNewValue!=="undefined"){value=obj.attr.onNewValue}else{value=""}}}catch(err){if(typeof obj.attr.onNewValue!=="undefined"){value=obj.attr.onNewValue}else{value=""}}var fieldStyle="";if(("undefined"!==typeof obj.attr.style)&&(obj.attr.style)){fieldStyle=obj.attr.style}var type="";var id="";var cls="";var req="";var name="";var selected="";switch(obj.attr.type){case"text":req=(obj.required)?'<span class="required" data-bound-to="'+obj.attr.name+'">*</label>':"";type=(obj.attr.type)?' type="'+obj.attr.type+'"':"";id=(obj.attr.id)?' id="'+obj.attr.id+'"':"";name="";if(obj.inSchema){name=(obj.attr.name)?' name="'+obj.attr.name+'" data-gigya-name="'+obj.attr.name+'"':""}else{name=(obj.attr.name)?' vocento-name="'+obj.attr.name+'"':""}cls=(obj.attr.cssClass)?' class="gigya-input-text '+obj.attr.cssClass+'"':' class="gigya-input-text"';var placeholder=(obj.attr.placeholder)?' placeholder="'+obj.attr.placeholder+'"':"";value=(value)?' value="'+value+'"':"";html='<div class="gigya-composite-control gigya-composite-control-textbox" style="display: block; '+fieldStyle+'">';if($.trim(obj.displayText)){var textStyle="";if(("undefined"!==typeof fieldStyle)&&(fieldStyle)){textStyle='style="'+fieldStyle+'"'}html+='<label class="gigya-label">'+obj.displayText+":"+req+"</label>"}html+="<input"+type+id+cls+name+placeholder+value+'><span class="gigya-error-msg" data-bound-to="'+obj.attr.name+'"></span></div>';break;case"hidden":type=(obj.attr.type)?' type="'+obj.attr.type+'"':"";id=(obj.attr.id)?' id="'+obj.attr.id+'"':"";if(obj.inSchema){name=(obj.attr.name)?' name="'+obj.attr.name+'" data-gigya-name="'+obj.attr.name+'"':""}else{name=(obj.attr.name)?' vocento-name="'+obj.attr.name+'"':""}value=(value)?' value="'+value+'"':"";html="<input"+type+id+name+value+">";break;case"checkbox":req=(obj.required)?'<label class="required" data-bound-to="'+obj.attr.name+'">*</label>':"";type=(obj.attr.type)?' type="'+obj.attr.type+'"':"";id=(obj.attr.id)?' id="'+obj.attr.id+'"':"";if(obj.inSchema){name=(obj.attr.name)?' name="'+obj.attr.name+'" data-gigya-name="'+obj.attr.name+'"':""}else{name=(obj.attr.name)?' vocento-name="'+obj.attr.name+'"':""}cls=(obj.attr.cssClass)?' class="gigya-input-checkbox '+obj.attr.cssClass+'"':' class="gigya-input-checkbox"';value=(value==="true"||value===true)?' checked="checked"':"";var checkBoxStyle="";if(("undefined"!==typeof fieldStyle)&&(fieldStyle)){checkBoxStyle='style="'+fieldStyle+'"'}html='<div class="gigya-composite-control gigya-composite-control-checkbox"><label class="gigya-label vocuser-custominputwrap"><input'+type+id+cls+name+value+'><span class="vocuser-custominput-checkbox"></span><span class="gigya-label-checkbox vocuser-custominput-text" '+checkBoxStyle+">"+obj.displayText+"</span>"+req+'</label><span class="gigya-error-msg" data-bound-to="'+obj.attr.name+'"></span></div>';break;case"label":var labelStyle="";if(("undefined"!==typeof fieldStyle)&&(fieldStyle)){labelStyle='style="'+fieldStyle+'"'}html='<div class="gigya-composite-control gigya-composite-control-label" '+labelStyle+"><label>"+obj.displayText+"</label></div>";break;case"textbox":req=(obj.required)?' data-required="true" ':" ";html='<div class="gigya-composite-control gigya-composite-control-textbox form-group"><input type="text" data-gigya-placeholder="'+obj.displayText+'" class="gigya-input-text form-control" data-display-name="'+obj.displayText+'" name="'+obj.attr.name+'" '+req+'data-gigya-name="'+obj.attr.name+'" placeholder="'+obj.displayText+'  *"><span class="gigya-error-msg" data-bound-to="'+obj.attr.name+'"></span></div></div>';break;case"textboxPrf":req=(obj.required)?' data-required="true" ':" ";html="<label>"+obj.displayText+'</label><input class="gigya-input-text" name="'+obj.attr.name+'" data-display-name="" type="text" placeholder="'+obj.displayText+'" '+req+'><span class="gigya-error-msg" data-bound-to="'+obj.attr.name+'"></span>';break;case"select":req=(obj.required)?' data-required="true" ':" ";html='<div class="gigya-composite-control gigya-composite-control-dropdown form-group">';html+='<select data-gigya-placeholder="'+obj.attr.placeholder+' " class="gigya-input-text form-control" data-display-name="'+obj.attr.placeholder+'" name="'+obj.attr.name+'" ';html+='data-gigya-name="'+obj.attr.name+'" '+req+">";$.each(obj.attr.options,function(idx,val){if(idx===obj.attr.value){selected='data-gigya-placeholder="'+obj.attr.placeholder+'" disabled selected="selected" ';idx=idx+" *"}else{selected=""}html+='<option value="'+val+'" '+selected+">"+idx+"</option>"});html+="</select>";html+='<span class="gigya-error-msg" data-bound-to="'+obj.attr.name+'"></span></div>';break;default:break}return html}function getColumnHTML(obj){var html="";$.each(obj,function(key,field){var id=(field.columnId)?' id="'+field.columnId+'"':"";var cls=(field.columnClass)?' class="gigya-layout-cell '+field.columnClass+'"':' class="gigya-layout-cell"';var style=(field.columnStyle)?' style="'+field.columnStyle+'"':"";html+="<div"+id+cls+style+">"+getFieldHTML(field)+"</div>"});html+='<div class="gigya-clear"></div>';return html}function getHTML(){if(asColumns){return getColumnHTML(fields)}else{var html="";$.each(fields,function(key,field){html+=getFieldHTML(field)});return html}}function getRowFields(){var result=false;var rowFields=[];$.each(fields,function(key,field){rowFields[rowFields.length]=field.attr.name});if(("undefined"!==typeof rowFields)&&(rowFields)&&(rowFields.length)){result=rowFields}return result}return{html:function(){return getHTML()},getRowFields:function(){return getRowFields()},setOptions:setOptions,setData:setData,setProfile:setProfile}};Vocento.insertCustomFields=function(f){var m={};var c={fields:{},fieldsGroup:{},externalFieldsSection:{},screens:{}};function g(n){m=n;return this}function e(n){c=n;return this}function j(o,p){var n="";switch(p){case"registrationEnterpriseRss":case"registrationEnterprisePositionRss":n=o;break;default:n='<div class="gigya-layout-row" data-vocento-row-key="'+p+'">'+o+"</div>";break}return n}function b(o){var n=false;if(("undefined"!==typeof o)&&(o)&&(o.length)){n=true}return n}function h(o){var n=false;if(("undefined"!==typeof o)&&(o)){n=true}return n}function d(o,n){f.each(c.fieldsGroup[n.group],function(z,r){var t=c.fields[r];t.setOptions(m);var v=j(t.html(),r);var x="";var y=false;var u="";var s=false;var q="";if((h(n.elementId))&&(false===s)){u=n.elementId;q="#"+u;x=f("#"+o).find("div"+q);if(b(x)===false){x=f(q)}if(b(x)){x.append(v);x.find("input[placeholder]:visible").placeholder();s=true}else{q="#"+u;x=f("#"+o).find("div"+q);if(b(x)===false){x=f(q)}if(b(x)){x.append(v);s=true}}}if(((h(n.beforeField))||(h(n.afterField)))&&(false===s)){if(h(n.beforeField)){u=n.beforeField}else{u=n.afterField}q=' form div input[name="'+u+'"]';x=f("div#"+o+q).parents(".gigya-layout-row:first");if(b(x)===false){x=f("div#"+o+q).parents(".gigya-layout-row:first")}if(b(x)){y=true}else{q="div#"+o+' form [name="'+u+'"]';x=f(q);if(b(x)===false){x=f(q)}if(b(x)){var p="";if(o==="gigya-complete-registration-screen"){p=x.parents("div.gigya-composite-control.gigya-composite-control-textbox.form-group");if(b(p)){y=true;x=p}}else{p=x.parents(".gigya-layout-row:first");if(b(p)){y=true;x=p}else{var w=x.parents(".gigya-layout-cell:first");if(b(w)){y=true;x=w}else{y=true}}}}}if(true===y){if(h(n.beforeField)){x.before(v)}else{x.after(v)}s=true}}if((h(n.lastRow))&&(true===n.lastRow)&&(false===s)){u=n.lastRow;q=" .gigya-layout-row:last";x=f("#"+o+q);if(b(x)===false){x=f(q)}if(b(x)){x.after(v);s=true}else{q=" div.gigya-layout-row:last";x=f("form."+o+q);if(b(x)===false){x=f(q)}if(b(x)){x.append(v);s=true}}}})}function a(o){if((typeof c!=="undefined")&&(c)&&(typeof c.screens!=="undefined")&&(c.screens)&&(typeof o!=="undefined")&&(o)){if(typeof c.screens[o]!=="undefined"){for(var p in c.screens[o]){if(c.screens[o].hasOwnProperty(p)){var n=c.screens[o][p];d(o,n)}}}}return this}function l(){f("div[data-vocento-row-key]").remove();return this}function k(){return f("form:visible [vocento-name]")}function i(n){f.each(n,function(o,q){var p=f('form:visible [vocento-name="'+o+'"]');if(p.is("input:checkbox")){p.attr("checked",q)}p.val(q)})}return{setOptions:g,setManifest:e,getHTML:a,removeHTML:l,getExternalFieldsNames:k,setExternalFields:i}}(jQuery);Vocento.translateError=function(a){var b="";switch(a.errorCode){default:b=a.errorMessage;break}return b};Vocento.customValidation=(function(e){var c={};var b={};var d={};var a={};setOptions=function(f){c=f;return this};setUser=function(f){b=f;return this};setAccount=function(f){d=f;return this};setFields=function(f){a=e.extend(true,a,f);return this};_validateCaptcha=function(h){var k=false;var i=null;if("undefined"!==typeof h){try{i=grecaptcha.getResponse(h)}catch(g){i=e("#g-recaptcha-response").val()}}if(("undefined"!==typeof i)&&(i)){var f=c.authServer+"/validate/captcha?captchaResponse="+i;try{var l=new XMLHttpRequest();if("withCredentials" in l){l.open("GET",f,false)}else{if(typeof XDomainRequest!=="undefined"){l=new XDomainRequest();l.open("GET",f,false)}else{l=null}}if(true===json.success){k=true}if(!l){alert("CORS not supported");return}l.send(null);if('{"success":true}'===JSON.parse(l.responseText)){k=true}}catch(j){Vocento.log("Gigya::validateCaptcha => Error al validar el captcha","error")}}return k};validateForm=function(f,g){var h=true;if(typeof f==="string"){f="form."+f+":visible"}e(f).find("input:visible[name], input:visible[vocento-name], select:visible[name], select:visible[vocento-name], textarea:visible[name], textarea:visible[vocento-name]").each(function(i,j){h=validateField(e(j))&&h});if("undefined"!==typeof(g)&&true===h){if(true!==_validateCaptcha(g)){h=false;if("undefined"!==typeof(g)){grecaptcha.reset(g)}e("#vocento-error-captcha-msg").show();e("#vocento-error-captcha-msg").html("<p>El valor del captcha es incorrecto</p>");e("#vocento-error-captcha-msg").addClass("gigya-error-msg gigya-error-msg-active");return h}}return h};validateField=function(f){var h=true;var g=(typeof e(f).attr("name")!=="undefined"&&e(f).attr("name"))?e(f).attr("name"):e(f).attr("vocento-name");if(typeof g!=="undefined"&&typeof a[g]==="function"){h=a[g](e(f),e('[data-bound-to="'+g+'"].gigya-error-msg'))}if(typeof g!=="undefined"&&typeof a[g]==="object"){h=a[g]["validationName"](e(f),e('[data-bound-to="'+g+'"].gigya-error-msg'),a[g]["validationParams"])}return h};_showError=function(l,j,m){if(("undefined"!==typeof l)&&(l)){var k=e(l);var i="";if(("undefined"!==typeof k)&&(k)&&(k.length)){i=k.attr("data-display-name")||"";m=m||"El campo %name% no es v&aacute;lido";var f=k.parents("form:visible").find("input[type=submit]");if(typeof f.data("originalValue")==="undefined"){f.data("originalValue",f.val())}f.val("Corrige los errores");if(("undefined"!==typeof k.offset)&&(k.offset())&&("undefined"!==typeof k.offset().top)){var h=e("#header");var g=0;if(("undefined"!==typeof h.offset)&&(h.offset())&&("undefined"!==typeof h.offset().top)){g=h.offset().top}e("html, body").animate({scrollTop:k.offset().top-g-1},200)}k.addClass("gigya-error")}if(("undefined"!==typeof j)&&(j)){e(j).addClass("gigya-error-msg gigya-error-msg-active");e(j).html(m.replace("%name%",i));e(j).show()}}return false};_hideError=function(i,h){e(i).removeClass("gigya-error");e(i).removeClass("gigya-error-msg gigya-error-msg-active");e(h).html("").hide();var f=e(i).parents("form").find("input[type=submit]");var g=f.data("originalValue");if((typeof g!=="undefined")&&(g)){f.val(f.data("originalValue"))}return true};_requiredField=function(g,f){if(e(g).attr("type")==="checkbox"){if(!e(g).is(":checked")){return _showError(g,f,"El campo %name% es obligatorio")}else{return _hideError(g,f)}}else{if(("undefined"===typeof e.trim(e(g).val()))||(!e.trim(e(g).val()))){return _showError(g,f,"El campo %name% es obligatorio")}else{return _hideError(g,f)}}};_regexField=function(l,i,j,m,f){var f=typeof f!=="undefined"?f:"El campo %name% no es correcto";var h=/^\d{5}$/;var g=j;if(typeof j==="string"){j=new RegExp(j)}var k=e(l).val();if(typeof m!=="undefined"&&(m)){k=m}if((typeof k.match(j)==="undefined")||(!k.match(j))){if(g.toString()===h.toString()){return _showError(l,i,f)}return _showError(l,i,f)}else{return _hideError(l,i)}};_isSpain=function(h){var g=["ESPA"+Vocento.UnicodeToChar("N")+"A","ESPANYA","SPAIN","ESP","ES"];var j=e(h).parents("form:visible");var i=e(j).find('[name="profile.country"]').val();if(typeof i==="undefined"){return false}var f=g.indexOf(i.toUpperCase());if(f===-1){return false}return true};_hasValue=function(f){return e.trim(e(f).val())!==""};_isZip=function(h,g){var f="El campo %name% no es correcto, debes introducir 5 d"+Vocento.UnicodeToChar("i")+"gitos";if(_isSpain(h)){return _requiredField(h,g)&&_regexField(h,g,/^\d{5}$/,false,f)}else{return _requiredField(h,g)&&_regexField(h,g,/^\d{5}$/,false,f)}};_isBirthDate=function(k,g){var h=k.val();var i=k.parents("form:visible");var j=e(i).find('[name="profile.birthMonth"]').val();var f=e(i).find('[name="profile.birthDay"]').val();if(!f||!j||!h){return _showError(k,g,"La fecha de nacimiento es obligatoria")}var l=new Date(h,j-1,f);if(l&&l.getFullYear()!==Number(h)||l.getMonth()!==Number(j)-1||l.getDate()!==Number(f)){return _showError(k,g,"La fecha no es v&aacute;lida")}return _hideError(k,g)};_isSpanishPhone=function(g,f){if(_isSpain(g)&&_hasValue(g)){return _regexField(g,f,/^(8|9)[\d]{8}$/,e(g).val().replace(/(\(|\)|-| )/g,""))}return _hideError(g,f)};_isValidPhone=function(g,f){if(_hasValue(g)){return _regexField(g,f,/^(8|9)[\d]{8}$/,e(g).val().replace(/(\(|\)|-| )/g,""))}return _hideError(g,f)};_isSpanishMobilePhone=function(g,f){if(_isSpain(g)&&_hasValue(g)){return _regexField(g,f,/^(6|7)[\d]{8}$/,e(g).val().replace(/(\(|\)|-| )/g,""))}return _hideError(g,f)};_isValidMobilePhone=function(g,f){if(_hasValue(g)){return _regexField(g,f,/^(6|7)[\d]{8}$/,e(g).val().replace(/(\(|\)|-| )/g,""))}return _hideError(g,f)};_isValidNIF=function(h,f){var g=(function(){var i="TRWAGMYFPDXBNJZSQVHLCKET";var j="^\\d{8}[a-zA-Z]{1}$";var k="^[a-zA-Z]{1}\\d{7}[a-jA-J0-9]{1}$";checkAll=function(l){if(checkCIF(l)){return true}else{if(checkTR(l)){return true}else{if(checkNIF(l)){return true}else{return false}}}};checkNIF=function(o){if((o.length!==8)&&(o.length!==9)){return false}if(o.length===8){o="0"+o}var n=new RegExp(j);if(!o.match(n)){return false}var m=o.substring(0,o.length-1);var l=i.charAt(m%23);return(l===o.charAt(o.length-1).toUpperCase())};checkTR=function(l){if((l.length!==10)&&(l.length!==9)){return false}if((l.charAt(0).toUpperCase()!=="X")&&(l.charAt(0).toUpperCase()!=="Y")&&(l.charAt(0).toUpperCase()!=="Z")){return false}var m="0";if(l.charAt(0).toUpperCase()==="Y"){m="1"}if(l.length===9){return checkNIF(m+l.substring(1,l.length))}else{return checkNIF(l.substring(1,l.length))}};checkCIF=function(q){var s=new Array(0,2,4,6,8,1,3,5,7,9);var n=q.toUpperCase();var m=0;var r;var l;var o=new RegExp(k);if(!n.match(o)){return false}if(!/^[ABCDEFGHJKLMNPRQSUVW]/.test(n)){return false}for(var p=2;p<=6;p+=2){m=m+s[parseInt(q.substr(p-1,1))];m=m+parseInt(q.substr(p,1))}m=m+s[parseInt(q.substr(7,1))];m=(10-(m%10));if(m===10){m=0}l=q.toUpperCase().charAt(8);return(l===m)||(m===1&&l==="A")||(m===2&&l==="B")||(m===3&&l==="C")||(m===4&&l==="D")||(m===5&&l==="E")||(m===6&&l==="F")||(m===7&&l==="G")||(m===8&&l==="H")||(m===9&&l==="I")||(m===0&&l==="J")};return{checkAll:checkAll}})();if(_hasValue(h)&&!g.checkAll(e(h).val())){return _showError(h,f)}return _hideError(h,f)};_isSpanishNIF=function(g,f){var h=(function(){var i="TRWAGMYFPDXBNJZSQVHLCKET";var j="^\\d{8}[a-zA-Z]{1}$";var k="^[a-zA-Z]{1}\\d{7}[a-jA-J0-9]{1}$";checkAll=function(l){if(checkCIF(l)){return true}else{if(checkTR(l)){return true}else{if(checkNIF(l)){return true}else{return false}}}};checkNIF=function(o){if((o.length!==8)&&(o.length!==9)){return false}if(o.length===8){o="0"+o}var n=new RegExp(j);if(!o.match(n)){return false}var m=o.substring(0,o.length-1);var l=i.charAt(m%23);return(l===o.charAt(o.length-1).toUpperCase())};checkTR=function(l){if((l.length!==10)&&(l.length!==9)){return false}if((l.charAt(0).toUpperCase()!=="X")&&(l.charAt(0).toUpperCase()!=="Y")&&(l.charAt(0).toUpperCase()!=="Z")){return false}var m="0";if(l.charAt(0).toUpperCase()==="Y"){m="1"}if(l.length===9){return checkNIF(m+l.substring(1,l.length))}else{return checkNIF(l.substring(1,l.length))}};checkCIF=function(q){var s=new Array(0,2,4,6,8,1,3,5,7,9);var n=q.toUpperCase();var m=0;var r;var l;var o=new RegExp(k);if(!n.match(o)){return false}if(!/^[ABCDEFGHJKLMNPRQSUVW]/.test(n)){return false}for(var p=2;p<=6;p+=2){m=m+s[parseInt(q.substr(p-1,1))];m=m+parseInt(q.substr(p,1))}m=m+s[parseInt(q.substr(7,1))];m=(10-(m%10));if(m===10){m=0}l=q.toUpperCase().charAt(8);return(l===m)||(m===1&&l==="A")||(m===2&&l==="B")||(m===3&&l==="C")||(m===4&&l==="D")||(m===5&&l==="E")||(m===6&&l==="F")||(m===7&&l==="G")||(m===8&&l==="H")||(m===9&&l==="I")||(m===0&&l==="J")};return{checkAll:checkAll}})();if(_isSpain(g)&&_hasValue(g)&&!h.checkAll(e(g).val())){return _showError(g,f)}return _hideError(g,f)};_isNumber=function(g,f){if(_hasValue(g)){return _regexField(g,f,/^[0-9]+$/,e(g).val().replace(/(\(|\)|-| )/g,""),"El campo %name% no es correcto, debes introducir solamente d"+Vocento.UnicodeToChar("i")+"gitos")}return _hideError(g,f)};_maxLength=function(h,f,i){if(_hasValue(h)&&(typeof i!=="undefined")&&(i)){var g="^.{1,"+i+"}$";return _regexField(h,f,g,false,"El campo %name% no es correcto, debes introducir como m"+Vocento.UnicodeToChar("a")+"ximo "+i+" caracteres")}return _hideError(h,f)};_minLength=function(h,f,i){if(_hasValue(h)&&(typeof i!=="undefined")&&(i)){var g="^.{"+i+",}$";return _regexField(h,f,g,false,"El campo %name% no es correcto, debes introducir como m"+Vocento.UnicodeToChar("i")+"nimo "+i+" caracteres")}return _hideError(h,f)};return{setOptions:setOptions,setUser:setUser,setAccount:setAccount,setFields:setFields,validateForm:validateForm,validateField:validateField,addField:function(f,g){a[f]=g},showError:function(g,f,h){_showError(g,f,h)},hideError:function(g,f){_hideError(g,f)}}})(jQuery);Vocento.safeInvoke=function(c,b){if(c){return c(b)}else{var a='safeInvoke => Método: "'+c+'" no encontrado. Parámetros: "'+b+'"';if(("undefined"!==typeof options)&&(options)&&("undefined"!==typeof options.debug)&&(options.debug)){}return a}};Vocento.getContext=function(){var b=new Date();var a=Math.floor(b.getTime()/1000);return{url:window.location.href,timestamp:a}};Vocento.reload=function(){document.location.reload()};Vocento.getMainDomain=function(){var a=document.domain.split(".");if(a.length>=2){a=a[a.length-2]+"."+a[a.length-1]}return a};Vocento.webBrowserDetector=function(){var a="";var c=navigator.userAgent;var b="";var d=c.match(/(opera|chrome|safari|firefox|msie|mobile|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(d[1])){b=/\brv[ :]+(\d+)/g.exec(c)||[];a="IE "+(b[1]||"")}else{if(d[1]==="Chrome"){b=c.match(/\bOPR\/(\d+)/);if(b!==null){return"Opera "+b[1]}}d=d[2]?[d[1],d[2]]:[navigator.appName,navigator.appVersion,"-?"];if((b=c.match(/version\/(\d+)/i))!==null){d.splice(1,1,b[1])}a=d.join(" ")}return a};Vocento.emailDomainBanned=function(d,b){var a=false;if(("undefined"!==typeof d)&&(d)&&("undefined"!==typeof b)&&(b)){var c=b+"/api/v1/emailDomainBanned";try{$.ajax({url:c+"?callback=?",data:{email:d},type:"get",contentType:"application/json",dataType:"jsonp",async:false,success:function(f){if(("undefined"!==typeof f)&&(f)){if(true===f.result){a=true}}},error:function(h,f,g){Vocento.log("Gigya::emailDomainBanned => Error al validar el correo de registro del usuario.","error");a=false}})}catch(e){Vocento.log("Gigya::emailDomainBanned => Error al validar el correo de registro del usuario.","error")}}return a};Vocento.encodeToBase64=function(d){var a=false;if(("undefined"!==typeof d)&&(d)){var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(m){var v="";var j,g,k,w,h,q,p;var l=0;m=c._utf8_encode(m);while(l<m.length){j=m.charCodeAt(l++);g=m.charCodeAt(l++);k=m.charCodeAt(l++);w=j>>2;h=(j&3)<<4|g>>4;q=(g&15)<<2|k>>6;p=k&63;if(isNaN(g)){q=p=64}else{if(isNaN(k)){p=64}}v=v+this._keyStr.charAt(w)+this._keyStr.charAt(h)+this._keyStr.charAt(q)+this._keyStr.charAt(p)}return v},decode:function(m){var v="";var j,g,k;var w,h,q,p;var l=0;m=m.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<m.length){w=this._keyStr.indexOf(m.charAt(l++));h=this._keyStr.indexOf(m.charAt(l++));q=this._keyStr.indexOf(m.charAt(l++));p=this._keyStr.indexOf(m.charAt(l++));j=w<<2|h>>4;g=(h&15)<<4|q>>2;k=(q&3)<<6|p;v=v+String.fromCharCode(j);if(q!=64){v=v+String.fromCharCode(g)}if(p!=64){v=v+String.fromCharCode(k)}}v=c._utf8_decode(v);return v},_utf8_encode:function(h){h=h.replace(/\r\n/g,"\n");var f="";for(var i=0;i<h.length;i++){var g=h.charCodeAt(i);if(g<128){f+=String.fromCharCode(g)}else{if(g>127&&g<2048){f+=String.fromCharCode(g>>6|192);f+=String.fromCharCode(g&63|128)}else{f+=String.fromCharCode(g>>12|224);f+=String.fromCharCode(g>>6&63|128);f+=String.fromCharCode(g&63|128)}}}return f},_utf8_decode:function(h){var f="";var i=0;var g=c1=c2=0;while(i<h.length){g=h.charCodeAt(i);if(g<128){f+=String.fromCharCode(g);i++}else{if(g>191&&g<224){c2=h.charCodeAt(i+1);f+=String.fromCharCode((g&31)<<6|c2&63);i+=2}else{c2=h.charCodeAt(i+1);c3=h.charCodeAt(i+2);f+=String.fromCharCode((g&15)<<12|(c2&63)<<6|c3&63);i+=3}}}return f}};var b=c.encode(d);a=b}return a};Vocento.decodeFromBase64=function(d){var a=false;if(("undefined"!==typeof d)&&(d)){var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(m){var v="";var j,g,k,w,h,q,p;var l=0;m=c._utf8_encode(m);while(l<m.length){j=m.charCodeAt(l++);g=m.charCodeAt(l++);k=m.charCodeAt(l++);w=j>>2;h=(j&3)<<4|g>>4;q=(g&15)<<2|k>>6;p=k&63;if(isNaN(g)){q=p=64}else{if(isNaN(k)){p=64}}v=v+this._keyStr.charAt(w)+this._keyStr.charAt(h)+this._keyStr.charAt(q)+this._keyStr.charAt(p)}return v},decode:function(m){var v="";var j,g,k;var w,h,q,p;var l=0;m=m.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<m.length){w=this._keyStr.indexOf(m.charAt(l++));h=this._keyStr.indexOf(m.charAt(l++));q=this._keyStr.indexOf(m.charAt(l++));p=this._keyStr.indexOf(m.charAt(l++));j=w<<2|h>>4;g=(h&15)<<4|q>>2;k=(q&3)<<6|p;v=v+String.fromCharCode(j);if(q!=64){v=v+String.fromCharCode(g)}if(p!=64){v=v+String.fromCharCode(k)}}v=c._utf8_decode(v);return v},_utf8_encode:function(h){h=h.replace(/\r\n/g,"\n");var f="";for(var i=0;i<h.length;i++){var g=h.charCodeAt(i);if(g<128){f+=String.fromCharCode(g)}else{if(g>127&&g<2048){f+=String.fromCharCode(g>>6|192);f+=String.fromCharCode(g&63|128)}else{f+=String.fromCharCode(g>>12|224);f+=String.fromCharCode(g>>6&63|128);f+=String.fromCharCode(g&63|128)}}}return f},_utf8_decode:function(h){var f="";var i=0;var g=c1=c2=0;while(i<h.length){g=h.charCodeAt(i);if(g<128){f+=String.fromCharCode(g);i++}else{if(g>191&&g<224){c2=h.charCodeAt(i+1);f+=String.fromCharCode((g&31)<<6|c2&63);i+=2}else{c2=h.charCodeAt(i+1);c3=h.charCodeAt(i+2);f+=String.fromCharCode((g&15)<<12|(c2&63)<<6|c3&63);i+=3}}}return f}};var b=c.decode(d);a=b}return a};if(typeof exports!=="undefined"){exports.Vocento=Vocento};var Vocento=Vocento||{};Vocento.BaseFlow=function(f){var i="3.0.6";var n={};var e=function(){};var c={};var l=(Vocento.getContext)?Vocento.getContext:function(){};var h=null;function j(){return{legaltermsLastUpdate:"20130723",screenName:{updateLegalTerms:"gigya-update-legalterms-screen",verifyNickname:"gigya-change-nickname-screen",updateThankyou:"gigya-update-thanks-screen"}}}function d(){var o={fields:{registration_ssoGroup:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.ssoGroup",value:"options.ssoGroup"}}}),registration_service:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.service",value:"options.service"}}}),registration_domain:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.domain",value:"window.location.hostname"}}}),registration_url:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.url",value:"window.location.href"}}}),registration_browser:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.browserAgent",value:"navigator.userAgent"}}}),registration_nick:new Vocento.Row({field:{attr:{type:"hidden",name:"profile.nickname"}}}),registration_privacy_policy:new Vocento.Row({field:{attr:{type:"hidden",name:"data.registration.privacyPolicy",value:"20161115"}}}),registration_province:new Vocento.Row({field:{attr:{type:"hidden",name:"data.province",value:""}}}),registration_city:new Vocento.Row({field:{attr:{type:"hidden",name:"profile.city",value:""}}}),registration_municipality:new Vocento.Row({field:{attr:{type:"hidden",name:"data.municipality",value:""}}}),legalterms_last_update:new Vocento.Row({field:{attr:{type:"hidden",name:"data.legaltermsLastUpdate",value:"options.legaltermsLastUpdate"}}}),imported:new Vocento.Row({field:{attr:{type:"hidden",name:"data.isImported",value:"false"}}}),province:new Vocento.Row({field:{attr:{type:"text",name:"data.province",value:"",placeholder:"Provincia"}}}),legalterms:new Vocento.Row({field:{attr:{type:"hidden",name:"data.legalterms."+n.ssoGroup,value:"true"}}}),services:new Vocento.Row({field:{attr:{type:"hidden",name:"data.services."+n.ssoGroup,value:"options.service"}}}),adsGroup:new Vocento.Row({field:{displayText:"Deseo recibir noticias de "+n.siteName+", as&iacute; como novedades sobre servicios exclusivos de "+n.siteName+' y su <a target="_blank" href="http://www.vocento.com"><strong>grupo</strong></a>, incluso por v&iacute;a electr&oacute;nica',attr:{type:"checkbox",name:"data.adsGroup",value:"data.adsGroup",onNewValue:"false"}}}),adsThirdparty:new Vocento.Row({field:{displayText:'Deseo recibir novedades y comunicaciones relativas a terceras empresas de <a target="_blank" href="http://www.vocento.com/sectores">estos sectores</a>, incluso por v&iacute;a electr&oacute;nica',attr:{type:"checkbox",name:"data.adsThirdparty",value:"data.adsThirdparty",onNewValue:"false"}}}),adsMedia:new Vocento.Row({field:{attr:{type:"hidden",name:"data.adsMedia."+n.ssoGroup,value:"data.adsMedia."+n.ssoGroup,onNewValue:"false"}}})},fieldsGroup:{registrationHiddenFields:["registration_ssoGroup","registration_service","registration_domain","registration_url","registration_browser","registration_nick","imported","registration_privacy_policy","legalterms_last_update","registration_city","registration_province","registration_municipality","legalterms","services"],province:["province"],adsFields:["adsGroup","adsMedia","adsThirdparty"]},screens:{}};o.screens[n.screenName.registration]=[{group:"registrationHiddenFields",lastRow:true},{group:"adsFields",elementId:"vocento-div-ads"}];o.screens[n.screenName.completeRegistration]=[{group:"registrationHiddenFields",lastRow:true},{group:"adsFields",elementId:"vocento-div-ads"}];o.screens[n.screenName.profile]=[{group:"adsFields",elementId:"vocento-div-ads"}];return o}function g(){return true}function m(){return{"profile.firstName":_requiredField,"profile.nickname":_requiredField,"profile.zip":_isZip,"profile.lastName":g}}function k(){var r=c.getMainEventListener();var s=f("div#"+n.idDivHtmlCustomBenefits);if(("undefined"!==typeof s)){s.append(n.htmlBenefits)}var t=c.getEventProductsOnReady();var q=f.Deferred();f.when(t,q).done(function(w,v){var x=c.getUserType();var u=true;if(("undefined"!==typeof x)&&(x)&&(("trial"===x)||("anonimo"===x))){u=false}if(true===u){c.showScreenSet({screenSet:n.screenSet.web.profile,mobileScreenSet:n.screenSet.mobile.profile,startScreen:n.screenName.updateLegalTerms})}});r.on("vocento.gigya.user.legaltermsOutOfDate",function(u){q.resolve(u)});var p=f.Deferred();f.when(t,p).done(function(v,u){var w=c.getUserType();var x=true;if(("undefined"!==typeof w)&&(w)&&(("trial"===w)||("anonimo"===w))){x=false}if(true===x){c.showScreenSet({screenSet:n.screenSet.web.profile,mobileScreenSet:n.screenSet.mobile.profile,startScreen:n.screenName.verifyNickname})}});r.on("vocento.gigya.user.duplicateNickname",function(u){p.resolve(u)});var o=f.Deferred();f.when(t,o).done(function(w,v){var x=c.getUserType();var u=true;if(("undefined"!==typeof x)&&(x)&&(("trial"===x)||("anonimo"===x))){u=false}if(true===u){c.showScreenSet({screenSet:n.screenSet.web.profile,mobileScreenSet:n.screenSet.mobile.profile,startScreen:n.screenName.verifyNickname})}});r.on("vocento.gigya.user.noNickname",function(u){o.resolve(u)});r.on("vocento.gigya.sso.servicesNotSaved",function(v){e("Defaults => Ejecutando acci?n de evento (vocento.gigya.sso.servicesNotSaved)");var u=v.gigya_event;if(("undefined"!==typeof v.service)&&(v.service)){c.setCurrentService(v.service)}c.checkService(u)})}function b(){var t=n.authServerVocCore+"/vocuser/v1/customer-service/device-and-platform";try{f.ajax({url:t,type:"POST",async:true,dataType:"json",success:function(u){n.device=u.result["device"];n.platform=u.result["platform"]},error:function(u){}})}catch(r){}var q=n.envVoccore.replace(".","-");var o="http://"+q+"catalogo.vocento.com/rest/site/siteid";var p=c.getNfrylCookie();if(("undefined"===typeof p)||(!p)||("/"===p)){p=window.location.href}if(("undefined"!==typeof p)&&(p)){if(p[p.length-1]==="/"){p=p.substring(0,p.length-1)}}var s={url:p};try{f.ajax({url:o,type:"POST",data:JSON.stringify(s),async:true,dataType:"json",success:function(u){n.siteId=u.result===""?n.siteId:u.result},error:function(u){}})}catch(r){}}function a(){return{onErrorHandler:function(o){},onBeforeScreenLoadHandler:function(o){},onAfterScreenLoadHandler:function(q){var o="";if(q.currentScreen===n.screenName.updateLegalTerms){f('form:visible input[name="data.legaltermsLastUpdate"]').val(n.legaltermsLastUpdate)}if(q.currentScreen===n.screenName.completeRegistration){if(n.saveGigyaCustomerServices){b()}if((typeof q.profile.email!=="undefined")&&(q.profile.email)&&(q.profile.email.search("@")>0)){o=f('form:visible input[name="profile.nickname"]');o.val(q.profile.email.split("@")[0]+"_"+new Date().getMilliseconds()+Math.floor((Math.random()*10)+1))}}if(q.currentScreen===n.screenName.profile){if(typeof q.profile.thumbnailURL!=="undefined"){f(".gigya-photo-upload-image").css("background-image","url("+q.profile.thumbnailURL+")");f(".gigya-attach-file-upload-form").css("cursor","default");f(".gigya-attach-file-upload-file-input").css("cursor","pointer")}}if(q.currentScreen===n.screenName.registration){if(n.saveGigyaCustomerServices){b()}o=f('form:visible input[name="profile.nickname"]');var p=f('form:visible input[name="email"]').val();o.val(p.split("@")[0]+"_"+new Date().getMilliseconds()+Math.floor((Math.random()*10)+1))}if(q.currentScreen===n.screenName.verifyNickname){f("#"+q.currentScreen).find(".gigya-user-name").text(typeof q.profile.firstName!=="undefined"&&q.profile.firstName?q.profile.firstName:q.profile.nickname)}c.registerUI();c.onScreenSubmitScrollToFirstError()},onFieldChangedHandler:function(u){var r=f("#"+u.form);if(("undefined"!==typeof r)&&(r)&&(r.length)){r=r.attr("class")}else{r=f("."+u.form).attr("class")}if(u.screen===n.screenName.registration){if(u.field==="email"&&u.value.search("@")>0){var s=f("form."+r+':visible input[name="profile.nickname"]');s.val(u.value.split("@")[0]+"_"+new Date().getMilliseconds()+Math.floor((Math.random()*10)+1))}}if(u.field==="profile.nickname"&&u.value){var w=false;w=simpleStorage.get("verifyUniqueNicknameFlushed");if(("undefined"===typeof w)||(true!==w)){var o=n.authServer+"/verify_unique_nickname.html?UID="+c.getUser().UID+"&nickname="+encodeURIComponent(u.value)+"&callback=?";f.getJSON(o,function(x){if(!x.isValid){f("form."+r+':visible input[name="profile.nickname"]').val(c.getUser().nickname);Vocento.customValidation.showError(f("form."+r+':visible input[name="profile.nickname"]'),f('[data-bound-to="profile.nickname"]'),'El nickname "'+u.value+'" pertenece a otro usuario')}else{var y={nickname:u.value};c.setAccountInfo({profile:y})}})}}if(u.field==="profile.zip"){var q=f("form."+r+':visible select[data-gigya-name="profile.country"]').val();if("undefined"===typeof q){if(("undefined"!==typeof u.value)&&("string"===typeof u.value)&&(u.value)){var v=/^\d{5}$/;var t=parseInt(u.value);var p=new RegExp(v);if((typeof u.value.match(p)!=="undefined")&&(u.value.match(p))&&(u.value.length===5)&&(((t>=1001)&&(t<=52006))||(t===52070)||(t===52071)||(t===52080))){q="Espa"+Vocento.UnicodeToChar("n")+"a"}}}if("undefined"!==typeof q){f.ajax({url:window.location.protocol+"//postalcodes.vocento.com/pcodes/v1/get",data:{filters:"ge_pais:"+q+",ge_codpostal:"+u.value,output:"ge_municipio:municipality,ge_provincia:province,ge_localidad:locality"},contentType:"application/json",dataType:"jsonp",success:function(y){if(y.status.toLowerCase()==="ok"&&y.results[0]){var x=y.results.length;f("form."+r+':visible [name="data.province"]').val(y.results[x-1].province);f("form."+r+':visible [name="profile.city"]').val((x>1)?y.results[x-1].municipality:y.results[x-1].locality);f("form."+r+':visible [name="data.municipality"]').val(y.results[x-1].municipality)}}})}}if(u.field==="data.adsGroup"){f("form."+r+':visible input[name="data.adsMedia.'+n.ssoGroup+'"]').val(f("form."+r+':visible input[name="data.adsGroup"]').is(":checked"))}c.showAllErrorsOnFieldTab();c.onScreenSubmitChangeSubmitButtonText(u)},onBeforeSubmitHandler:function(o){},onAfterSubmitHandler:function(o){if(typeof o.screen!=="undefined"){if(c.compareGigyaErrorCode(o.response.errorCode,0)){c.saveRegTokenOnRegister(o.response.regToken,o.screen);if("gigya-login-screen"===o.screen){if(c.getCustomerServiceFromCookieAndUpdateOptions()){c.sendCustomerService(n.serviceId,n.serviceReference)}c.removeSimpleStorage()}if(("gigya-login-screen"===o.screen)||("gigya-register-screen"===o.screen)||("gigya-complete-registration-screen"===o.screen)||("gigya-link-account-screen"===o.screen)){c.showLoadingSpinner()}}if(c.compareGigyaErrorCode(o.response.errorCode,"206001")){if("gigya-complete-registration-screen"===o.screen){c.showLoadingSpinner()}}}},onHideHandler:function(o){},onSocialLoginHandler:function(o){}}}return{getOptions:j,getInsertCustomField:d,getCustomValidationFields:m,setOptions:function(o){n=o;e=(n.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:a(),setProtectedFunctions:function(o){c=o;return this},execute:k,version:function(){return i}}};var Vocento=Vocento||{};Vocento.PpllFlow=function(e){var g="2.0";var l={};var d=function(){};var b={};var j=(Vocento.getContext)?Vocento.getContext:function(){};var f=null;function h(){return{hasPaywall:false,screenSet:{web:{auth:"Login-web-rediseno",profile:"Profile-web-rediseno"},mobile:{auth:"Login-mobile-rediseno",profile:"Profile-mobile-rediseno"}},screenName:{progressiveProfile:"gigya-progressive-profile-screen-1",updateProfile:"gigya-update-profile-screen"},parentDivClass:"vocento-gigya-parent-ppll"}}function c(){return{fields:{},fieldsGroup:{},screens:{}}}function k(){return{}}function i(){var m=b.getMainEventListener();var o=b.getEventProductsOnReady();var n=e.Deferred();e.when(n).done(function(s){var p=j();var r={};var q=b.getNfrylCookie();r.initLoginComplete={url:q,timestamp:p.timestamp};b.setAccountInfo({data:r})});e.when(o,n).done(function(q,p){if(true===l.progressiveProfile){var s=b.getUserType();var r=true;if(("undefined"!==typeof s)&&(s)&&(("trial"===s)||("anonimo"===s))){r=false}if(true===r){b.showScreenSet({screenSet:l.screenSet.web.profile,mobileScreenSet:l.screenSet.mobile.profile,startScreen:l.screenName.progressiveProfile})}}});m.on("vocento.gigya.user.firstLogin",function(p){n.resolve(p)});b.setMenuOnEvents()}function a(){return{onErrorHandler:function(m){},onBeforeScreenLoadHandler:function(m){if(m.nextScreen==="gigya-quick-thank-you-screen"){e("span.medioConcreto").text(Vocento.getMainDomain())}b.addModalClassToScreen("gigya-screen-dialog-inner","vocento-modal")},onAfterScreenLoadHandler:function(n){Vocento.screen.position("#navbar .navbar-inner","header");b.addParentDiv("gigya-screen-dialog","",l.parentDivClass);b.addParentDiv("gigya-screen-dialog-mobile","",l.parentDivClass);b.removeVoidElement(l.parentDivClass);Vocento.screen.scaleHeight(n.currentScreen);Vocento.screen.scaleWidth(n.currentScreen);if(n.currentScreen==="gigya-update-profile-screen"){gigya.socialize.showAddConnectionsUI({containerID:"gigya-add-connections-profile",width:140,height:25,showTermsLink:false,hideGigyaLink:true,showEditLink:false,enabledProviders:l.enabledProviders,requiredCapabilities:l.requiredCapabilities});var m=[{selector:"form:visible span.gigya-user-first-name",data:b.getUser().firstName},{selector:"form:visible span.gigya-user-last-name",data:b.getUser().lastName},{selector:"form:visible label.gigya-user-email",data:b.getUser().email}];e.each(m,function(o,p){e(p.selector).html(p.data)})}if(n.currentScreen==="gigya-update-profile-screen"){if(b.getAccount().loginProvider!=="site"){e("form:visible #vocento-div-change-password").hide()}}},onFieldChangedHandler:function(m){},onBeforeSubmitHandler:function(m){},onAfterSubmitHandler:function(m){},onHideHandler:function(m){},onSocialLoginHandler:function(m){}}}return{getOptions:h,getInsertCustomField:c,getCustomValidationFields:k,setOptions:function(m){l=m;d=(l.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:a(),setProtectedFunctions:function(m){b=m;return this},execute:i,version:function(){return g}}};Vocento.screen=Vocento.screen||{};if(!Vocento.screen.position){Vocento.screen.position=function(a,d){if(a&&$(a).length>0&&d&&$(d).length>0){var c=$(a).offset();if(typeof c!=="undefined"){c.top+=$(a).height();c.left=$(d).position().left;var b=$(".gigya-screen-dialog");b.css("top",c.top);b.css("left",c.left);b.css("z-index",$("#navbar").css("z-index")-1)}}}}if(!Vocento.screen.isStickyHeaderShown){Vocento.screen.isStickyHeaderShown=function(b){var a=false;var c=$(".is-sticky:visible");if(("undefined"!==typeof c)&&(c)&&(c.length)&&(0!==b)){a=true}return a}}if(!Vocento.screen.scaleScreenHeightWithoutSticky){Vocento.screen.scaleScreenHeightWithoutSticky=function(d,g){var k=false;var a=$("#layer_cookie_movil");var f=0;var i=$("#"+d+":visible");var b=i.parent().parent().parent();var e=$("header");if(("undefined"!==typeof e)&&(e)&&(e.length)){f=156;var j=$(".navbar");if(("undefined"!==typeof j)&&(j)&&(j.length)){f=j.position().top+j.height()-1}else{j=$(".bottom-header-line");if(("undefined"!==typeof j)&&(j)&&(j.length)){f=j.position().top+j.height()-1}}}if(("undefined"!==typeof a)&&(a)&&(a.length)){var h=a.css("display");if(("undefined"!==typeof h)&&(h)&&(h!=="none")){f=f+a.height()}}if((g>=1)&&(g<f)){f=f-g}b.css("top",f+"px");var c=$("body").height()-300;i.css("min-height","");i.css("height",c+"px");return k}}if(!Vocento.screen.scaleHeight){Vocento.screen.scaleHeight=function(e){var l=false;var k=$("#"+e+":visible");var a=k.parent().parent().parent();var h=$(window).scrollTop();var f=Vocento.screen.isStickyHeaderShown(h);if((true===f)&&("undefined"!==typeof k)&&(k)){var d="39";var i=$(".navbar-inner");if(("undefined"!==i)&&(i)&&(i.length)){d=i.height()-1}else{i=$(".bottom-header-line");if(("undefined"!==i)&&(i)&&(i.length)){d=i.height()-1}}a.css("top",d+"px");var c=$("body").height()-150;k.css("min-height","");k.css("height",c+"px");l=true}else{Vocento.screen.scaleScreenHeightWithoutSticky(e,h);l=true}var g=$(".gigya-screen-content:visible");if(("undefined"!==typeof g)&&(g)){g.css("min-height","")}var b=0;var j=0;$(window).scroll(function(){var n=$(this).scrollTop();if(j!==n){j=n;var m=$("#"+e+":visible");var o=m.parent().parent().parent();var p=Vocento.screen.isStickyHeaderShown(n);if((true===p)&&("undefined"!==typeof m)&&(m)){var r="39";var q=$(".navbar-inner");if(("undefined"!==q)&&(q)&&(q.length)){r=q.height()-1}else{q=$(".bottom-header-line");if(("undefined"!==q)&&(q)&&(q.length)){r=q.height()-1}}o.css("top",r+"px");var s=$("body").height()-150;m.css("min-height","");m.css("height",s+"px")}else{Vocento.screen.scaleScreenHeightWithoutSticky(e,n)}}else{}});return l}}if(!Vocento.screen.scaleWidth){Vocento.screen.scaleWidth=function(b){var a=false;return a}};var Vocento=Vocento||{};Vocento.TagManagerFlow=function(i){var g="3.0.10";var f={};var k=function(){};var x={};var m=(Vocento.getContext)?Vocento.getContext:function(){};var u=null;var r=false;var e="";var v="";var t="";var b="";var s="";var w="";function o(){var y=x.getCookieVocUserInformation("logTGM");if(("undefined"!==typeof y)){r=y}}function p(){return{gigyaLoginLinkTagManager:"a.gigya-login-link.vocuser-link:visible",gigyaRegisterLinkTagManager:"a.gigya-registration-link.vocuser-link:visible",gigyaForgotPasswordLinkTagManager:"a.gigya-recovery-link.vocuser-link:visible",gigyaBackLinkTagManager:"a.gigya-back-link.vocuser-link:visible",gigyaLogoLinkTagManager:"img.vocuser-headerppal-logo:visible",gigyaFooterLinksTagManager:"ul.vocuser-footer-listado:visible"}}function q(){return{fields:{},fieldsGroup:{},screens:{}}}function a(){}function j(y){if(s===""){s=y}else{if(s.indexOf(y)<0){s=s+","+y}}}function h(){if(("undefined"!==typeof TagManager)&&(TagManager)){TagManager.set({proceso:e,tipoRegistroLogin:t,funnel:v,procesoFinalizado:b,errorRechazo:s});TagManager.track();if(r){console.log(TagManager.get());console.log("Proceso:"+TagManager.get().proceso+" tipoRegistroLogin:"+TagManager.get().tipoRegistroLogin+" funnel:"+TagManager.get().funnel+" procesoFinalizado:"+TagManager.get().procesoFinalizado+" errorRechazo:"+TagManager.get().errorRechazo)}}}function c(){gigya.socialize.addEventHandlers({onLogin:function(y){if(y.provider!=="site"){w=y.provider;e="login-rrss";t="login-rrss-"+w;v="exito-login-"+w;b="si";h()}}})}function d(){i(document).on("click",f.gigyaLoginLinkTagManager,function(){b="no";j("click-login");h()});i(document).on("click",f.gigyaRegisterLinkTagManager,function(){b="no";j("click-registro");h()});i(document).on("click",f.gigyaForgotPasswordLinkTagManager,function(){b="no";j("click-recuperar-contrasena");h()});i(document).on("click",f.gigyaBackLinkTagManager,function(){b="no";j("abandono");h()});i(document).on("click",f.gigyaLogoLinkTagManager,function(){b="no";j("abandono");h()});i(f.gigyaFooterLinksTagManager).on("click","li",function(){var y=i(this).text();switch(y){case"Aviso legal":j("aviso-legal");break;case"Pol"+Vocento.UnicodeToChar("i")+"tica de privacidad":j("politica-privacidad");break;case"Pol"+Vocento.UnicodeToChar("i")+"tica de cookies":j("politica-cookies");break;case"Contacto":j("contacto");break;case"Web m"+Vocento.UnicodeToChar("o")+"vil":j("web-movil");break;default:j("click-footer");break}})}function l(){o();d();c()}function n(){return{onErrorHandler:function(y){},onBeforeScreenLoadHandler:function(y){if(window.location.pathname===f.route.registerURL){}if(y.nextScreen===f.screenName.confirmacion&&window.location.pathname===f.route.resendMailURL){}if(f.screenName.validacion===y.currentScreen){}if(y.nextScreen===f.screenName.reenviar&&window.location.pathname===f.route.loginURL){}if(y.nextScreen===f.screenName.enviado&&window.location.pathname===f.route.recoveryURL){}if(y.nextScreen===f.screenName.cambiado&&window.location.pathname===f.route.changePasswdURL){}if(y.nextScreen===f.screenName.actualizado&&window.location.pathname===f.route.profileURL){}},onAfterScreenLoadHandler:function(y){if(f.screenName.formulario===y.currentScreen){e="registro";t="registro";v="comienzo-registro";b="no";h()}if(f.screenName.confirmacion===y.currentScreen&&window.location.pathname===f.route.registerConfirmedURL){e="registro-estandar";t="registro-email";v="exito-registro-estandar";b="si";h()}if(f.screenName.expirado===y.currentScreen){e="registro-estandar";t="registro-email";v="pendiente-validacion-estandar";b="no";s="enlace-caducado";h()}if(f.screenName.autologin===y.currentScreen&&window.location.pathname===f.route.validateMailURL){e="registro-estandar";t="registro-email";v="exito-validacion-estandar";b="si";h()}if(f.screenName.validacion===y.currentScreen&&window.location.pathname===f.route.validateMailURL){e="registro-estandar";t="registro-email";v="exito-validacion-estandar";b="si";h()}if(f.screenName.login===y.currentScreen){e="login";t="login";v="comienzo-login";b="no";h()}if(f.screenName.reenviar===y.currentScreen&&window.location.pathname===f.route.resendMailURL){e="reenvio-validacion";t="registro-email";v="comienzo-reenvio-validacion-estandar";b="no"}if(f.screenName.recuperar===y.currentScreen){e="recuperar-contrasena";t="login-email";v="comienzo-solicitud-contrasena";b="no";h()}if(f.screenName.enviado===y.currentScreen&&window.location.pathname===f.route.sendedMailURL){e="recuperar-contrasena";t="login-email";v="exito-solicitud-contrasena";b="si";h()}if(f.screenName.resetear===y.currentScreen&&window.location.pathname===f.route.changePasswdURL){e="recuperar-contrasena";t="login-email";v="comienzo-cambio-contrasena";b="no";h()}if(f.screenName.cambiado===y.currentScreen&&window.location.pathname===f.route.passwdchangedURL){e="recuperar-contrasena";t="login-email";v="exito-cambio-contrasena";b="si";h()}if(f.screenName.completo===y.currentScreen){w=y.response.response.loginProvider;e="registro-rrss";t="registro-rrss-"+w;v="comienzo-primer-registro-"+w;b="no";h()}if(f.screenName.enlazar===y.currentScreen){w=y.response.response.requestParams.provider;e="registro-rrss";t="registro-rrss-"+w;v="comienzo-registro-ya-existe-"+w;b="no";h()}},onFieldChangedHandler:function(z){if(!z.isValid){var y="error-campo-"+z.field.toLowerCase();j(y)}},onBeforeSubmitHandler:function(B){var C={};if(f.screenName.recuperar===B.screen){e="recuperar-contrasena";t="login-email";v="pendiente-solicitud-contrasena";b="no";h()}if(f.screenName.resetear===B.screen){e="recuperar-contrasena";t="login-email";v="pendiente-cambio-contrasena";b="no";h()}if(f.screenName.reenviar===B.screen){var A=simpleStorage.get("user.regToken");C={};var y="";if(("undefined"!==typeof B.formData)&&(B.formData)&&("undefined"!==typeof B.formData.email)&&(B.formData.email)){y=B.formData.email}var z=simpleStorage.get("user.email");if(("undefined"!==typeof y)&&("undefined"!==typeof z)&&(y===z)){e="reenvio-validacion";t="registro-email";v="exito-reenvio-validacion-estandar";b="si";h()}else{j("mail-no-corresponde")}}},onAfterSubmitHandler:function(y){if((y.screen===f.screenName.completo)&&(x.compareGigyaErrorCode(y.response.errorCode,0))){e="registro-rrss";t="registro-rrss-"+w;v="exito-primer-registro-"+w;b="si";h();if(("undefined"!==typeof y.response)&&("undefined"!==typeof y.response.loginProvider)){if("site"===y.response.loginProvider){}}}if((y.screen===f.screenName.enlazar)&&(x.compareGigyaErrorCode(y.response.errorCode,0))){e="registro-rrss";t="registro-rrss-"+w;v="exito-registro-ya-existe-"+w;b="si";h()}if(y.screen===f.screenName.login){if(x.compareGigyaErrorCode(y.response.errorCode,"403005")){j("usuario-o-contrasena-incorrectos")}if(x.compareGigyaErrorCode(y.response.errorCode,"206002")){e="reenvio-validacion";t="registro-email";v="comienzo-reenvio-validacion-estandar";b="no";h()}if(x.compareGigyaErrorCode(y.response.errorCode,0)){e="login-estandar";t="login-email";v="exito-login-estandar";b="si";h()}}if(f.screenName.recuperar===y.screen){}if((y.screen===f.screenName.enlazar)&&(x.compareGigyaErrorCode(y.response.errorCode,0))){}if((y.screen===f.screenName.validacion)&&((y.response.errorCode)||(x.compareGigyaErrorCode(y.response.errorCode,"206002")))){}if((f.screenName.perfil===y.screen||f.screenName.cambiar===y.screen)&&(x.compareGigyaErrorCode(y.response.errorCode,0))){}if((f.screenName.intereses===y.screen)&&(x.compareGigyaErrorCode(y.response.errorCode,0))){}},onHideHandler:function(y){},onSocialLoginHandler:function(y){}}}return{getOptions:p,getInsertCustomField:q,getCustomValidationFields:a,setOptions:function(y){f=y;k=(f.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:n(),setProtectedFunctions:function(y){x=y;return this},execute:l,version:function(){return g}}};var Vocento=Vocento||{};Vocento.AutosubscribeFlow=function(g){var e="3.0.6";var b={};var i=function(){};var x={};var k=(Vocento.getContext)?Vocento.getContext:function(){};var q=null;var s="vocuser_autosuscripcion_newsletters";function m(){return{}}function n(){return{}}function w(z){var y=false;if(("undefined"===typeof g.cookie(z))||(null===g.cookie(z))){y=true}return y}function v(A){var y=false;if(("undefined"!==typeof A)&&(A)&&("string"===typeof A)){var z=document.createElement("a");z.href=A;y=z.hostname}return y}function p(A){var y=false;if(("undefined"!==typeof A)&&(A)&&("string"===typeof A)){var z=v(A);if(("undefined"!==typeof z)&&(z)&&("string"===typeof z)){var B=/([a-z\-0-9]{2,63})\.([a-z\.]{2,5})$/;var E=new RegExp(B);var D=z.match(E);if(("undefined"!==typeof D)&&(D)&&("object"===typeof D)&&(D[1])&&(D[2])){var C="."+D[1]+"."+D[2];y=z.replace(C,"")}}}return y}function u(z,A){var y=false;if(("undefined"!==typeof z)&&(z)&&("string"===typeof z)&&("undefined"!==typeof A)&&(A)&&("object"===typeof A)){if(("undefined"!==typeof A[z])&&(A[z])&&("object"===typeof A[z])&&("undefined"!==typeof A[z].hasAutomaticNewsletters)&&(A[z].hasAutomaticNewsletters)&&("boolean"===typeof A[z].hasAutomaticNewsletters)){y=A[z].hasAutomaticNewsletters}}return y}function d(z,E,D){var y=false;var A='{ "UID": "';var C='", ';var B="}";if(("undefined"===typeof D)||(!D)){D=false}if(("undefined"!==typeof z)&&(z)&&("string"===typeof z)&&("undefined"!==typeof E)&&(E)&&("string"===typeof E)){y=A+z+C+E+B}if(D){return y}return JSON.parse(y)}function f(z){var H=false;var E='"keys_query_string": [';var G="]";var F='{ "key": "';var y='"}';var A="";var C="";if(("undefined"!==typeof z)&&(z)&&("object"===typeof z)&&(Object.keys(z).length>0)){var D=Object.keys(z).length;for(var B=0;B<D;B++){A+=F+(z[B]).trim()+y+","}A=A.slice(0,-1);C=E+A+G;H=C}return H}function r(z){var y=false;if(("undefined"!==typeof z)&&(z)){y=z.split(",")}return y}function c(A,z){var y=false;if(("undefined"!==typeof z)&&(z)&&("object"===typeof z)&&(Object.keys(z).length>0)){if(("undefined"!==typeof z[A])&&(z[A])&&("object"===typeof z[A])&&(Object.keys(z[A]).length>=1)&&(z[A])){y=z[A]}}return y}function h(A,C,z){var y=false;var E="";var D="";var B="";y=c(C,z);E=r(y.query_string);D=f(E);B=d(A,D);x.newslettersAutosuscribe(B)}function t(y){x.createCookieAutoNewsletters(y)}function o(){x.removeAutoNewslettersCookie()}function a(){return{}}function j(){}function l(){return{onErrorHandler:function(y){},onBeforeScreenLoadHandler:function(y){},onAfterScreenLoadHandler:function(B){var y=B.currentScreen;var C=x.getNfrylCookie();var A=p(C);if(y==="gigya-thank-you-screen"){if((u(A,b.autosubscribeConfig))&&(!w(s))){var z=x.getCookieAutoNewsletters();h(z,A,b.autosubscribeConfig);o()}if(!w(s)){o()}}},onFieldChangedHandler:function(y){},onBeforeSubmitHandler:function(y){},onAfterSubmitHandler:function(z){var A=x.getNfrylCookie();var y=p(A);if((z.screen==="gigya-register-screen")&&(x.compareGigyaErrorCode(z.response.errorCode,"206002"))){if(u(y,b.autosubscribeConfig)){t(z.response.UID)}}if((z.screen==="gigya-complete-registration-screen")&&(x.compareGigyaErrorCode(z.response.errorCode,0))){if(u(y,b.autosubscribeConfig)){if(("undefined"!==typeof z.response)&&(z.response)&&("undefined"!==typeof z.response.UID)&&(z.response)&&("string"===typeof z.response.UID)){h(z.response.UID,y,b.autosubscribeConfig)}}if(!w(s)){o()}}},onHideHandler:function(y){},onSocialLoginHandler:function(y){}}}return{getOptions:m,getInsertCustomField:n,getCustomValidationFields:a,setOptions:function(y){b=y;i=(b.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:l(),setProtectedFunctions:function(y){x=y;return this},execute:j,version:function(){return e}}};var Vocento=Vocento||{};Vocento.NewslettersFlow=function(g){var f="3.0.6";var e={};var d={};var D={};var w={};var j;var B;var z;var i;var s={};var r="NL_escaparate";var t="vocuser_arealibre_newsletters";var k=function(){};var F={};var m=(Vocento.getContext)?Vocento.getContext:function(){};var y=null;function p(){return{}}function q(){return{fields:{},fieldsGroup:{myFields:[]},screens:{}}}function a(){return{}}function A(){}function x(){var G=false;var I=g.cookie(t);if(("undefined"!==typeof I)&&(I)){try{G=decodeURIComponent(I)}catch(H){k("Error en getNewslettersCookie() al decodificar la cookie: "+H,"error");I=g.cookie(t);if(("undefined"!==typeof I)&&(I)){G=decodeURIComponent(I)}}}if(("undefined"===typeof G)||(!G)){return false}return decodeURIComponent(G)}function h(I){I=false||I;var H=false;if(("undefined"!==typeof I)&&(I)){H=I}else{H="UID=|newsletters=ciencia_0063"}var L="."+Vocento.getMainDomain();var K=1;var J=encodeURIComponent(H);var G={domain:L,path:"/",expires:K};F.createCookie(t,J,G,true)}function E(J,K){J=false||J;K=false||K;var I="";var M="";var G=[];var H=false;var L=x();if(false!==L){H=L.split("|");if(("object"===typeof H)&&(H[0])&&(H[1])){M=H[0].replace("UID=","");I=H[1].replace("newsletters=","").split("*");if((""===M)&&(""===I)){return false}if((""===M)&&(false===J)&&(false===K)){return I}else{if((""===M)&&(false===J)&&(K)){return H[1].replace("newsletters=","")}}if(("object"===typeof I)&&(""!==M)&&(J)&&(false===K)){G.UID=M;G.newsletters=I;return G}else{if(("object"===typeof I)&&(false!==M)&&(J)&&("UIDOnly"===K)){return M}else{if(("object"===typeof I)&&(""!==M)&&(J)&&(K)){return H[0].replace("UID=","")+"|"+H[1].replace("newsletters=","")}}}}else{if(false===H){return H}}if("object"===typeof I){return I}if(""===I||false===I){return false}}else{return L}}function b(G,I){G=false||G;I=false||I;var J="UID=";var H="newsletters=";if(G){J+=G}if(I){H+=I}return J+"|"+H}function c(){var I=false||[];var G=E();if(("object"===typeof G)&&(G)&&(G.length>0)){for(var H=0;H<G.length;H++){I.push(G[H])}}else{return false}return I}function v(J,I,M,K){var H=false;var G="RT1_stD9hM~02045353544b0736323837313731010000~8ALEWJHhtPWjLuk_LHJp7jHGLYzvXEiZ8Z2xvHKxdW8wwNdHHVJd350IUiiZwx4naHxriwiT-BIpVzu0vvfS2enZ0tekS3TdIjpdY00a-1wX89WC5OyoVikmdpi_nA47ZZJjKUOvdDMYCL1tIy6TNsAOwWr3zYfdhmLlmZ-u_AYR58QojhUEiYWAUaYpbhYG1WdVLRQM-XrKyPzKwFyi8bhOSYT3H0RcExdjsMA2o_0JfQpwe7R2QGqdXdch3g5LokCnXofba7zNZTRa__IEAyVaHXI1cYJk5rGcS9cfIHYfztrlH5bNW6uFq-q94ia5L8HTVO2OVuAIsM9LQqisSLj5tzACjXhUzTQAZu__J5ur-J_qv8_jNTERkDMVdK4RuVA_lZWgsbhXrXV00wKBkxGozpIuDJLTB8IEOnsG1UyeTn80lqTFffe_79a9knGMVBIOR8RQpqkcqorTTJnVrngNi_xCnipfea4PZYW58devExDx2f6er76epLNXYi5Ct59Z~";if(("undefined"!==typeof J)&&(J)&&("undefined"!==typeof I)&&(I)&&("undefined"!==typeof M)&&(M)&&("undefined"!==typeof K)&&(K)){var L={UID:J,UIDSignature:I,signatureTimestamp:M,registrationToken:G,NL_ID:K};g.ajax({url:e.authServerVocCore+"/vocuser/v1/user/newsletters/subscribe/freezone",type:"POST",dataType:"json",data:L,success:C});H=true}return H}function C(G){if(typeof G==="object"){}else{}}function o(H,K,I){var G=false;if(("undefined"!==typeof H)&&(H)&&("undefined"!==typeof K)&&(K)&&("undefined"!==typeof I)&&(I)){var J={UID:H,registrationToken:K,NL_ID:I};g.ajax({url:e.authServerVocCore+"/vocuser/v1/user/newsletters/subscribe/freezone",type:"POST",dataType:"json",data:J,success:u});G=true}return G}function u(G){if(typeof G==="object"){}else{}}function l(){var G=F.getMainEventListener();G.on("vocento.gigya.accounts.onDataNoReady",function(H){});G.on("vocento.gigya.accounts.onDataReady",function(I){var J=false;var H=I.gigya_event;d=H.profile;D=H.data;if(F.compareGigyaErrorCode(H.errorCode,0)){J=(H.UID&&H.UID!=="")}if(J){if(true===F.checkUserFlowUrlsContains("areapersonal",window.location.href)){F.addService(r,I.gigya_event)}}else{}})}function n(){return{onErrorHandler:function(G){},onBeforeScreenLoadHandler:function(G){},onAfterScreenLoadHandler:function(H){if("gigya-thank-you-screen"===H.currentScreen){s=c();if(false!==s){j=E(true,"UIDOnly");var G="RT1_stD9hM~02045353544b0736323837313731010000~8ALEWJHhtPWjLuk_LHJp7jHGLYzvXEiZ8Z2xvHKxdW8wwNdHHVJd350IUiiZwx4naHxriwiT-BIpVzu0vvfS2enZ0tekS3TdIjpdY00a-1wX89WC5OyoVikmdpi_nA47ZZJjKUOvdDMYCL1tIy6TNsAOwWr3zYfdhmLlmZ-u_AYR58QojhUEiYWAUaYpbhYG1WdVLRQM-XrKyPzKwFyi8bhOSYT3H0RcExdjsMA2o_0JfQpwe7R2QGqdXdch3g5LokCnXofba7zNZTRa__IEAyVaHXI1cYJk5rGcS9cfIHYfztrlH5bNW6uFq-q94ia5L8HTVO2OVuAIsM9LQqisSLj5tzACjXhUzTQAZu__J5ur-J_qv8_jNTERkDMVdK4RuVA_lZWgsbhXrXV00wKBkxGozpIuDJLTB8IEOnsG1UyeTn80lqTFffe_79a9knGMVBIOR8RQpqkcqorTTJnVrngNi_xCnipfea4PZYW58devExDx2f6er76epLNXYi5Ct59Z~";o(j,G,s)}}},onFieldChangedHandler:function(G){},onBeforeSubmitHandler:function(G){},onAfterSubmitHandler:function(H){s=c();j=E(true,"UIDOnly");if(false!==s){var G="";var J="";if((""===j)&&("undefined"!==typeof H.response.UID)&&(H.response.UID)){j=H.response.UID}if(("undefined"!==typeof H.response.UIDSignature)&&(H.response.UIDSignature)){B=H.response.UIDSignature}if(("undefined"!==typeof H.response.signatureTimestamp)&&(H.response.UIDSignature)){z=H.response.signatureTimestamp}if(H.screen==="gigya-login-screen"&&(F.compareGigyaErrorCode(H.response.errorCode,0)||F.compareGigyaErrorCode(H.response.errorCode,"206002"))){var I=((j!==""&&B!==""&&z!=="")&&(j!==undefined&&B!==undefined&&z!==undefined));if(I){v(j,B,z,s);G=E(false,true);J=b(j,G);h(J);if(true===F.checkUserFlowUrlsContains("areapersonal",window.location.href)){F.addService(r,H)}}}if((H.screen==="gigya-login-screen")&&(F.compareGigyaErrorCode(H.response.errorCode,"206001"))){if(j!==""){G=E(false,true);J=b(j,G);h(J)}}if((H.screen==="gigya-register-screen")&&((F.compareGigyaErrorCode(H.response.errorCode,0))||(F.compareGigyaErrorCode(H.response.errorCode,"206002")))){if(j!==""){G=E(false,true);J=b(j,G);h(J)}}if((H.screen==="gigya-complete-registration-screen")&&(F.compareGigyaErrorCode(H.response.errorCode,0))){v(j,B,z,s);G=E(false,true);J=b(j,G);h(J);if(true===F.checkUserFlowUrlsContains("areapersonal",window.location.href)){F.addService(r,H)}}if((H.screen==="gigya-link-account-screen")&&(F.compareGigyaErrorCode(H.response.errorCode,0))){v(j,B,z,s);G=E(false,true);J=b(j,G);h(J);if(true===F.checkUserFlowUrlsContains("areapersonal",window.location.href)){F.addService(r,H)}}}},onHideHandler:function(G){},onSocialLoginHandler:function(G){}}}return{getOptions:p,getInsertCustomField:q,getCustomValidationFields:a,setOptions:function(G){e=G;k=(e.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:n(),setProtectedFunctions:function(G){F=G;return this},execute:l,version:function(){return f},init:A}};var Vocento=Vocento||{};Vocento.NfrylFlow=function(f){var e="3.0.6";var d={};var i=function(){};var y={};var k=(Vocento.getContext)?Vocento.getContext:function(){};var r=null;var v="vocuser_nfryl_volver_al_origen";var b="vocuser_user_email";function m(){var D="/personalizacion/perfil/perfil.html";var C="/personalizacion/perfil/intereses.html";var B="/personalizacion/perfil/cambiar-clave.html";var A="/personalizacion/perfil/actualizado.html";if((window.location.host.indexOf("abc")===-1)&&(window.location.host.indexOf("lavozdigital")===-1)){D="/perfil/perfil.html";C="/perfil/intereses.html";B="/perfil/cambiar-clave.html";A="/perfil/actualizado.html"}return{currentRoute:false,containerID:"vocento-vocuser-screen-container",screenSet:{web:{auth:"ScreensetUnificado-RegistrationLogin",profile:"ScreensetUnificado-ProfileUpdate"},mobile:{auth:"ScreensetUnificado-RegistrationLogin",profile:"ScreensetUnificado-ProfileUpdate"}},screenName:{login:"gigya-login-screen",additionalData:"gigya-login-additional-data-screen",formulario:"gigya-register-screen",confirmacion:"gigya-thank-you-screen",reenviar:"gigya-email-verification-screen",reenviado:"gigya-thank-you-screen",completo:"gigya-complete-registration-screen",validacion:"gigya-quick-thank-you-screen",recuperar:"gigya-forgot-password-screen",enviado:"gigya-forgot-password-success-screen",resetear:"gigya-reset-password-screen",cambiado:"gigya-reset-password-success-screen",perfil:"gigya-update-profile-screen",intereses:"gigya-update-profile-screen-3",cambiar:"gigya-change-password-screen",actualizado:"gigya-update-thanks-screen",enlazar:"gigya-link-account-screen",expirado:"gigya-register-link-expired-screen",unexist:"gigya-account-doesnt-exists-screen",reserved:"gigya-account-reserved-screen",autologin:"gigya-autologin-redirect-screen"},route:{loginURL:"/login/login.html",loginAdditionalDataURL:"/login/datos-adicionales.html",registerURL:"/registro/formulario.html",registerConfirmedURL:"/registro/confirmacion.html",resendMailURL:"/registro/reenviar-mail.html",mailSendedURL:"/registro/mail-enviado.html",validateMailURL:"/registro/validacion-mail.html",recoveryURL:"/clave/recuperar.html",sendedMailURL:"/clave/mail-enviado.html",changePasswdURL:"/clave/cambiar.html",passwdchangedURL:"/clave/cambiada.html",profileURL:D,interestURL:C,changePasswdProfileURL:B,profileUpdatedURL:A}}}function n(){return{fields:{},fieldsGroup:{},screens:{}}}function a(){}function t(B,E,A){var C=d.screenSet.web.auth;var D=d.screenSet.mobile.auth;if(("undefined"!==typeof E)&&(E)){C=E}if(("undefined"!==typeof A)&&(A)){D=A}y.showScreenSet({screenSet:C,mobileScreenSet:D,startScreen:B,containerID:d.containerID});return false}function w(){y.hideScreenSet({screenSet:d.screenSet.web.auth,containerID:d.containerID});return false}function p(A){var C=window.location.search.substring(1);var D=C.split("&");for(var B=0;B<D.length;B++){var E=D[B].split("=");if(decodeURIComponent(E[0])===A){return decodeURIComponent(E[1])}}}function s(E,C,F){if(("undefined"!==typeof E)&&(E)){var D=f(E);var B="";if(("undefined"!==typeof D)&&(D)&&(D.length)){B=D.attr("data-display-name")||"";F=F||"El campo %name% no es v&aacute;lido";var A=D.parents("form:visible").find("input[type=submit]");if(typeof A.data("originalValue")==="undefined"){A.data("originalValue",A.val())}A.val("Corrige los errores");D.addClass("gigya-error")}if(("undefined"!==typeof C)&&(C)){f(C).addClass("gigya-error-msg gigya-error-msg-active");f(C).html(F.replace("%name%",B));f(C).show()}}return false}function z(F,H){if(("undefined"!==typeof F)&&(F)){var E=f(F);var I="";if(("undefined"!==typeof E)&&(E)&&(E.length)){var A=E.attr("data-display-name")||"";H=H||"El campo %name% no es v&aacute;lido";I=E.parents("form:visible");var B=I.find("input[type=submit]");if(typeof B.data("originalValue")==="undefined"){B.data("originalValue",B.val())}B.val("Corrige los errores");if(("undefined"!==typeof E.offset)&&(E.offset())&&("undefined"!==typeof E.offset().top)){var D=f("#header");var C=0;if(("undefined"!==typeof D.offset)&&(D.offset())&&("undefined"!==typeof D.offset().top)){C=D.offset().top}f("html, body").animate({scrollTop:E.offset().top-C-1},200)}E.addClass("gigya-error")}if(I){var G=I.find("#vocuser-custom-error");G.addClass("gigya-error-msg-active");G.html(H);f(".gigya-error-display").show()}}return false}function c(D){D=typeof D!=="undefined"?D:".gigya-error-display";var C=f(D);if(("undefined"!==typeof C.offset)&&(C.offset())&&("undefined"!==typeof C.offset().top)){var B=f("#header");var A=0;if(("undefined"!==typeof B.offset)&&(B.offset())&&("undefined"!==typeof B.offset().top)){A=B.offset().top}f("html, body").animate({scrollTop:C.offset().top-A-1},200)}}function h(A){var B={};if(A.loginID){B={callback:u,loginID:A.loginID}}if(A.passwordResetToken&&A.newPassword){B={callback:u,passwordResetToken:A.passwordResetToken,newPassword:A.newPassword}}y.resetPassword(B)}function u(A){if(y.compareGigyaErrorCode(A.errorCode,0)){if((A.requestParams.passwordResetToken)&&(A.requestParams.newPassword)){window.location.href=y.getUrlPasswordChangedScreen();return false}if(A.requestParams.loginID){window.location.href=y.getUrlPasswdSendScreen();return false}}else{if(y.compareGigyaErrorCode(A.errorCode,"400006")){z(y.findFieldInScreenByName("passwordResetToken",d.screenName.resetear),"El enlace para cambiar la password ha caducado! por favor, vuelve a solicitar nuevamente el reseteo de tu password, para recibir un nuevo enlace");return false}if(y.compareGigyaErrorCode(A.errorCode,"403047")){z(y.findFieldInScreenByName("username",d.screenName.recuperar),"No existe ning&uacute;n usuario con ese nombre o correo electr&oacute;nico");return false}}}function q(C,B){var A=false;if(("undefined"!==typeof C&&C)&&("undefined"!==typeof C.formData&&C.formData)&&("undefined"!==typeof C.formData["data.registration.url"]&&C.formData["data.registration.url"])){C.formData["data.registration.url"]=B;A=C}return A}function x(B){var A=false;if(("undefined"!==typeof B)&&(B)){var C=f("#"+B+" .vocuser-iconsfonts-eye");if(("undefined"!==typeof C)&&(C)&&(C.length)){C.on("click",function(){var D=f(this);if(D.hasClass("vocuser-iconsfonts-eye2")){D.removeClass("vocuser-iconsfonts-eye2");D.parents(".input-group").find("[type=text]").attr("type","password")}else{D.addClass("vocuser-iconsfonts-eye2");D.parents(".input-group").find("[type=password]").attr("type","text")}});A=true}}return A}function o(B){var A=false;if(("undefined"!==typeof B.data)&&(B.data)&&("undefined"!==typeof B.data.registration)&&(B.data.registration)&&("undefined"!==typeof B.data.registration.url)&&(B.data.registration.url)){A=B.data.registration.url}return A}function j(){var C=y.getMainEventListener();d.backURL=y.getNfrylCookie();var D="";var B=false;D=d.page.loginPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.login)}D=d.page.loginAdditionalDataPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;if(d.showAdditionalDataPage){t(d.screenName.additionalData)}}D=d.page.registerPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.formulario)}D=d.page.registerConfirmedPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.confirmacion)}D=d.page.resendMailPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.reenviar)}D=d.page.mailSendedPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.reenviado)}D=d.page.validateMailPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;var E=p("errorCode");if(("undefined"!==typeof E)&&(E)){if("0"===E){t(d.screenName.validacion)}if("403002"===E.substring(0,6)){t(d.screenName.expirado)}if("404000"===E.substring(0,6)){t(d.screenName.unexist)}if("400010"===E.substring(0,6)){t(d.screenName.reserved)}}else{t(d.screenName.validacion)}if("206005"===E.substring(0,6)){t(d.screenName.autologin)}}D=d.page.recoveryPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.recuperar)}D=d.page.sendedMailPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.enviado)}D=d.page.changePasswdPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.resetear)}D=d.page.passwdchangedPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.cambiado)}D=d.page.profilePage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.perfil,d.screenSet.web.profile,d.screenSet.mobile.profile)}D=d.page.interestPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.intereses,d.screenSet.web.profile,d.screenSet.mobile.profile)}D=d.page.changePasswdProfilePage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.cambiar,d.screenSet.web.profile,d.screenSet.mobile.profile)}D=d.page.profileUpdatedPage;B=new RegExp(D+"$").test(window.location.pathname);if(true===B){d.currentRoute=true;t(d.screenName.actualizado,d.screenSet.web.profile,d.screenSet.mobile.profile)}if(false===d.currentRoute){y.createCookieForNfryl(window.location.href);var A=y.getCookieVocUserInformation("customerService");if((""!==A)||("undefined"!==A)){y.updateFieldInCookieVocUser("customerService","",true)}}}function g(){var A=y.getUrlProfileScreen();y.redirectToUrl(A,0)}function l(){return{onErrorHandler:function(A){},onBeforeScreenLoadHandler:function(A){if(A.nextScreen===d.screenName.confirmacion&&window.location.pathname===d.route.registerURL){return false}if(A.nextScreen===d.screenName.reenviar&&window.location.pathname===d.route.loginURL){return false}if(A.nextScreen===d.screenName.enviado&&window.location.pathname===d.route.recoveryURL){return false}if(A.nextScreen===d.screenName.cambiado&&window.location.pathname===d.route.changePasswdURL){return false}if(A.nextScreen===d.screenName.actualizado&&window.location.pathname===d.route.profileURL){return false}},onAfterScreenLoadHandler:function(G){var L="";var H="";var B="";if(d.screenName.resetear===G.currentScreen){var E=p("pwrt");y.findFieldInScreen("passwordResetToken",G).val(E)}if(d.screenName.formulario===G.currentScreen||d.screenName.completo===G.currentScreen){H=y.getNfrylCookie();L=y.findFieldInScreen("data.registration.url",G);if(false!==L){L.val(H)}B=y.findFieldInScreen("data.registration.domain",G);if(false!==B){var A=y.getSubDomainDomainTldFromUrl(H);if(A){B.val(A);B.attr("data-original-value",A)}}var F=y.getCookieVocUserInformation("returnUrl");L=y.findFieldInScreen("data.registration.returnUrl",G);if(false!==L){L.val(F)}if(d.screenName.formulario===G.currentScreen){x(G.currentScreen)}}if(d.screenName.login===G.currentScreen){x(G.currentScreen)}if(d.screenName.resetear===G.currentScreen){x(G.currentScreen)}if(d.screenName.enlazar===G.currentScreen){x(G.currentScreen)}if(d.screenName.confirmacion===G.currentScreen){var I=f("#vocuser-gigya-thank-you-screen-email-placeholder");var J=y.getCookieVocUserTemporal();y.removeCookieVocUserTemporal();if(("undefined"!==typeof I)&&(I)&&(I.length)&&(J)){I.html(J)}}if(d.screenName.enviado===G.currentScreen){var D=y.findFieldInScreen("vocuser-gigya-forgot-password-success-screen-email-placeholder",G);if(("undefined"!==typeof D)&&(D)&&(D.length)){var K=simpleStorage.get("profile.loginID");D.html(K)}}if(d.screenName.actualizado===G.currentScreen){var C=f("#vocuser-input-btn-gigya-update-thanks-screen");if(("undefined"!==typeof C)&&(C)&&(C.length)){y.bindOnClickEventToDomElement(C,g)}}},onFieldChangedHandler:function(A){},onBeforeSubmitHandler:function(D){var E={};if(d.screenName.resetear===D.screen){E={};E.passwordResetToken=y.findFieldInScreen("passwordResetToken",D).val();E.newPassword=y.findFieldInScreen("newPassword",D).val();h(E);return false}if(d.screenName.reenviar===D.screen){var C=simpleStorage.get("user.regToken");E={};var A="";if(("undefined"!==typeof D.formData)&&(D.formData)&&("undefined"!==typeof D.formData.email)&&(D.formData.email)){A=D.formData.email}var B=simpleStorage.get("user.email");if(("undefined"!==typeof A)&&("undefined"!==typeof B)&&(A===B)){E.regToken=C;y.resendVerificationCode(E);w();if((null===f.cookie(b))||("undefined"===typeof f.cookie(b))){y.createCookieVocUserTemporal(A)}window.location.href=y.getUrlRegisterConfirmationScreen();return false}else{s("#"+D.screen+' input[name="email"]',"#"+D.screen+' span[data-bound-to="email"]',"El correo electr&oacute;nico ingresado no es correcto");return false}}if(d.screenName.recuperar===D.screen){simpleStorage.set("profile.loginID",D.formData.loginID,{TTL:300000});E={};E.loginID=D.formData.loginID;h(E);return false}},onAfterSubmitHandler:function(E){if(E.screen===d.screenName.formulario){if((y.compareGigyaErrorCode(E.response.errorCode,0))||(y.compareGigyaErrorCode(E.response.errorCode,"206002"))){w();if(("undefined"!==typeof E.form)&&(E.form)&&("div.gigya-social-login"===E.form)){d.backURL=y.getNfrylCookie();if("undefined"!==typeof d.backURL&&d.backURL&&!d.showAdditionalDataPage){y.removeNfrylCookie()}w();y.redirectToBackUrl(0);return false}if((null===f.cookie(b))||("undefined"===typeof f.cookie(b))){y.createCookieVocUserTemporal(E.profile.email)}d.backURL=y.getUrlRegisterConfirmationScreen();y.redirectToBackUrl(0);return false}if((("undefined"!==typeof E.form)&&(E.form)&&("div.gigya-social-login"===E.form))&&(y.compareGigyaErrorCode(E.response.errorCode,"403005"))){if(y.getCustomerServiceFromCookieAndUpdateOptions()){y.sendCustomerService(d.serviceId,d.serviceReference)}y.saveRegTokenOnRegister(E.response.regToken,E.screen);y.removeSimpleStorage();if(d.showAdditionalDataPage&&!y.checkAdditionalDataFilled(E)){y.setButtonMessage(false,false,false,"Redirigiendo a Completar Datos");window.location.href=y.getUrlAdditionalDataScreen()}else{y.redirectToBackUrl(1);return false}}}if((E.screen===d.screenName.completo)&&(y.compareGigyaErrorCode(E.response.errorCode,0))){y.setButtonMessage(false,false,false,"Confirmaci"+Vocento.UnicodeToChar("o")+"n correcta");d.backURL=y.getNfrylCookie();if("undefined"!==typeof d.backURL&&d.backURL&&!d.showAdditionalDataPage){y.removeNfrylCookie()}y.setButtonMessage(false,false,false,"Redirigiendo a la web");if(("undefined"!==typeof E.response)&&("undefined"!==typeof E.response.loginProvider)){if("site"===E.response.loginProvider){y.redirectToBackUrl(0)}}return false}if(E.screen===d.screenName.login){if(y.compareGigyaErrorCode(E.response.errorCode,"403005")){y.setButtonMessage();c()}if(y.compareGigyaErrorCode(E.response.errorCode,"206002")){simpleStorage.set("user.email",E.profile.email,{TTL:300000});simpleStorage.set("user.regToken",E.response.regToken,{TTL:300000});w();d.backURL=y.getUrlRegisterPendingConfirmationScreen();y.redirectToBackUrl(0);return false}if(y.compareGigyaErrorCode(E.response.errorCode,0)){y.setButtonMessage(false,false,false,"Validaci"+Vocento.UnicodeToChar("o")+"n correcta");d.backURL="";var A=y.isFirstLogin(E);if(A){d.backURL=o(E.response)}else{d.backURL=y.getNfrylCookie()}if("undefined"!==typeof d.backURL&&(d.backURL)){if(!A&&!d.showAdditionalDataPage){y.removeNfrylCookie()}}if(A||y.checkAdditionalDataFilled(E)){d.showAdditionalDataPage=false}if(d.showAdditionalDataPage&&!y.checkAdditionalDataFilled(E)){y.setButtonMessage(false,false,false,"Redirigiendo a Completar Datos");y.redirectToUrl(y.getUrlAdditionalDataScreen())}y.setButtonMessage(false,false,false,"Redirigiendo a la web")}}if((E.screen===d.screenName.additionalData)&&(y.compareGigyaErrorCode(E.response.errorCode,0))){y.showLoadingSpinner();y.setButtonMessage(false,false,false,"Redirigiendo a la web");w();var B={};if(("undefined"!==typeof E.data)&&(E.data)&&("undefined"!==typeof E.data.additionalDataFilled)&&(E.data.additionalDataFilled)&&(E.data.additionalDataFilled.length>0)){B=E.data.additionalDataFilled}var D={};D.additionalDataFilled=y.setAdditionalDataStructure(B);var C=y.setAccountInfo({data:D});d.backURL=y.getNfrylCookie();if("undefined"!==typeof d.backURL&&(d.backURL)){if(!y.isFirstLogin(E)&&!d.showAdditionalDataPage){y.removeNfrylCookie()}}d.showAdditionalDataPage=false;C.then(function(F){y.redirectToBackUrl(0)});return false}if((E.screen===d.screenName.enlazar)&&(y.compareGigyaErrorCode(E.response.errorCode,0))){y.setButtonMessage(false,false,false,"Validaci"+Vocento.UnicodeToChar("o")+"n correcta");d.backURL=y.getNfrylCookie();if("undefined"!==typeof d.backURL&&d.backURL){if(!y.isFirstLogin(E)&&!d.showAdditionalDataPage){y.removeNfrylCookie()}if(d.showAdditionalDataPage&&!y.checkAdditionalDataFilled(E)){y.setButtonMessage(false,false,false,"Redirigiendo a Completar Datos");window.location.href=y.getUrlAdditionalDataScreen()}else{y.setButtonMessage(false,false,false,"Redirigiendo a la web");y.redirectToBackUrl(0);return false}}}if((E.screen===d.screenName.validacion)&&((E.response.errorCode)||(y.compareGigyaErrorCode(E.response.errorCode,"206002")))){w();if((null===f.cookie(b))||("undefined"===typeof f.cookie(b))){y.createCookieVocUserTemporal(E.profile.email)}y.redirectToUrl(y.getUrlRegisterConfirmationScreen(),0)}if((d.screenName.perfil===E.screen||d.screenName.cambiar===E.screen)&&(y.compareGigyaErrorCode(E.response.errorCode,0))){y.showProfileUpdated()}if((d.screenName.intereses===E.screen)&&(y.compareGigyaErrorCode(E.response.errorCode,0))){y.showProfileUpdated()}},onHideHandler:function(A){},onSocialLoginHandler:function(A){}}}return{getOptions:m,getInsertCustomField:n,getCustomValidationFields:a,setOptions:function(A){d=A;i=(d.debug&&Vocento.log)?Vocento.log:function(){};return this},screenSetHandlers:l(),setProtectedFunctions:function(A){y=A;return this},execute:j,version:function(){return e}}};